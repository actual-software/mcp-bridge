=== COMPREHENSIVE GO MODULE LINTING ===
Timestamp: Thu Sep 25 14:10:12 PDT 2025
Found modules: . ./test/e2e/k8s ./test/e2e/weather ./test/e2e/full_stack ./test/e2e/full_stack/test-mcp-server ./services/gateway ./services/router

=== LINTING MODULE: . ===
0 issues.
Module root: 0 issues

=== LINTING MODULE: ./test/e2e/k8s ===
test/e2e/k8s/k8s_e2e_test.go:2203:35: Function `validateNamespaceExists` should pass the context parameter (contextcheck)
	if err := validateNamespaceExists(stack, logger); err != nil {
	                                 ^
test/e2e/k8s/k8s_e2e_test.go:2208:26: Function `validateDNSFunctionality` should pass the context parameter (contextcheck)
	validateDNSFunctionality(stack, logger)
	                        ^
test/e2e/k8s/k8s_stack.go:208:34: Function `executeClusterCreation$1->destroyCluster` should pass the context parameter (contextcheck)
	ks.cleanup = append(ks.cleanup, func() {
	                                ^
test/e2e/k8s/k8s_stack.go:504:24: Function `logFinalDiagnostics` should pass the context parameter (contextcheck)
	ks.logFinalDiagnostics(url)
	                      ^
test/e2e/k8s/k8s_e2e_test.go:2965:6: Function 'testKubernetesServiceEndpointsAdaptive' is too long (68 > 60) (funlen)
func testKubernetesServiceEndpointsAdaptive(
     ^
test/e2e/k8s/k8s_e2e_test.go:3139:6: test helper function should start from t.Helper() (thelper)
func testServiceDuringRollingUpdate(
     ^
test/e2e/k8s/k8s_e2e_test.go:3309:6: test helper function should start from t.Helper() (thelper)
func testPodDisruptionPartitionAdaptive(
     ^
test/e2e/k8s/k8s_e2e_test.go:2423:1: unnecessary whitespace (err) (wsl_v5)

^
test/e2e/k8s/k8s_e2e_test.go:2798:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	logger, _ := zap.NewDevelopment()
	^
test/e2e/k8s/k8s_e2e_test.go:2842:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	response, err := client.CallTool("echo", map[string]interface{}{
	^
test/e2e/k8s/k8s_e2e_test.go:3059:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
test/e2e/k8s/k8s_e2e_test.go:3163:4: missing whitespace above this line (no shared variables above expr) (wsl_v5)
			logger.Warn("Request failed during rolling update", zap.Int("request", i), zap.Error(err))
			^
test/e2e/k8s/k8s_e2e_test.go:3208:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	logger, _ := zap.NewDevelopment()
	^
test/e2e/k8s/k8s_stack.go:147:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	output, err := checkCmd.Output()
	^
test/e2e/k8s/k8s_stack.go:224:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	currentContext, err := verifyCmd.Output()
	^
test/e2e/k8s/k8s_stack.go:230:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	actualContext := strings.TrimSpace(string(currentContext))
	^
test/e2e/k8s/test_helpers.go:92:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const (
	^
test/e2e/k8s/test_helpers.go:114:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const (
	^
test/e2e/k8s/test_helpers.go:135:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	sumResp, err := client.CallTool("sum", map[string]interface{}{
	^
test/e2e/k8s/test_helpers.go:150:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	calcResp, err := client.CallTool("calculate", map[string]interface{}{
	^
20 issues:
* contextcheck: 4
* funlen: 1
* thelper: 2
* wsl_v5: 13
Module k8s: 20 issues found
test/e2e/k8s/k8s_e2e_test.go:2203:35: Function `validateNamespaceExists` should pass the context parameter (contextcheck)
	if err := validateNamespaceExists(stack, logger); err != nil {
	                                 ^
test/e2e/k8s/k8s_e2e_test.go:2208:26: Function `validateDNSFunctionality` should pass the context parameter (contextcheck)
	validateDNSFunctionality(stack, logger)
	                        ^
test/e2e/k8s/k8s_stack.go:208:34: Function `executeClusterCreation$1->destroyCluster` should pass the context parameter (contextcheck)
	ks.cleanup = append(ks.cleanup, func() {
	                                ^
test/e2e/k8s/k8s_stack.go:504:24: Function `logFinalDiagnostics` should pass the context parameter (contextcheck)
	ks.logFinalDiagnostics(url)
	                      ^
test/e2e/k8s/k8s_e2e_test.go:2965:6: Function 'testKubernetesServiceEndpointsAdaptive' is too long (68 > 60) (funlen)
func testKubernetesServiceEndpointsAdaptive(
     ^
test/e2e/k8s/k8s_e2e_test.go:3139:6: test helper function should start from t.Helper() (thelper)
func testServiceDuringRollingUpdate(
     ^
test/e2e/k8s/k8s_e2e_test.go:3309:6: test helper function should start from t.Helper() (thelper)
func testPodDisruptionPartitionAdaptive(
     ^
test/e2e/k8s/k8s_e2e_test.go:2423:1: unnecessary whitespace (err) (wsl_v5)

^
test/e2e/k8s/k8s_e2e_test.go:2798:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	logger, _ := zap.NewDevelopment()
	^
test/e2e/k8s/k8s_e2e_test.go:2842:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	response, err := client.CallTool("echo", map[string]interface{}{
	^
test/e2e/k8s/k8s_e2e_test.go:3059:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
test/e2e/k8s/k8s_e2e_test.go:3163:4: missing whitespace above this line (no shared variables above expr) (wsl_v5)
			logger.Warn("Request failed during rolling update", zap.Int("request", i), zap.Error(err))
			^
test/e2e/k8s/k8s_e2e_test.go:3208:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	logger, _ := zap.NewDevelopment()
	^
test/e2e/k8s/k8s_stack.go:147:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	output, err := checkCmd.Output()
	^
test/e2e/k8s/k8s_stack.go:224:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	currentContext, err := verifyCmd.Output()
	^
test/e2e/k8s/k8s_stack.go:230:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	actualContext := strings.TrimSpace(string(currentContext))
	^
test/e2e/k8s/test_helpers.go:92:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const (
	^
test/e2e/k8s/test_helpers.go:114:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const (
	^
test/e2e/k8s/test_helpers.go:135:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	sumResp, err := client.CallTool("sum", map[string]interface{}{
	^
test/e2e/k8s/test_helpers.go:150:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	calcResp, err := client.CallTool("calculate", map[string]interface{}{
	^
20 issues:
* contextcheck: 4
* funlen: 1
* thelper: 2
* wsl_v5: 13

=== LINTING MODULE: ./test/e2e/weather ===
0 issues.
Module weather: 0 issues

=== LINTING MODULE: ./test/e2e/full_stack ===
0 issues.
Module full_stack: 0 issues

=== LINTING MODULE: ./test/e2e/full_stack/test-mcp-server ===
level=warning msg="[linters_context] copyloopvar: this linter is disabled because the Go version (1.21) of your project is lower than Go 1.22"
0 issues.
Module test-mcp-server: 0 issues

=== LINTING MODULE: ./services/gateway ===
services/gateway/internal/server/server.go:585:31: Non-inherited new context, use function like `context.WithXXX` or `r.Context` instead (contextcheck)
		s.handleConnectionLimitError(ctx, w, err, clientIP)
		                            ^
services/gateway/internal/server/server.go:592:51: Non-inherited new context, use function like `context.WithXXX` or `r.Context` instead (contextcheck)
	authClaims, err := s.authenticateWebSocketRequest(ctx, w, r, clientIP, traceID, requestID)
	                                                 ^
services/gateway/internal/server/server.go:602:46: Non-inherited new context, use function like `context.WithXXX` or `r.Context` instead (contextcheck)
	conn, sess, err := s.upgradeAndCreateSession(enrichedCtx, w, r, authClaims, traceID, requestID)
	                                            ^
services/gateway/internal/server/server.go:609:30: Non-inherited new context, use function like `context.WithXXX` or `r.Context` instead (contextcheck)
	s.setupAndRegisterConnection(enrichedCtx, conn, sess, authClaims, clientIP, r.RemoteAddr)
	                            ^
services/gateway/internal/server/tcp_graceful_shutdown_test.go:230:24: Non-inherited new context, use function like `context.WithXXX` instead (contextcheck)
	err := server.Shutdown(shutdownCtx)
	                      ^
services/gateway/internal/logging/structured_test.go:96:3: missing cases in switch of type zapcore.FieldType: zapcore.UnknownType, zapcore.ArrayMarshalerType, zapcore.ObjectMarshalerType, zapcore.BinaryType, zapcore.ByteStringType, zapcore.Complex128Type, zapcore.Complex64Type, zapcore.DurationType, zapcore.Float64Type, zapcore.Float32Type, zapcore.Int32Type, zapcore.Int16Type, zapcore.Int8Type, zapcore.TimeType, zapcore.TimeFullType, zapcore.Uint64Type, zapcore.Uint32Type, zapcore.Uint16Type, zapcore.Uint8Type, zapcore.UintptrType, zapcore.ReflectType, zapcore.NamespaceType, zapcore.StringerType, zapcore.SkipType, zapcore.InlineMarshalerType (exhaustive)
		switch field.Type {
		^
services/gateway/internal/tracing/tracing_test.go:390:2: type assertion must be checked (forcetypeassert)
	tracer := opentracing.GlobalTracer().(*mocktracer.MockTracer)
	^
services/gateway/internal/backends/stdio/backend_test.go:361:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(content), 0o755) 
	       ^
services/gateway/internal/backends/websocket/backend.go:438:12: G115: integer overflow conversion uint64 -> int (gosec)
	return int(nextID % uint64(endpointCount)) 
	          ^
services/gateway/internal/discovery/consul_test.go:629:9: G204: Subprocess launched with variable (gosec)
	cmd := exec.CommandContext(ctx, "docker", "run", "-d", "--rm",
		"--name", containerName,
		"-p", fmt.Sprintf("%d:8500", port),
		"consul:1.16",
		"agent", "-dev", "-client", "0.0.0.0")
services/gateway/internal/discovery/consul_test.go:647:7: G204: Subprocess launched with variable (gosec)
		_ = exec.CommandContext(ctx, "docker", "stop", containerName).Run()
		    ^
services/gateway/internal/discovery/consul_test.go:656:10: G204: Subprocess launched with variable (gosec)
		cmd := exec.CommandContext(ctx, "docker", "stop", containerName)
		       ^
services/gateway/internal/discovery/kubernetes_test.go:1190:15: G204: Subprocess launched with variable (gosec)
	createCmd := exec.CommandContext(ctx, "kind", "create", "cluster", "--name", clusterName, "--wait", "60s")
	             ^
services/gateway/internal/discovery/kubernetes_test.go:1203:15: G204: Subprocess launched with variable (gosec)
	exportCmd := exec.CommandContext(ctx, "kind", "export", "kubeconfig",
		"--name", clusterName, "--kubeconfig", kubeconfigPath)
services/gateway/internal/discovery/kubernetes_test.go:1210:7: G204: Subprocess launched with variable (gosec)
		_ = exec.CommandContext(ctx, "kind", "delete", "cluster", "--name", clusterName).Run()
		    ^
services/gateway/internal/discovery/kubernetes_test.go:1219:7: G204: Subprocess launched with variable (gosec)
		_ = exec.CommandContext(ctx, "kind", "delete", "cluster", "--name", clusterName).Run()
		    ^
services/gateway/internal/discovery/kubernetes_test.go:1229:16: G204: Subprocess launched with variable (gosec)
		deleteCmd := exec.CommandContext(ctx, "kind", "delete", "cluster", "--name", clusterName)
		             ^
services/gateway/internal/server/http_handlers_test.go:198:51: G103: Use of unsafe calls should be audited (gosec)
		statusField = reflect.NewAt(statusField.Type(), unsafe.Pointer(statusField.UnsafeAddr())).Elem() 
		                                                ^
services/gateway/internal/server/server.go:1559:16: G402: TLS MinVersion too low. (gosec)
	tlsConfig := &tls.Config{ 
		Certificates: []tls.Certificate{cert},
		MinVersion:   minVersion,
	}
services/gateway/internal/tracing/tracing_test.go:152:17: G115: integer overflow conversion int -> uint64 (gosec)
			return uint64(mockCtx.SpanID) 
			             ^
services/gateway/internal/tracing/tracing_test.go:156:13: G115: integer overflow conversion int -> uint64 (gosec)
	}(), uint64(childRecord.ParentID)) 
	           ^
services/gateway/internal/tracing/tracing_test.go:300:24: G115: integer overflow conversion int -> uint16 (gosec)
	assert.Equal(t, uint16(tt.expectedStatus), requestSpan.Tag("http.status_code"))
	                      ^
services/gateway/pkg/circuit/breaker_test.go:306:21: G115: integer overflow conversion int -> int32 (gosec)
	totalCalls := int32(numGoroutines * callsPerGoroutine) 
	                   ^
services/gateway/pkg/wire/auth_message_test.go:468:3: G101: Potential hardcoded credentials (gosec)
		authToken := "roundtrip-resp-token"
		^
services/gateway/pkg/wire/protocol_test.go:109:24: G115: integer overflow conversion int -> uint32 (gosec)
	assert.Equal(t, uint32(len(frame.Payload)), payloadLen)
	                      ^
services/gateway/pkg/wire/protocol_test.go:217:49: G115: integer overflow conversion int -> uint32 (gosec)
	_ = binary.Write(&buf, binary.BigEndian, uint32(len(payload)))
	                                               ^
services/gateway/test/integration/protocols_integration_test.go:295:20: G115: integer overflow conversion int -> uint64 (gosec)
	suite.Equal(uint64(numRequests), metrics.RequestCount)
	                  ^
services/gateway/test/integration/protocols_integration_test.go:456:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(content), 0o700) 
	       ^
services/gateway/test/testutil/tls_test.go:68:20: G304: Potential file inclusion via variable (gosec)
	caCertPEM, err := os.ReadFile(caFile)
	                  ^
services/gateway/test/testutil/tls_test.go:88:24: G304: Potential file inclusion via variable (gosec)
	serverCertPEM, err := os.ReadFile(certFile)
	                      ^
services/gateway/test/testutil/tls_test.go:119:23: G304: Potential file inclusion via variable (gosec)
	serverKeyPEM, err := os.ReadFile(keyFile)
	                     ^
services/gateway/test/testutil/tls_test.go:163:20: G304: Potential file inclusion via variable (gosec)
	caCertPEM, err := os.ReadFile(caFile)
	                  ^
services/gateway/test/testutil/tls_test.go:170:24: G304: Potential file inclusion via variable (gosec)
	serverCertPEM, err := os.ReadFile(certFile)
	                      ^
services/gateway/test/testutil/tls_test.go:261:20: G304: Potential file inclusion via variable (gosec)
	caCertPEM, err := os.ReadFile(caFile)
	                  ^
services/gateway/test/testutil/tls_test.go:458:18: G304: Potential file inclusion via variable (gosec)
	certPEM, err := os.ReadFile(certFile)
	                ^
services/gateway/test/testutil/tls_test.go:514:20: G304: Potential file inclusion via variable (gosec)
		cert1PEM, err := os.ReadFile(certFile1) 
		                 ^
services/gateway/test/testutil/tls_test.go:516:20: G304: Potential file inclusion via variable (gosec)
		cert2PEM, err := os.ReadFile(certFile2) 
		                 ^
services/gateway/test/testutil/tls_test.go:519:18: G304: Potential file inclusion via variable (gosec)
		ca1PEM, err := os.ReadFile(caFile1) 
		               ^
services/gateway/test/testutil/tls_test.go:521:18: G304: Potential file inclusion via variable (gosec)
		ca2PEM, err := os.ReadFile(caFile2) 
		               ^
services/gateway/cmd/mcp-gateway/main.go:234:1: createRateLimiter returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/ratelimit.RateLimiter) (ireturn)
func createRateLimiter(cfg *config.Config, sessionMgr session.Manager, logger *zap.Logger) ratelimit.RateLimiter {
^
services/gateway/internal/auth/provider.go:53:1: InitializeAuthenticationProvider returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/auth.Provider) (ireturn)
func InitializeAuthenticationProvider(cfg config.AuthConfig, logger *zap.Logger) (Provider, error) {
^
services/gateway/internal/backends/factory.go:86:1: CreateBackend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/backends.Backend) (ireturn)
func (f *DefaultFactory) CreateBackend(config BackendConfig) (Backend, error) {
^
services/gateway/internal/backends/factory.go:108:1: createStdioBackend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/backends.Backend) (ireturn)
func (f *DefaultFactory) createStdioBackend(config BackendConfig) (Backend, error) {
^
services/gateway/internal/backends/factory.go:233:1: createWebSocketBackend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/backends.Backend) (ireturn)
func (f *DefaultFactory) createWebSocketBackend(config BackendConfig) (Backend, error) {
^
services/gateway/internal/backends/factory.go:379:1: createSSEBackend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/backends.Backend) (ireturn)
func (f *DefaultFactory) createSSEBackend(config BackendConfig) (Backend, error) {
^
services/gateway/internal/discovery/factory.go:14:1: CreateServiceDiscoveryProvider returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/discovery.ServiceDiscovery) (ireturn)
func CreateServiceDiscoveryProvider(cfg config.ServiceDiscoveryConfig, logger *zap.Logger) (ServiceDiscovery, error) {
^
services/gateway/internal/discovery/kubernetes_test.go:32:1: createKubernetesTestClient returns interface (k8s.io/client-go/kubernetes.Interface) (ireturn)
func createKubernetesTestClient(t *testing.T, kubeconfig string) kubernetes.Interface {
^
services/gateway/internal/discovery/sse_discovery.go:37:1: CreateSSEServiceDiscovery returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/discovery.ServiceDiscovery) (ireturn)
func CreateSSEServiceDiscovery(cfg config.SSEDiscoveryConfig, logger *zap.Logger) (ServiceDiscovery, error) {
^
services/gateway/internal/discovery/stdio_discovery.go:32:1: CreateStdioServiceDiscovery returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/discovery.ServiceDiscovery) (ireturn)
func CreateStdioServiceDiscovery(cfg config.StdioDiscoveryConfig, logger *zap.Logger) (ServiceDiscovery, error) {
^
services/gateway/internal/discovery/websocket_discovery.go:34:1: CreateWebSocketServiceDiscovery returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/discovery.ServiceDiscovery) (ireturn)
func CreateWebSocketServiceDiscovery(
^
services/gateway/internal/frontends/factory.go:45:1: CreateFrontend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/frontends.Frontend) (ireturn)
func (f *DefaultFactory) CreateFrontend(
^
services/gateway/internal/frontends/factory.go:67:1: createStdioFrontend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/frontends.Frontend) (ireturn)
func (f *DefaultFactory) createStdioFrontend(
^
services/gateway/internal/logging/structured.go:179:1: ErrorSampler returns interface (go.uber.org/zap/zapcore.Core) (ireturn)
func ErrorSampler(core zapcore.Core) zapcore.Core { 
^
services/gateway/internal/metrics/metrics.go:108:1: createTCPMetrics returns interface (github.com/prometheus/client_golang/prometheus.Gauge) (ireturn)
func createTCPMetrics(factory promauto.Factory) (
^
services/gateway/internal/ratelimit/redis_circuit_test.go:74:1: setupCircuitRecoveryTest returns interface (github.com/go-redis/redismock/v8.ClientMock) (ireturn)
func setupCircuitRecoveryTest(t *testing.T) (*redis.Client, redismock.ClientMock, *RedisRateLimiterWithCircuitBreaker) {
^
services/gateway/internal/router/router.go:589:1: getLoadBalancer returns interface (github.com/poiley/mcp-bridge/services/gateway/pkg/loadbalancer.LoadBalancer) (ireturn)
func (r *Router) getLoadBalancer(namespace string) loadbalancer.LoadBalancer {
^
services/gateway/internal/session/manager.go:62:1: CreateSessionStorageManager returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/session.Manager) (ireturn)
func CreateSessionStorageManager(ctx context.Context, cfg config.SessionConfig, logger *zap.Logger) (Manager, error) {
^
services/gateway/internal/session/manager.go:98:1: InitializeRedisSessionStore returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/session.Manager) (ireturn)
func InitializeRedisSessionStore(ctx context.Context, cfg config.RedisConfig, logger *zap.Logger) (Manager, error) {
^
services/gateway/internal/session/manager_test.go:291:1: setupRedisManagerTest returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/session.Manager) (ireturn)
func setupRedisManagerTest(t *testing.T) (*miniredis.Miniredis, Manager) { 
^
services/gateway/internal/session/manager_test.go:388:1: setupRedisManagerForUpdate returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/session.Manager) (ireturn)
func setupRedisManagerForUpdate(t *testing.T) Manager {
^
services/gateway/internal/session/memory_manager.go:28:1: CreateInMemorySessionStore returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/session.Manager) (ireturn)
func CreateInMemorySessionStore(logger *zap.Logger, cleanupInterval time.Duration) Manager {
^
services/gateway/internal/tracing/otel.go:113:1: createExporter returns interface (go.opentelemetry.io/otel/sdk/trace.SpanExporter) (ireturn)
func createExporter(cfg config.TracingConfig, logger *zap.Logger) (sdktrace.SpanExporter, error) {
^
services/gateway/internal/tracing/otel.go:136:1: createSampler returns interface (go.opentelemetry.io/otel/sdk/trace.Sampler) (ireturn)
func createSampler(cfg config.TracingConfig) sdktrace.Sampler { 
^
services/gateway/internal/tracing/otel.go:151:1: StartSpan returns interface (go.opentelemetry.io/otel/trace.Span) (ireturn)
func (t *OTelTracer) StartSpan(ctx context.Context, name string) (context.Context, trace.Span) {
^
services/gateway/internal/tracing/tracing.go:33:1: InitTracer returns interface (github.com/opentracing/opentracing-go.Tracer) (ireturn)
func InitTracer(cfg Config, logger *zap.Logger) (opentracing.Tracer, io.Closer, error) {
^
services/gateway/internal/tracing/tracing.go:76:1: StartSpanFromContext returns interface (github.com/opentracing/opentracing-go.Span) (ireturn)
func StartSpanFromContext(ctx context.Context, operationName string, opts ...opentracing.StartSpanOption) (opentracing.Span, context.Context) {
^
services/gateway/internal/tracing/tracing.go:91:1: ExtractHTTPHeaders returns interface (github.com/opentracing/opentracing-go.SpanContext) (ireturn)
func ExtractHTTPHeaders(req *http.Request) (opentracing.SpanContext, error) {
^
services/gateway/test/testutil/metrics.go:13:1: createTestConnectionMetrics returns interface (github.com/prometheus/client_golang/prometheus.Gauge) (ireturn)
func createTestConnectionMetrics() (prometheus.Gauge, prometheus.Gauge, prometheus.Counter) {
^
services/gateway/test/testutil/metrics.go:32:1: createTestRequestMetrics returns interface (github.com/prometheus/client_golang/prometheus.Gauge) (ireturn)
func createTestRequestMetrics() (*prometheus.CounterVec, *prometheus.HistogramVec, prometheus.Gauge) {
^
services/gateway/test/testutil/metrics.go:52:1: createTestTCPMetrics returns interface (github.com/prometheus/client_golang/prometheus.Gauge) (ireturn)
func createTestTCPMetrics() (
^
services/gateway/internal/backends/sse/backend_test.go:558:1: The line is 151 characters long, which exceeds the maximum of 120 characters. (lll)
func processSSERequests(w http.ResponseWriter, r *http.Request, flusher http.Flusher, pendingRequests map[string]mcp.Request, requestsMu *sync.Mutex) {
^
services/gateway/internal/backends/sse/backend_test.go:573:1: The line is 138 characters long, which exceeds the maximum of 120 characters. (lll)
func processPendingRequests(w http.ResponseWriter, flusher http.Flusher, pendingRequests map[string]mcp.Request, requestsMu *sync.Mutex) {
^
services/gateway/internal/backends/sse/backend_test.go:616:1: The line is 128 characters long, which exceeds the maximum of 120 characters. (lll)
func handlePostRequest(w http.ResponseWriter, r *http.Request, pendingRequests map[string]mcp.Request, requestsMu *sync.Mutex) {
^
services/gateway/internal/config/security_test.go:130:1: The line is 122 characters long, which exceeds the maximum of 120 characters. (lll)
			TokenEndpoint: "https://auth.example.com/oauth/token", IntrospectEndpoint: "https://auth.example.com/oauth/introspect",
^
services/gateway/internal/config/security_test.go:784:1: The line is 140 characters long, which exceeds the maximum of 120 characters. (lll)
						ClientID: "secure-client", TokenEndpoint: "https://auth.example.com/token", IntrospectEndpoint: "https://auth.example.com/introspect",
^
services/gateway/internal/config/validation_test.go:46:1: The line is 125 characters long, which exceeds the maximum of 120 characters. (lll)
		{"invalid circuit breaker config", createConfigWithInvalidCircuitBreaker(), true, "invalid circuit breaker configuration"},
^
services/gateway/internal/config/validation_test.go:404:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
					ClientID: "test-client", TokenEndpoint: "https://auth.example.com/token", IntrospectEndpoint: "https://auth.example.com/introspect",
^
services/gateway/internal/config/validation_test.go:426:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
				OAuth2: OAuth2Config{TokenEndpoint: "https://auth.example.com/token", IntrospectEndpoint: "https://auth.example.com/introspect"},
^
services/gateway/internal/discovery/consul_advanced_test.go:89:1: The line is 131 characters long, which exceeds the maximum of 120 characters. (lll)
			assert.Equal(t, tt.expectedMatch, result, "Service %s with tags %v should match: %v", tt.serviceName, tt.tags, tt.expectedMatch)
^
services/gateway/internal/discovery/consul_advanced_test.go:143:1: The line is 151 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "weather-1", Namespace: "weather", Address: "127.0.0.1", Port: 8080, Healthy: true, Metadata: map[string]string{"consul_id": "weather-1"}},
^
services/gateway/internal/discovery/consul_advanced_test.go:144:1: The line is 152 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "weather-2", Namespace: "weather", Address: "127.0.0.2", Port: 8080, Healthy: false, Metadata: map[string]string{"consul_id": "weather-2"}},
^
services/gateway/internal/discovery/consul_advanced_test.go:145:1: The line is 151 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "weather-3", Namespace: "weather", Address: "127.0.0.3", Port: 8080, Healthy: true, Metadata: map[string]string{"consul_id": "weather-3"}},
^
services/gateway/internal/discovery/kubernetes_test.go:738:1: The line is 157 characters long, which exceeds the maximum of 120 characters. (lll)
func createKubernetesDiscoveryForWatch(ctx context.Context, cancel context.CancelFunc, logger *zap.Logger, fakeClient *fake.Clientset) *KubernetesDiscovery {
^
services/gateway/internal/discovery/kubernetes_test.go:891:1: The line is 148 characters long, which exceeds the maximum of 120 characters. (lll)
func createStartStopDiscovery(ctx context.Context, cancel context.CancelFunc, logger *zap.Logger, fakeClient *fake.Clientset) *KubernetesDiscovery {
^
services/gateway/internal/frontends/factory_test.go:25:1: The line is 128 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *mockRequestRouter) RouteRequest(ctx context.Context, req *mcp.Request, targetNamespace string) (*mcp.Response, error) {
^
services/gateway/internal/frontends/factory_test.go:41:1: The line is 124 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *mockAuthProvider) GetUserInfo(ctx context.Context, credentials map[string]string) (map[string]interface{}, error) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:45:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *MockRequestRouterWithError) RouteRequest(ctx context.Context, req *mcp.Request, targetNamespace string) (*mcp.Response, error) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:71:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *MockAuthProviderWithError) GetUserInfo(ctx context.Context, credentials map[string]string) (map[string]interface{}, error) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:587:1: The line is 176 characters long, which exceeds the maximum of 120 characters. (lll)
func testSuccessfulAuth(t *testing.T, config Config, mockRouter *MockRequestRouter, mockAuth *MockAuthProviderWithError, mockSessions *MockSessionManager, logger *zap.Logger) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:639:1: The line is 135 characters long, which exceeds the maximum of 120 characters. (lll)
func testFailedAuth(t *testing.T, config Config, mockRouter *MockRequestRouter, mockSessions *MockSessionManager, logger *zap.Logger) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:718:1: The line is 139 characters long, which exceeds the maximum of 120 characters. (lll)
func testSuccessfulRequest(t *testing.T, config Config, mockAuth *MockAuthProvider, mockSessions *MockSessionManager, logger *zap.Logger) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:744:1: The line is 144 characters long, which exceeds the maximum of 120 characters. (lll)
func testRequestWithRouterError(t *testing.T, config Config, mockAuth *MockAuthProvider, mockSessions *MockSessionManager, logger *zap.Logger) {
^
services/gateway/internal/frontends/stdio/frontend_test.go:19:1: The line is 128 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *MockRequestRouter) RouteRequest(ctx context.Context, req *mcp.Request, targetNamespace string) (*mcp.Response, error) {
^
services/gateway/internal/frontends/stdio/frontend_test.go:33:1: The line is 124 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *MockAuthProvider) GetUserInfo(ctx context.Context, credentials map[string]string) (map[string]interface{}, error) {
^
services/gateway/internal/ratelimit/redis_circuit_test.go:88:1: The line is 161 characters long, which exceeds the maximum of 120 characters. (lll)
func causeCircuitToOpen(t *testing.T, mock redismock.ClientMock, limiter *RedisRateLimiterWithCircuitBreaker, ctx context.Context, config auth.RateLimitConfig) {
^
services/gateway/internal/ratelimit/redis_circuit_test.go:106:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyCircuitRecovery(t *testing.T, limiter *RedisRateLimiterWithCircuitBreaker, ctx context.Context, config auth.RateLimitConfig) {
^
services/gateway/internal/router/router_test.go:319:1: The line is 127 characters long, which exceeds the maximum of 120 characters. (lll)
func validateLoadBalancerResult(t *testing.T, lb loadbalancer.LoadBalancer, expectNil bool, router *Router, namespace string) {
^
services/gateway/internal/server/server_test.go:36:1: The line is 124 characters long, which exceeds the maximum of 120 characters. (lll)
	cfg, mockAuth, mockSessions, testRouter, mockHealth, registry, mockRateLimiter, logger := setupBootstrapTestDependencies(t)
^
services/gateway/internal/server/server_test.go:38:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
	server := BootstrapGatewayServer(cfg, mockAuth, mockSessions, testRouter, mockHealth, registry, mockRateLimiter, logger)
^
services/gateway/internal/server/server_test.go:43:1: The line is 196 characters long, which exceeds the maximum of 120 characters. (lll)
func setupBootstrapTestDependencies(t *testing.T) (*config.Config, *mockAuthProvider, *mockSessionManager, *router.Router, *health.Checker, *metrics.Registry, ratelimit.RateLimiter, *zap.Logger) {
^
services/gateway/internal/server/server_test.go:67:1: The line is 158 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), testutil.NewTestLogger(t))
^
services/gateway/internal/server/server_test.go:77:1: The line is 166 characters long, which exceeds the maximum of 120 characters. (lll)
func validateBootstrappedServer(t *testing.T, server *GatewayServer, cfg *config.Config, mockHealth *health.Checker, registry *metrics.Registry, logger *zap.Logger) {
^
services/gateway/internal/server/server_test.go:233:1: The line is 158 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), testutil.NewTestLogger(t))
^
services/gateway/internal/server/server_test.go:240:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
	server := BootstrapGatewayServer(cfg, mockAuth, mockSessions, testRouter, mockHealth, registry, mockRateLimiter, logger)
^
services/gateway/internal/server/server_test.go:423:1: The line is 145 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), zap.NewNop())
^
services/gateway/internal/server/server_test.go:451:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func validateProcessClientMessageResult(t *testing.T, err error, client *ClientConnection, tt processClientMessageTest) {
^
services/gateway/internal/server/server_test.go:834:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *mockRouter) RouteRequest(ctx context.Context, req *mcp.Request, targetNamespace string) (*mcp.Response, error) {
^
services/gateway/internal/server/server_test.go:902:1: The line is 145 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), zap.NewNop())
^
services/gateway/internal/server/tcp_handler_metrics_test.go:120:1: The line is 132 characters long, which exceeds the maximum of 120 characters. (lll)
func setupSuccessfulMetricsTest(t *testing.T) (*TCPHandler, *MockAuthProvider, *MockRouter, *MockSessionManager, *MockRateLimiter) {
^
services/gateway/internal/server/tcp_handler_metrics_test.go:251:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
func setupAuthFailureMetricsTest(t *testing.T) (*TCPHandler, *MockAuthProvider, *MockRouter, *MockSessionManager, *MockRateLimiter) {
^
services/gateway/internal/server/tcp_handler_test.go:65:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *MockRouter) RouteRequest(ctx context.Context, req *mcp.Request, targetNamespace string) (*mcp.Response, error) {
^
services/gateway/internal/server/tcp_handler_test.go:204:1: The line is 122 characters long, which exceeds the maximum of 120 characters. (lll)
func setupSuccessfulAuthMocks(t *testing.T, logger *zap.Logger, registry *metrics.Registry) (*TCPHandler, *tcpTestMocks) {
^
services/gateway/internal/server/tcp_health_test.go:75:1: The line is 125 characters long, which exceeds the maximum of 120 characters. (lll)
	server = CreateTCPHealthCheckServer(1, checker, metrics, logger) // Use port 1 to enable, will get actual port from listener
^
services/gateway/internal/server/websocket_origin_test.go:76:1: The line is 145 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), zap.NewNop())
^
services/gateway/internal/server/websocket_origin_test.go:83:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
	server := BootstrapGatewayServer(cfg, mockAuth, mockSessions, testRouter, mockHealth, registry, mockRateLimiter, logger)
^
services/gateway/internal/server/websocket_origin_test.go:225:1: The line is 145 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), zap.NewNop())
^
services/gateway/internal/server/websocket_origin_test.go:232:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
	server := BootstrapGatewayServer(cfg, mockAuth, mockSessions, testRouter, mockHealth, registry, mockRateLimiter, logger)
^
services/gateway/internal/tracing/tracing_test.go:414:1: The line is 122 characters long, which exceeds the maximum of 120 characters. (lll)
func executeTracedHTTPRequest(t *testing.T, ctx context.Context, server *httptest.Server, client *http.Client, tt struct {
^
services/gateway/internal/validation/validation_test.go:515:1: The line is 170 characters long, which exceeds the maximum of 120 characters. (lll)
			token:   "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",
^
services/gateway/internal/validation/validation_test.go:1080:1: The line is 174 characters long, which exceeds the maximum of 120 characters. (lll)
	const testJWT = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
^
services/gateway/pkg/loadbalancer/hybrid_test.go:132:1: The line is 129 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 9090, Scheme: "http", Healthy: true, Weight: 1, Metadata: map[string]string{"protocol": "http"}}, 
^
services/gateway/pkg/loadbalancer/hybrid_test.go:133:1: The line is 129 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 9091, Scheme: "http", Healthy: true, Weight: 3, Metadata: map[string]string{"protocol": "http"}}, 
^
services/gateway/pkg/loadbalancer/hybrid_test.go:246:1: The line is 130 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 9090, Scheme: "http", Healthy: true, Weight: 2, Metadata: map[string]string{"protocol": "http"}},  
^
services/gateway/pkg/loadbalancer/hybrid_test.go:247:1: The line is 130 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 9091, Scheme: "http", Healthy: false, Weight: 1, Metadata: map[string]string{"protocol": "http"}}, 
^
services/gateway/pkg/loadbalancer/hybrid_test.go:248:1: The line is 131 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 8080, Scheme: "ws", Healthy: true, Weight: 1, Metadata: map[string]string{"protocol": "websocket"}},
^
services/gateway/pkg/loadbalancer/hybrid_test.go:249:1: The line is 127 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "localhost", Port: 0, Scheme: "stdio", Healthy: true, Weight: 1, Metadata: map[string]string{"protocol": "stdio"}},
^
services/gateway/pkg/loadbalancer/hybrid_test.go:325:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 8080, Scheme: "ws", Healthy: false, Metadata: map[string]string{"protocol": "websocket"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:198:1: The line is 165 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "http-svc1", Address: "192.168.1.1", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "http", Metadata: map[string]string{"protocol": "http"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:199:1: The line is 165 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "http-svc2", Address: "192.168.1.2", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "http", Metadata: map[string]string{"protocol": "http"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:200:1: The line is 166 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "ws-svc1", Address: "192.168.1.3", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "ws", Metadata: map[string]string{"protocol": "websocket"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:201:1: The line is 167 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "ws-svc2", Address: "192.168.1.4", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "wss", Metadata: map[string]string{"protocol": "websocket"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:202:1: The line is 180 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "sse-svc1", Address: "192.168.1.5", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "http", Path: "/events", Metadata: map[string]string{"protocol": "sse"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:281:1: The line is 166 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "http-svc1", Address: "192.168.1.1", Port: 8080, Healthy: false, Weight: testIterations, Scheme: "http", Metadata: map[string]string{"protocol": "http"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:282:1: The line is 167 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "ws-svc1", Address: "192.168.1.3", Port: 8080, Healthy: false, Weight: testIterations, Scheme: "ws", Metadata: map[string]string{"protocol": "websocket"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:283:1: The line is 180 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "sse-svc1", Address: "192.168.1.5", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "http", Path: "/events", Metadata: map[string]string{"protocol": "sse"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:628:1: The line is 123 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "svc3", Address: "192.168.1.3", Port: 8080, Healthy: true, Weight: testIterations}, // svc2 removed, svc3 added
^
services/gateway/pkg/protocol/converter_test.go:156:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyProtocolConversion(t *testing.T, converted Message, expectedProtocol string, expectedMeta map[string]string) {
^
services/gateway/pkg/protocol/multiplexer_test.go:839:1: The line is 135 characters long, which exceeds the maximum of 120 characters. (lll)
func createMultipleConnections(t *testing.T, multiplexer *ConnectionMultiplexer, endpoints []*discovery.Endpoint) []*PooledConnection {
^
services/gateway/pkg/protocol/multiplexer_test.go:860:1: The line is 148 characters long, which exceeds the maximum of 120 characters. (lll)
func returnAndReuseConnections(t *testing.T, multiplexer *ConnectionMultiplexer, endpoints []*discovery.Endpoint, connections []*PooledConnection) {
^
services/gateway/pkg/wire/protocol_test.go:402:1: The line is 154 characters long, which exceeds the maximum of 120 characters. (lll)
		Payload:     []byte(`{"jsonrpc":"2.0","method":"tools/call","params":{"name":"test.tool","arguments":{}},"id":"550e8400-e29b-41d4-a716-446655440000"}`),
^
services/gateway/pkg/wire/protocol_test.go:420:1: The line is 154 characters long, which exceeds the maximum of 120 characters. (lll)
		Payload:     []byte(`{"jsonrpc":"2.0","method":"tools/call","params":{"name":"test.tool","arguments":{}},"id":"550e8400-e29b-41d4-a716-446655440000"}`),
^
services/gateway/pkg/wire/version_negotiation_test.go:160:1: The line is 138 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyVersionNegotiationResult(t *testing.T, version uint16, err error, expectedVer uint16, expectError bool, errorContains string) {
^
services/gateway/test/integration/protocols_integration_test.go:290:1: The line is 135 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) verifyPerformanceResults(backend *stdio.Backend, duration time.Duration, numRequests int) {
^
services/gateway/test/integration/protocols_integration_test.go:311:1: The line is 126 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) setupConcurrentBackends(logger *zap.Logger) (*stdio.Backend, *wsBackend.Backend) {
^
services/gateway/test/integration/protocols_integration_test.go:384:1: The line is 162 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) runConcurrentRequests(stdioBackend *stdio.Backend, wsBackendInstance *wsBackend.Backend, numRequests int) (int, int) {
^
services/gateway/test/integration/protocols_integration_test.go:394:1: The line is 131 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) launchStdioRequests(stdioBackend *stdio.Backend, numRequests int, results chan error) {
^
services/gateway/test/integration/protocols_integration_test.go:409:1: The line is 144 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) launchWebSocketRequests(wsBackendInstance *wsBackend.Backend, numRequests int, results chan error) {
^
services/gateway/test/integration/protocols_integration_test.go:424:1: The line is 124 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) collectResults(stdioResults, wsResults chan error, numRequests int) (int, int) {
^
services/gateway/test/integration/protocols_integration_test.go:437:1: The line is 176 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) verifyConcurrentResults(stdioBackend *stdio.Backend, wsBackendInstance *wsBackend.Backend, stdioErrors, wsErrors, numRequests int) {
^
services/gateway/test/testutil/tls_test.go:366:1: The line is 122 characters long, which exceeds the maximum of 120 characters. (lll)
func performUntrustedTLSHandshake(t *testing.T, serverConn, clientConn net.Conn, serverConfig, clientConfig *tls.Config) {
^
services/gateway/internal/discovery/consul_test.go:77:2: return with no blank line before (nlreturn)
	return health
	^
services/gateway/internal/discovery/consul_test.go:496:2: return with no blank line before (nlreturn)
	return client
	^
services/gateway/internal/discovery/consul_test.go:527:2: return with no blank line before (nlreturn)
	return serviceInfo
	^
services/gateway/internal/discovery/consul_test.go:648:3: return with no blank line before (nlreturn)
		return nil, "", fmt.Errorf("Consul failed to become ready: %w", err)
		^
services/gateway/internal/discovery/consul_test.go:672:2: return with no blank line before (nlreturn)
	return cmd.Run() == nil
	^
services/gateway/internal/discovery/consul_test.go:699:2: return with no blank line before (nlreturn)
	return addr.Port, nil
	^
services/gateway/internal/discovery/consul_test.go:714:4: continue with no blank line before (nlreturn)
			continue
			^
services/gateway/internal/discovery/kubernetes_test.go:88:4: break with no blank line before (nlreturn)
			break
			^
services/gateway/internal/discovery/kubernetes_test.go:879:2: return with no blank line before (nlreturn)
	return testService, testEndpoint
	^
services/gateway/internal/discovery/kubernetes_test.go:888:2: return with no blank line before (nlreturn)
	return fakeClient
	^
services/gateway/internal/discovery/kubernetes_test.go:1211:3: return with no blank line before (nlreturn)
		return nil, "", fmt.Errorf("failed to export kubeconfig: %w, output: %s", err, string(exportOutput))
		^
services/gateway/internal/discovery/kubernetes_test.go:1221:3: return with no blank line before (nlreturn)
		return nil, "", fmt.Errorf("Kubernetes cluster failed to become ready: %w", err)
		^
services/gateway/internal/discovery/kubernetes_test.go:1249:2: return with no blank line before (nlreturn)
	return cmd.Run() == nil
	^
services/gateway/internal/discovery/kubernetes_test.go:1261:4: continue with no blank line before (nlreturn)
			continue
			^
services/gateway/internal/discovery/kubernetes_test.go:1268:4: continue with no blank line before (nlreturn)
			continue
			^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:290:2: return with no blank line before (nlreturn)
	return filepath.Join(tempDir, "test.sock")
	^
services/gateway/internal/health/health_advanced_test.go:395:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/internal/server/server_test.go:300:4: return with no blank line before (nlreturn)
			return true
			^
services/gateway/internal/server/tls_test.go:247:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/internal/session/manager_test.go:183:6: return with no blank line before (nlreturn)
					return
					^
services/gateway/internal/session/manager_test.go:195:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/internal/session/manager_test.go:200:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/internal/session/manager_test.go:724:2: return with no blank line before (nlreturn)
	return redisManager, session
	^
services/gateway/internal/tracing/otel_test.go:95:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/internal/tracing/otel_test.go:131:2: return with no blank line before (nlreturn)
	return tracer
	^
services/gateway/internal/tracing/tracing_test.go:170:2: return with no blank line before (nlreturn)
	return tracer
	^
services/gateway/internal/tracing/tracing_test.go:291:4: break with no blank line before (nlreturn)
			break
			^
services/gateway/internal/tracing/tracing_test.go:307:4: return with no blank line before (nlreturn)
			return false
			^
services/gateway/internal/tracing/tracing_test.go:451:4: break with no blank line before (nlreturn)
			break
			^
services/gateway/internal/tracing/tracing_test.go:466:4: return with no blank line before (nlreturn)
			return false
			^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:332:2: return with no blank line before (nlreturn)
	return NewHybridLoadBalancer(initialEndpoints, config)
	^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:557:2: return with no blank line before (nlreturn)
	return endpoints
	^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:582:2: return with no blank line before (nlreturn)
	return successCount
	^
services/gateway/pkg/loadbalancer/loadbalancer_test.go:351:2: return with no blank line before (nlreturn)
	return endpoints
	^
services/gateway/pkg/loadbalancer/loadbalancer_test.go:423:5: return with no blank line before (nlreturn)
				return true
				^
services/gateway/pkg/protocol/multiplexer_test.go:851:2: return with no blank line before (nlreturn)
	return connections
	^
services/gateway/pkg/wire/auth_message_test.go:615:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/pkg/wire/integration_test.go:51:4: return with no blank line before (nlreturn)
			return
			^
services/gateway/pkg/wire/protocol_test.go:79:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/pkg/wire/protocol_test.go:219:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/gateway/pkg/wire/protocol_test.go:228:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/gateway/pkg/wire/protocol_test.go:237:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/gateway/pkg/wire/protocol_test.go:255:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/gateway/test/integration/protocols_integration_test.go:76:2: return with no blank line before (nlreturn)
	return backend
	^
services/gateway/test/integration/protocols_integration_test.go:230:2: return with no blank line before (nlreturn)
	return backend
	^
services/gateway/test/integration/protocols_integration_test.go:287:2: return with no blank line before (nlreturn)
	return time.Since(start)
	^
services/gateway/test/integration/protocols_integration_test.go:314:2: return with no blank line before (nlreturn)
	return stdioBackend, wsBackendInstance
	^
services/gateway/test/integration/protocols_integration_test.go:326:2: return with no blank line before (nlreturn)
	return stdioBackend
	^
services/gateway/test/integration/protocols_integration_test.go:347:2: return with no blank line before (nlreturn)
	return wsBackendInstance
	^
services/gateway/test/integration/protocols_integration_test.go:434:2: return with no blank line before (nlreturn)
	return stdioErrors, wsErrors
	^
services/gateway/test/testutil/tls_test.go:107:4: break with no blank line before (nlreturn)
			break
			^
services/gateway/cmd/mcp-gateway/admin_test.go:163:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/cmd/mcp-gateway/main_test.go:201:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/cmd/mcp-gateway/main_test.go:221:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err) // zap handles empty string gracefully
		^
services/gateway/cmd/mcp-gateway/main_test.go:229:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err) // zap handles case conversion
		^
services/gateway/cmd/mcp-gateway/main_test.go:352:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/cmd/mcp-gateway/main_test.go:363:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:100:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:106:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:278:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:283:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:533:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:539:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:545:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:608:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:684:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:691:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:734:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:756:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:918:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/sse/backend_test.go:97:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/sse/backend_test.go:102:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, stopErr)
	^
services/gateway/internal/backends/sse/backend_test.go:142:4: require-error: for error assertions use require (testifylint)
			assert.Error(t, err)
			^
services/gateway/internal/backends/sse/backend_test.go:265:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/sse/backend_test.go:286:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/sse/backend_test.go:312:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/sse/backend_test.go:325:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/backends/stdio/backend_test.go:88:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/stdio/backend_test.go:93:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, stopErr)
	^
services/gateway/internal/backends/stdio/backend_test.go:134:4: require-error: for error assertions use require (testifylint)
			assert.Error(t, err)
			^
services/gateway/internal/backends/stdio/backend_test.go:211:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/stdio/backend_test.go:230:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/stdio/backend_test.go:255:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/stdio/backend_test.go:268:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:107:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:112:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, stopErr)
	^
services/gateway/internal/backends/websocket/backend_test.go:136:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err) // Connection failures are logged but don't fail startup
	^
services/gateway/internal/backends/websocket/backend_test.go:242:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:261:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:292:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:305:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:444:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/discovery/consul_start_test.go:47:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err, "Start should fail when Consul is unavailable")
		^
services/gateway/internal/discovery/consul_start_test.go:207:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err, "updateHealthStatus should not error with empty endpoints")
		^
services/gateway/internal/discovery/consul_start_test.go:223:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/discovery/factory_test.go:32:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/factory_test.go:61:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/factory_test.go:91:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/factory_test.go:112:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/factory_test.go:125:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/factory_test.go:155:4: require-error: for error assertions use require (testifylint)
			assert.NoError(t, err)
			^
services/gateway/internal/discovery/factory_test.go:192:4: require-error: for error assertions use require (testifylint)
			assert.NoError(t, err)
			^
services/gateway/internal/discovery/factory_test.go:223:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/factory_test.go:244:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:42:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:63:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:84:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:119:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:144:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:169:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:211:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:239:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:267:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/sse_discovery_test.go:30:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/discovery/sse_discovery_test.go:33:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/discovery/sse_discovery_test.go:147:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/static_test.go:24:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/discovery/static_test.go:30:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/discovery/static_test.go:309:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/static_test.go:316:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/static_test.go:341:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stdio_discovery_test.go:25:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/discovery/stdio_discovery_test.go:28:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/discovery/stdio_discovery_test.go:138:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:30:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:58:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:86:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:114:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:124:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:131:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:151:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:161:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:168:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:188:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:198:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:205:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:219:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:232:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:254:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:292:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:330:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:371:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:387:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:413:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:429:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:454:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:470:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/websocket_discovery_test.go:25:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/discovery/websocket_discovery_test.go:28:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/discovery/websocket_discovery_test.go:138:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/factory_test.go:100:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/frontends/factory_test.go:126:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/frontends/factory_test.go:131:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/frontends/factory_test.go:377:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/factory_test.go:397:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/frontends/factory_test.go:400:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/frontends/factory_test.go:556:4: require-error: for error assertions use require (testifylint)
			assert.NoError(t, err)
			^
services/gateway/internal/frontends/factory_test.go:614:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/factory_test.go:646:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/frontends/factory_test.go:649:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/frontends/stdio/frontend_test.go:348:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/stdio/frontend_test.go:354:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/stdio/frontend_test.go:424:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err) // Should not error for disabled frontend
	^
services/gateway/internal/frontends/stdio/frontend_test.go:521:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/stdio/frontend_test.go:589:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/frontends/stdio/frontend_test.go:643:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:43:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/ratelimit/redis_circuit_test.go:101:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err) // Fallback should work
		^
services/gateway/internal/ratelimit/redis_circuit_test.go:117:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err) // Should succeed via fallback when circuit is open
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:145:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/ratelimit/redis_circuit_test.go:151:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:177:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:186:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/ratelimit/redis_circuit_test.go:194:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:232:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:236:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/server/coverage_improvement_test.go:35:3: go-require: do not use require in http handlers (testifylint)
		require.NoError(t, err)
		^
services/gateway/internal/server/http_handlers_test.go:37:3: go-require: do not use require in http handlers (testifylint)
		require.NoError(t, err)
		^
services/gateway/internal/server/http_handlers_test.go:449:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/server/per_ip_limit_test.go:229:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err, "Expected connection to be closed due to per-IP limit")
		^
services/gateway/internal/server/tcp_graceful_shutdown_test.go:231:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:241:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), tcpConnTotal, "TCP connections total")
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:321:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), authFailures, "Auth failures")
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:325:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), inboundRequests, "Inbound requests (init)")
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:328:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), versionNegs, "Version negotiations")
	^
services/gateway/internal/server/tcp_health_test.go:71:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/server/tcp_health_test.go:93:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/server/tcp_health_test.go:373:2: float-compare: use require.InEpsilon (or InDelta) (testifylint)
	require.Equal(t, float64(1), inboundCount, "Expected 1 inbound health check message")
	^
services/gateway/internal/server/tcp_health_test.go:377:2: float-compare: use require.InEpsilon (or InDelta) (testifylint)
	require.Equal(t, float64(1), outboundCount, "Expected 1 outbound health check response")
	^
services/gateway/internal/server/tcp_health_test.go:381:2: float-compare: use require.InEpsilon (or InDelta) (testifylint)
	require.Equal(t, float64(0), errorCount, "Expected no health receive errors")
	^
services/gateway/internal/server/tcp_health_test.go:384:2: float-compare: use require.InEpsilon (or InDelta) (testifylint)
	require.Equal(t, float64(0), errorCount, "Expected no health send errors")
	^
services/gateway/internal/server/tcp_health_test.go:387:2: float-compare: use require.InEpsilon (or InDelta) (testifylint)
	require.Equal(t, float64(0), errorCount, "Expected no health flush errors")
	^
services/gateway/internal/session/memory_manager_test.go:76:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/session/memory_manager_test.go:118:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/session/memory_manager_test.go:183:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/session/memory_manager_test.go:187:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/session/memory_manager_test.go:211:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/tracing/tracing_test.go:68:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/tracing/tracing_test.go:133:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/tracing/tracing_test.go:140:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/pkg/health/predictive_test.go:74:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, healthData.HealthScore)
	^
services/gateway/pkg/health/predictive_test.go:194:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, monitor.GetHealthScore(endpoint))
	^
services/gateway/pkg/health/predictive_test.go:199:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, score) // Perfect score for low latency and no errors
	^
services/gateway/pkg/health/predictive_test.go:231:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, confidence)
	^
services/gateway/pkg/health/predictive_test.go:239:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, confidence)
	^
services/gateway/pkg/health/predictive_test.go:245:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 0.0, confidence) // Default confidence
	^
services/gateway/pkg/health/predictive_test.go:330:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, stats.AverageHealthScore)
	^
services/gateway/pkg/health/predictive_test.go:428:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 0.05, monitor.config.ErrorRateThreshold)
	^
services/gateway/pkg/health/predictive_test.go:429:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 2.0, monitor.config.AnomalyDeviationFactor)
	^
services/gateway/pkg/protocol/multiplexer_test.go:242:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/protocol/multiplexer_test.go:276:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/wire/auth_message_test.go:178:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/pkg/wire/auth_message_test.go:260:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/auth_message_test.go:381:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/integration_test.go:45:3: go-require: require must only be used in the goroutine running the test function (testifylint)
		require.NoError(t, err)
		^
services/gateway/pkg/wire/integration_test.go:69:3: go-require: require must only be used in the goroutine running the test function (testifylint)
		require.NoError(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:68:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:106:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:138:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:209:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:212:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:230:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/pkg/wire/transport_additional_test.go:243:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/pkg/wire/transport_additional_test.go:259:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/pkg/wire/transport_additional_test.go:299:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/wire/transport_additional_test.go:324:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/wire/transport_additional_test.go:407:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:422:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:435:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/transport_test.go:65:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:103:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:133:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:158:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:180:3: go-require: require must only be used in the goroutine running the test function (testifylint)
		require.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:198:3: go-require: require must only be used in the goroutine running the test function (testifylint)
		require.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:277:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:293:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/wire/transport_test.go:327:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/wire/version_negotiation_test.go:163:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/version_negotiation_test.go:169:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/version_negotiation_test.go:347:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/version_negotiation_test.go:353:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/version_negotiation_test.go:359:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/version_negotiation_test.go:365:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/test/integration/protocols_integration_test.go:184:2: require-error: for error assertions use require (testifylint)
	suite.NoError(err)
	^
services/gateway/test/testutil/metrics_test.go:280:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), count)
	^
services/gateway/test/testutil/metrics_test.go:294:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), count)
	^
services/gateway/test/testutil/metrics_test.go:311:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(5), count)
	^
services/gateway/test/testutil/metrics_test.go:326:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), count)
	^
services/gateway/test/testutil/metrics_test.go:329:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), count)
	^
services/gateway/test/testutil/metrics_test.go:375:3: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
		assert.Equal(t, float64(tc.increments), count, "Failed for %s/%s", tc.direction, tc.msgType)
		^
services/gateway/test/testutil/metrics_test.go:407:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), count)
	^
services/gateway/test/testutil/metrics_test.go:421:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), count)
	^
services/gateway/test/testutil/metrics_test.go:438:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(3), count)
	^
services/gateway/test/testutil/metrics_test.go:453:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), count)
	^
services/gateway/test/testutil/metrics_test.go:494:3: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
		assert.Equal(t, float64(expectedCount), count, "Failed for error type %s", errorType)
		^
services/gateway/test/testutil/metrics_test.go:533:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(10), registry.GetTCPMessageCount("inbound", "request"))
	^
services/gateway/test/testutil/metrics_test.go:534:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(3), registry.GetTCPProtocolErrorCount("frame_error"))
	^
services/gateway/test/testutil/metrics_test.go:550:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(5), registry.GetTCPMessageCount("outbound", "response"))
	^
services/gateway/test/testutil/metrics_test.go:554:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), newRegistry.GetTCPMessageCount("outbound", "response"))
	^
services/gateway/test/testutil/metrics_test.go:824:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, expectedValue, metric.Gauge.GetValue())
	^
services/gateway/test/testutil/metrics_test.go:850:3: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
		assert.Equal(t, float64(0), count) // Should return 0 for non-existent metrics
		^
services/gateway/test/testutil/metrics_test.go:858:3: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
		assert.Equal(t, float64(0), count) // Should return 0 for non-existent metrics
		^
services/gateway/test/testutil/testutil_test.go:91:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/test/testutil/testutil_test.go:106:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/test/testutil/testutil_test.go:164:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/test/testutil/tls_test.go:178:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/test/testutil/tls_test.go:317:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/test/testutil/tls_test.go:324:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/test/testutil/tls_test.go:389:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:462:6: test helper function should start from t.Helper() (thelper)
func runConnectionTest(t *testing.T, clientConn, serverConn net.Conn) {
     ^
services/gateway/internal/router/router_test.go:408:6: test helper function should start from t.Helper() (thelper)
func handleTestBackendRequest(t *testing.T, w http.ResponseWriter, r *http.Request) {
     ^
services/gateway/internal/server/tcp_graceful_shutdown_test.go:225:6: test helper function should start from t.Helper() (thelper)
func performGracefulShutdown(t *testing.T, server *GatewayServer, ctx context.Context) {
     ^
services/gateway/internal/server/tcp_handler_metrics_test.go:64:6: test helper function should start from t.Helper() (thelper)
func runTCPHandlerMetricsTests(t *testing.T, tests []struct {
     ^
services/gateway/internal/server/tls_test.go:229:6: test helper function should start from t.Helper() (thelper)
func runTLSConfigTests(t *testing.T, tests []tlsConfigTest) {
     ^
services/gateway/internal/server/websocket_origin_test.go:129:6: test helper function should start from t.Helper() (thelper)
func runWebSocketOriginTests(t *testing.T, tests []struct {
     ^
services/gateway/internal/server/websocket_origin_test.go:240:6: test helper function should start from t.Helper() (thelper)
func runWildcardOriginTests(t *testing.T, origins []string, wsURL string) {
     ^
services/gateway/internal/session/manager_test.go:170:6: test helper function should start from t.Helper() (thelper)
func runRedisSessionStoreTests(t *testing.T, tests []struct {
     ^
services/gateway/internal/session/manager_test.go:643:6: test helper function should start from t.Helper() (thelper)
func runSessionTTLTests(t *testing.T, tests []struct {
     ^
services/gateway/pkg/circuit/breaker_test.go:331:6: test helper function should start from t.Helper() (thelper)
func createStateChecker(t *testing.T, cb *CircuitBreaker, states *[]State) func(State) {
     ^
services/gateway/pkg/circuit/breaker_test.go:360:6: test helper function should start from t.Helper() (thelper)
func testOpenStateTransitions(t *testing.T, cb *CircuitBreaker, checkState func(State)) {
     ^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:483:14: test helper function should start from t.Helper() (thelper)
			testFunc: func(t *testing.T, lb *HybridLoadBalancer) {
			          ^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:495:14: test helper function should start from t.Helper() (thelper)
			testFunc: func(t *testing.T, lb *HybridLoadBalancer) {
			          ^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:510:14: test helper function should start from t.Helper() (thelper)
			testFunc: func(t *testing.T, lb *HybridLoadBalancer) {
			          ^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:560:6: test helper function should start from t.Helper() (thelper)
func runPerformanceTestForAlgorithm(t *testing.T, algorithm string, endpoints []*discovery.Endpoint, requests int) {
     ^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:585:6: test helper function should start from t.Helper() (thelper)
func validatePerformanceResults(t *testing.T, algorithm string, successCount, requests int, duration time.Duration) {
     ^
services/gateway/pkg/protocol/multiplexer_test.go:854:6: test helper function should start from t.Helper() (thelper)
func verifyMultiplexerStats(t *testing.T, multiplexer *ConnectionMultiplexer, expectedPools, expectedConnections int) {
     ^
services/gateway/pkg/protocol/multiplexer_test.go:881:6: test helper function should start from t.Helper() (thelper)
func shutdownAndVerifyCleanup(t *testing.T, multiplexer *ConnectionMultiplexer) {
     ^
services/gateway/internal/auth/oauth2_test.go:276:19: unnecessary leading newline (whitespace)
	if tt.wantError {
	                 ^
services/gateway/internal/discovery/kubernetes_test.go:1263:3: unnecessary trailing newline (whitespace)
		}
		^
services/gateway/internal/auth/oauth2_test.go:277:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
		
^
services/gateway/internal/auth/oauth2_test.go:279:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if tt.errorMsg != "" {
		^
services/gateway/internal/auth/oauth2_test.go:846:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server := createCompleteFlowMockServer(t, &callCount)
	^
services/gateway/internal/auth/oauth2_test.go:858:3: missing whitespace above this line (no shared variables above switch) (wsl_v5)
		switch r.URL.Path {
		^
services/gateway/internal/auth/oauth2_test.go:875:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := config.OAuth2Config{
	^
services/gateway/internal/auth/oauth2_test.go:889:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	token := "valid-token"
	^
services/gateway/internal/auth/oauth2_test.go:925:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	provider := &OAuth2Provider{}
	^
services/gateway/internal/auth/oauth2_test.go:926:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createIntrospectionEdgeCaseTests()
	^
services/gateway/internal/auth/oauth2_test.go:930:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			claims := provider.introspectionToClaims(tt.introspection)
			^
services/gateway/internal/auth/provider_test.go:124:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = os.Remove(tmpFile.Name()) }()
	^
services/gateway/internal/auth/provider_test.go:585:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = os.Unsetenv("TEST_JWT_SECRET") }()
	^
services/gateway/internal/backends/sse/backend_test.go:444:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server := createTestSSEServer(t)
	^
services/gateway/internal/backends/sse/backend_test.go:452:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = backend.Stop(ctx) }()
	^
services/gateway/internal/backends/sse/backend_test.go:461:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := Config{
	^
services/gateway/internal/backends/sse/backend_test.go:473:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRequests = 5
	^
services/gateway/internal/backends/sse/backend_test.go:474:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	responses := make(chan *mcp.Response, numRequests)
	^
services/gateway/internal/backends/sse/backend_test.go:487:4: missing whitespace above this line (too many statements above if) (wsl_v5)
			response, err := backend.SendRequest(ctx, req)
			^
services/gateway/internal/config/security_test.go:266:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:76:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:250:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:448:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if tt.errMsg != "" {
		^
services/gateway/internal/config/validation_test.go:463:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:599:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:707:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:824:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:953:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/discovery/consul_advanced_test.go:403:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createConsulAdvancedEndpointTests()
	^
services/gateway/internal/discovery/consul_advanced_test.go:412:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			require.NoError(t, err)
			^
services/gateway/internal/discovery/consul_advanced_test.go:414:4: missing whitespace above this line (invalid statement above if) (wsl_v5)
			if tt.validateFunc != nil {
			^
services/gateway/internal/discovery/consul_advanced_test.go:587:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createHealthCheckAdvancedTests()
	^
services/gateway/internal/discovery/consul_test.go:470:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cleanup, consulAddr, err := setupConsulInfrastructure(t)
	^
services/gateway/internal/discovery/consul_test.go:492:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	consulConfig := consulapi.DefaultConfig()
	^
services/gateway/internal/discovery/consul_test.go:501:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	leader, err := client.Status().Leader()
	^
services/gateway/internal/discovery/consul_test.go:508:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	serviceInfo := testServiceInfo{
	^
services/gateway/internal/discovery/consul_test.go:532:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	services, _, err := client.Health().Service(serviceInfo.Name, "", false, nil)
	^
services/gateway/internal/discovery/consul_test.go:542:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.ServiceDiscoveryConfig{
	^
services/gateway/internal/discovery/consul_test.go:566:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err := client.Agent().ServiceDeregister(serviceID)
	^
services/gateway/internal/discovery/consul_test.go:646:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
		
^
services/gateway/internal/discovery/factory_test.go:139:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			cfg := config.ServiceDiscoveryConfig{
			^
services/gateway/internal/discovery/factory_test.go:175:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			cfg := config.ServiceDiscoveryConfig{
			^
services/gateway/internal/discovery/kubernetes_test.go:85:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, ns := range namespaces.Items {
	^
services/gateway/internal/discovery/kubernetes_test.go:108:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg.Provider = providerKubernetes
	^
services/gateway/internal/discovery/kubernetes_test.go:162:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createKubernetesNamespaceServiceTests()
	^
services/gateway/internal/discovery/kubernetes_test.go:555:2: missing whitespace above this line (invalid statement above range) (wsl_v5)
	for _, ep := range endpoints {
	^
services/gateway/internal/discovery/kubernetes_test.go:565:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if ep.Namespace == "" {
	^
services/gateway/internal/discovery/kubernetes_test.go:585:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if expectedTools > 0 && len(ep.Tools) != expectedTools {
	^
services/gateway/internal/discovery/kubernetes_test.go:593:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if testName != "Multiple services with different weights" {
	^
services/gateway/internal/discovery/kubernetes_test.go:733:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	testService := createTestServiceForWatch()
	^
services/gateway/internal/discovery/kubernetes_test.go:755:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/discovery/kubernetes_test.go:757:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		discovery.handleServiceEvents("test-namespace", eventChan)
		^
services/gateway/internal/discovery/kubernetes_test.go:777:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(100 * time.Millisecond)
	^
services/gateway/internal/discovery/kubernetes_test.go:780:2: missing whitespace above this line (too many statements above send) (wsl_v5)
	modifiedService.Annotations["mcp.bridge/weight"] = "200"
	^
services/gateway/internal/discovery/kubernetes_test.go:782:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(100 * time.Millisecond)
	^
services/gateway/internal/discovery/kubernetes_test.go:785:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(100 * time.Millisecond)
	^
services/gateway/internal/discovery/kubernetes_test.go:886:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	fakeClient.PrependWatchReactor("services", k8stesting.DefaultWatchReactor(fakeServiceWatcher, nil))
	^
services/gateway/internal/discovery/kubernetes_test.go:908:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err := discovery.Start(context.Background())
	^
services/gateway/internal/discovery/kubernetes_test.go:912:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(100 * time.Millisecond) // Give some time for initialization
	^
services/gateway/internal/discovery/kubernetes_test.go:1173:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background() // Test infrastructure context
	^
services/gateway/internal/discovery/kubernetes_test.go:1191:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	createOutput, err := createCmd.CombinedOutput()
	^
services/gateway/internal/discovery/kubernetes_test.go:1205:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	exportOutput, err := exportCmd.CombinedOutput()
	^
services/gateway/internal/discovery/kubernetes_test.go:1208:1: unnecessary whitespace (leading-whitespace) (wsl_v5)

^
services/gateway/internal/discovery/kubernetes_test.go:1217:1: unnecessary whitespace (leading-whitespace) (wsl_v5)

^
services/gateway/internal/discovery/kubernetes_test.go:1248:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cmd := exec.CommandContext(ctx, "kind", "version")
	^
services/gateway/internal/discovery/kubernetes_test.go:1262:1: unnecessary whitespace (trailing-whitespace) (wsl_v5)

^
services/gateway/internal/discovery/simple_coverage_test.go:32:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.SSEDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:43:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	sseBridge, ok := discovery.(*SSEDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:53:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.StdioDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:64:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	stdioBridge, ok := discovery.(*StdioDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:74:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.WebSocketDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:85:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	wsBridge, ok := discovery.(*WebSocketDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:109:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.SSEDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:120:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	sseBridge, ok := discovery.(*SSEDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:122:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/gateway/internal/discovery/simple_coverage_test.go:124:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/discovery/simple_coverage_test.go:126:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		_, _ = sseBridge.Watch(ctx)
		^
services/gateway/internal/discovery/simple_coverage_test.go:128:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	cancel() // Cancel immediately to exit the watch
	^
services/gateway/internal/discovery/simple_coverage_test.go:134:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.StdioDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:145:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	stdioBridge, ok := discovery.(*StdioDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:147:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/gateway/internal/discovery/simple_coverage_test.go:149:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/discovery/simple_coverage_test.go:151:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		_, _ = stdioBridge.Watch(ctx)
		^
services/gateway/internal/discovery/simple_coverage_test.go:153:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	cancel() // Cancel immediately to exit the watch
	^
services/gateway/internal/discovery/simple_coverage_test.go:159:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.WebSocketDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:170:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	wsBridge, ok := discovery.(*WebSocketDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:172:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/gateway/internal/discovery/simple_coverage_test.go:174:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/discovery/simple_coverage_test.go:176:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		_, _ = wsBridge.Watch(ctx)
		^
services/gateway/internal/discovery/simple_coverage_test.go:178:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	cancel() // Cancel immediately to exit the watch
	^
services/gateway/internal/discovery/simple_coverage_test.go:198:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.SSEDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:212:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	sseBridge, ok := discovery.(*SSEDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:214:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/gateway/internal/discovery/simple_coverage_test.go:226:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.StdioDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:240:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	stdioBridge, ok := discovery.(*StdioDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:242:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/gateway/internal/discovery/simple_coverage_test.go:254:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.WebSocketDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:268:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	wsBridge, ok := discovery.(*WebSocketDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:270:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/gateway/internal/discovery/sse_discovery_test.go:24:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createSSEDiscoveryCreationTests()
	^
services/gateway/internal/discovery/sse_discovery_test.go:28:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			sd, err := CreateSSEServiceDiscovery(tt.config, logger)
			^
services/gateway/internal/discovery/sse_discovery_test.go:478:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createSSEURLParsingTests()
	^
services/gateway/internal/discovery/sse_discovery_test.go:482:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			config := config.SSEDiscoveryConfig{
			^
services/gateway/internal/discovery/sse_discovery_test.go:492:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			endpoints := sd.GetEndpoints("default")
			^
services/gateway/internal/discovery/static_test.go:18:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createStaticDiscoveryCreationTests()
	^
services/gateway/internal/discovery/static_test.go:22:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			sd, err := CreateStaticServiceDiscovery(tt.config, logger)
			^
services/gateway/internal/discovery/static_test.go:25:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errContains != "" {
				^
services/gateway/internal/discovery/static_test.go:28:5: missing whitespace above this line (invalid statement above expr) (wsl_v5)
				assert.Nil(t, sd)
				^
services/gateway/internal/discovery/static_test.go:147:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	assert.Equal(t, 3, totalCount) // 2 default + 1 production
	^
services/gateway/internal/discovery/static_test.go:383:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createStaticURLParsingTests()
	^
services/gateway/internal/discovery/static_test.go:387:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			config := config.ServiceDiscoveryConfig{
			^
services/gateway/internal/discovery/static_test.go:401:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			endpoints := sd.GetEndpoints("test")
			^
services/gateway/internal/discovery/stdio_discovery_test.go:19:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createStdioDiscoveryCreationTests()
	^
services/gateway/internal/discovery/stdio_discovery_test.go:23:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			sd, err := CreateStdioServiceDiscovery(tt.config, logger)
			^
services/gateway/internal/discovery/websocket_discovery_test.go:19:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createWebSocketDiscoveryCreationTests()
	^
services/gateway/internal/discovery/websocket_discovery_test.go:23:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			sd, err := CreateWebSocketServiceDiscovery(tt.config, logger)
			^
services/gateway/internal/discovery/websocket_discovery_test.go:475:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createWebSocketURLParsingTests()
	^
services/gateway/internal/discovery/websocket_discovery_test.go:479:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			config := config.WebSocketDiscoveryConfig{
			^
services/gateway/internal/discovery/websocket_discovery_test.go:489:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			endpoints := sd.GetEndpoints("default")
			^
services/gateway/internal/frontends/factory_test.go:107:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	tests := createStdioFrontendTests()
	^
services/gateway/internal/frontends/factory_test.go:133:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.expectError != "" {
				^
services/gateway/internal/frontends/factory_test.go:395:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			frontend, err := factory.CreateFrontend(tt.config, router, auth, sessions)
			^
services/gateway/internal/frontends/factory_test.go:636:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			config := FrontendConfig{
			^
services/gateway/internal/frontends/factory_test.go:644:4: missing whitespace above this line (too many statements above if) (wsl_v5)
			frontend, err := factory.CreateFrontend(config, router, auth, sessions)
			^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:282:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = frontend.Stop(context.Background()) }()
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:295:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if err := os.Remove(socketPath); err != nil && !os.IsNotExist(err) {
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:320:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = conn.Close() }()
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:593:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:628:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:649:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:684:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:695:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err = json.Unmarshal(writer2.Bytes(), &errorResp)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:738:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go frontend.handleRequest(context.Background(), conn, request)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:739:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(responseProcessingTimeout)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:768:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go errorFrontend.handleRequest(context.Background(), conn, request)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:769:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(responseProcessingTimeout)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:774:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err := json.Unmarshal(writer.Bytes(), &errorResp)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:907:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go frontend.handleConnection(context.Background(), testConn)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:1071:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if err := os.Remove(socketPath); err != nil && !os.IsNotExist(err) {
	^
services/gateway/internal/health/checker_test.go:422:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	mockDiscovery := NewMockDiscovery()
	^
services/gateway/internal/health/health_advanced_test.go:425:2: missing whitespace above this line (invalid statement above for) (wsl_v5)
	for i := 0; i < expectedOps; i++ {
	^
services/gateway/internal/logging/structured_test.go:95:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, field := range fields {
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:59:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = db.Close() }()
	^
services/gateway/internal/router/router_test.go:321:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if expectNil {
	^
services/gateway/internal/router/router_test.go:329:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		lb2 := router.getLoadBalancer(namespace)
		^
services/gateway/internal/router/router_test.go:472:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	tests := []struct {
	^
services/gateway/internal/router/router_test.go:501:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, tt := range tests {
	^
services/gateway/internal/router/router_test.go:516:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	backend := setupSessionTestBackend(&sessionReceived)
	^
services/gateway/internal/router/router_test.go:579:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const sessionKey contextKey = "session"
	^
services/gateway/internal/router/router_test.go:580:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.WithValue(context.Background(), sessionKey, sess)
	^
services/gateway/internal/router/router_test.go:856:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	errors := make(chan error, testIterations)
	^
services/gateway/internal/router/router_test.go:860:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func(id int) {
		^
services/gateway/internal/router/router_test.go:862:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			req := &mcp.Request{
			^
services/gateway/internal/router/router_test.go:869:4: missing whitespace above this line (too many statements above if) (wsl_v5)
			_, err := router.RouteRequest(ctx, req, "test")
			^
services/gateway/internal/router/router_test.go:880:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for err := range errors {
	^
services/gateway/internal/router/router_test.go:882:3: missing whitespace above this line (invalid statement above inc-dec) (wsl_v5)
		errorCount++
		^
services/gateway/internal/server/per_ip_limit_test.go:110:4: missing whitespace above this line (invalid statement above for) (wsl_v5)
			for j := 0; j < incrementsPerGoroutine; j++ {
			^
services/gateway/internal/server/per_ip_limit_test.go:122:2: missing whitespace above this line (invalid statement above for) (wsl_v5)
	for i := 0; i < numGoroutines; i++ {
	^
services/gateway/internal/server/per_ip_limit_test.go:125:4: missing whitespace above this line (invalid statement above for) (wsl_v5)
			for j := 0; j < incrementsPerGoroutine; j++ {
			^
services/gateway/internal/server/per_ip_limit_test.go:140:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	conns := testPerIPConnectionLimits(t, serverAddr)
	^
services/gateway/internal/server/per_ip_limit_test.go:198:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go s.acceptTCPConnections()
	^
services/gateway/internal/server/per_ip_limit_test.go:207:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	dialer := &net.Dialer{}
	^
services/gateway/internal/server/per_ip_limit_test.go:213:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		conns = append(conns, conn)
		^
services/gateway/internal/server/per_ip_limit_test.go:214:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		time.Sleep(testTimeout * time.Millisecond) // Give server time to process
		^
services/gateway/internal/server/per_ip_limit_test.go:262:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	conn5, err := dialer.DialContext(context.Background(), "tcp", serverAddr)
	^
services/gateway/internal/server/server_test.go:272:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if resp != nil && resp.Body != nil {
	^
services/gateway/internal/server/server_test.go:296:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		server.connections.Range(func(key, value interface{}) bool {
		^
services/gateway/internal/server/tcp_graceful_shutdown_test.go:217:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		<-ctx.Done()
		^
services/gateway/internal/server/tcp_graceful_shutdown_test.go:221:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		<-ctx.Done()
		^
services/gateway/internal/server/tcp_handler_metrics_test.go:122:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	authProvider := new(MockAuthProvider)
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:168:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	transport := wire.NewTransport(conn)
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:183:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if ack, ok := msg.(*wire.VersionAckPayload); ok {
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:253:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	authProvider := new(MockAuthProvider)
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:277:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	transport := wire.NewTransport(conn)
	^
services/gateway/internal/server/tcp_handler_test.go:402:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = clientConn.Close()
	^
services/gateway/internal/server/tcp_handler_test.go:448:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = clientConn.Close()
	^
services/gateway/internal/server/tcp_health_test.go:102:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = server.Stop() }()
	^
services/gateway/internal/session/manager_test.go:381:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Close() }()
	^
services/gateway/internal/session/manager_test.go:588:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = rm.Close() }()
	^
services/gateway/internal/tracing/otel_test.go:112:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = tracer.Shutdown(context.Background()) }()
	^
services/gateway/internal/tracing/tracing_test.go:401:5: missing whitespace above this line (too many statements above defer) (wsl_v5)
				ctx = opentracing.ContextWithSpan(ctx, span)
				^
services/gateway/pkg/circuit/breaker_test.go:349:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	checkState(StateClosed)
	^
services/gateway/pkg/circuit/breaker_test.go:353:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	checkState(StateClosed)
	^
services/gateway/pkg/circuit/breaker_test.go:357:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	checkState(StateOpen)
	^
services/gateway/pkg/circuit/breaker_test.go:366:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	checkState(StateOpen)
	^
services/gateway/pkg/circuit/breaker_test.go:370:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	timer := time.NewTimer(waitTime)
	^
services/gateway/pkg/circuit/breaker_test.go:372:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	<-timer.C
	^
services/gateway/pkg/circuit/breaker_test.go:378:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	checkState(StateHalfOpen)
	^
services/gateway/pkg/circuit/breaker_test.go:382:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	checkState(StateClosed)
	^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:246:2: missing whitespace above this line (invalid statement above range) (wsl_v5)
	for _, ep := range endpointsNoHTTP {
	^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:546:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	endpoints := make([]*discovery.Endpoint, numEndpoints)
	^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:576:2: missing whitespace above this line (no shared variables above for) (wsl_v5)
	for i := 0; i < requests; i++ {
	^
services/gateway/pkg/protocol/multiplexer.go:426:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var unhealthyConns []*PooledConnection
	^
services/gateway/pkg/protocol/multiplexer.go:431:4: missing whitespace above this line (no shared variables above append) (wsl_v5)
			unhealthyConns = append(unhealthyConns, conn)
			^
services/gateway/pkg/protocol/multiplexer.go:525:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if now.Sub(conn.LastUsedAt) < time.Minute {
		^
services/gateway/pkg/protocol/multiplexer.go:528:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		conn.mu.RUnlock()
		^
services/gateway/pkg/protocol/multiplexer_test.go:848:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			connections = append(connections, conn)
			^
services/gateway/pkg/wire/protocol_test.go:213:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = binary.Write(&buf, binary.BigEndian, MagicBytes)
	^
services/gateway/pkg/wire/protocol_test.go:224:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = binary.Write(&buf, binary.BigEndian, uint32(0xDEADBEEF))
	^
services/gateway/pkg/wire/protocol_test.go:233:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = binary.Write(&buf, binary.BigEndian, MagicBytes)
	^
services/gateway/pkg/wire/protocol_test.go:242:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = binary.Write(&buf, binary.BigEndian, MagicBytes)
	^
services/gateway/pkg/wire/protocol_test.go:250:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = binary.Write(&buf, binary.BigEndian, MagicBytes)
	^
services/gateway/pkg/wire/transport_additional_test.go:208:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if wantErr {
	^
services/gateway/pkg/wire/transport_additional_test.go:218:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			err = json.Unmarshal(data, &decoded)
			^
services/gateway/pkg/wire/transport_additional_test.go:281:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = client.Close() }()
	^
services/gateway/pkg/wire/transport_additional_test.go:307:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = client.Close() }()
	^
services/gateway/pkg/wire/version_negotiation_test.go:162:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if expectError {
	^
services/gateway/pkg/wire/version_negotiation_test.go:164:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if errorContains != "" {
		^
services/gateway/pkg/wire/version_negotiation_test.go:167:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		assert.Equal(t, uint16(0), version)
		^
services/gateway/test/integration/protocols_integration_test.go:56:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = backend.Stop(suite.ctx) }()
	^
services/gateway/test/integration/protocols_integration_test.go:177:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = backend.Stop(suite.ctx) }()
	^
services/gateway/test/integration/protocols_integration_test.go:211:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = backend.Stop(suite.ctx) }()
	^
services/gateway/test/integration/protocols_integration_test.go:214:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	duration := suite.runPerformanceTest(backend, numRequests)
	^
services/gateway/test/integration/protocols_integration_test.go:280:2: missing whitespace above this line (no shared variables above for) (wsl_v5)
	for i := 0; i < numRequests; i++ {
	^
services/gateway/test/integration/protocols_integration_test.go:303:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = stdioBackend.Stop(suite.ctx) }()
	^
services/gateway/test/integration/protocols_integration_test.go:307:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	stdioErrors, wsErrors := suite.runConcurrentRequests(stdioBackend, wsBackendInstance, numRequests)
	^
services/gateway/test/integration/protocols_integration_test.go:403:4: missing whitespace above this line (too many statements above send) (wsl_v5)
			_, err := stdioBackend.SendRequest(suite.ctx, req)
			^
services/gateway/test/integration/protocols_integration_test.go:418:4: missing whitespace above this line (too many statements above send) (wsl_v5)
			_, err := wsBackendInstance.SendRequest(suite.ctx, req)
			^
services/gateway/test/integration/protocols_integration_test.go:426:2: missing whitespace above this line (no shared variables above for) (wsl_v5)
	for i := 0; i < numRequests; i++ {
	^
services/gateway/test/integration/protocols_integration_test.go:430:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if err := <-wsResults; err != nil {
		^
services/gateway/test/testutil/metrics_test.go:515:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	registry := CreateTestMetricsRegistryWithHelpers()
	^
services/gateway/test/testutil/metrics_test.go:542:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	registry := CreateTestMetricsRegistryWithHelpers()
	^
services/gateway/test/testutil/metrics_test.go:559:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	registry := CreateTestMetricsRegistryWithHelpers()
	^
services/gateway/test/testutil/testutil_test.go:153:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	secret := []byte("test-secret-key")
	^
services/gateway/test/testutil/tls_test.go:104:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, ip := range serverCert.IPAddresses {
	^
services/gateway/test/testutil/tls_test.go:110:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	assert.True(t, hasLocalhostIP, "Server certificate should contain localhost IP")
	^
services/gateway/test/testutil/tls_test.go:247:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = serverConn.Close() }()
	^
services/gateway/test/testutil/tls_test.go:294:2: missing whitespace above this line (too many statements above send) (wsl_v5)
	err := tlsServerConn.HandshakeContext(context.Background())
	^
services/gateway/test/testutil/tls_test.go:304:2: missing whitespace above this line (too many statements above send) (wsl_v5)
	err := tlsClientConn.HandshakeContext(context.Background())
	^
services/gateway/test/testutil/tls_test.go:344:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = serverConn.Close() }()
	^
668 issues:
* contextcheck: 5
* exhaustive: 1
* forcetypeassert: 1
* gosec: 32
* ireturn: 31
* lll: 80
* nlreturn: 51
* testifylint: 219
* thelper: 18
* whitespace: 2
* wsl_v5: 228
Module gateway: 668 issues found
services/gateway/internal/server/server.go:585:31: Non-inherited new context, use function like `context.WithXXX` or `r.Context` instead (contextcheck)
		s.handleConnectionLimitError(ctx, w, err, clientIP)
		                            ^
services/gateway/internal/server/server.go:592:51: Non-inherited new context, use function like `context.WithXXX` or `r.Context` instead (contextcheck)
	authClaims, err := s.authenticateWebSocketRequest(ctx, w, r, clientIP, traceID, requestID)
	                                                 ^
services/gateway/internal/server/server.go:602:46: Non-inherited new context, use function like `context.WithXXX` or `r.Context` instead (contextcheck)
	conn, sess, err := s.upgradeAndCreateSession(enrichedCtx, w, r, authClaims, traceID, requestID)
	                                            ^
services/gateway/internal/server/server.go:609:30: Non-inherited new context, use function like `context.WithXXX` or `r.Context` instead (contextcheck)
	s.setupAndRegisterConnection(enrichedCtx, conn, sess, authClaims, clientIP, r.RemoteAddr)
	                            ^
services/gateway/internal/server/tcp_graceful_shutdown_test.go:230:24: Non-inherited new context, use function like `context.WithXXX` instead (contextcheck)
	err := server.Shutdown(shutdownCtx)
	                      ^
services/gateway/internal/logging/structured_test.go:96:3: missing cases in switch of type zapcore.FieldType: zapcore.UnknownType, zapcore.ArrayMarshalerType, zapcore.ObjectMarshalerType, zapcore.BinaryType, zapcore.ByteStringType, zapcore.Complex128Type, zapcore.Complex64Type, zapcore.DurationType, zapcore.Float64Type, zapcore.Float32Type, zapcore.Int32Type, zapcore.Int16Type, zapcore.Int8Type, zapcore.TimeType, zapcore.TimeFullType, zapcore.Uint64Type, zapcore.Uint32Type, zapcore.Uint16Type, zapcore.Uint8Type, zapcore.UintptrType, zapcore.ReflectType, zapcore.NamespaceType, zapcore.StringerType, zapcore.SkipType, zapcore.InlineMarshalerType (exhaustive)
		switch field.Type {
		^
services/gateway/internal/tracing/tracing_test.go:390:2: type assertion must be checked (forcetypeassert)
	tracer := opentracing.GlobalTracer().(*mocktracer.MockTracer)
	^
services/gateway/internal/backends/stdio/backend_test.go:361:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(content), 0o755) 
	       ^
services/gateway/internal/backends/websocket/backend.go:438:12: G115: integer overflow conversion uint64 -> int (gosec)
	return int(nextID % uint64(endpointCount)) 
	          ^
services/gateway/internal/discovery/consul_test.go:629:9: G204: Subprocess launched with variable (gosec)
	cmd := exec.CommandContext(ctx, "docker", "run", "-d", "--rm",
		"--name", containerName,
		"-p", fmt.Sprintf("%d:8500", port),
		"consul:1.16",
		"agent", "-dev", "-client", "0.0.0.0")
services/gateway/internal/discovery/consul_test.go:647:7: G204: Subprocess launched with variable (gosec)
		_ = exec.CommandContext(ctx, "docker", "stop", containerName).Run()
		    ^
services/gateway/internal/discovery/consul_test.go:656:10: G204: Subprocess launched with variable (gosec)
		cmd := exec.CommandContext(ctx, "docker", "stop", containerName)
		       ^
services/gateway/internal/discovery/kubernetes_test.go:1190:15: G204: Subprocess launched with variable (gosec)
	createCmd := exec.CommandContext(ctx, "kind", "create", "cluster", "--name", clusterName, "--wait", "60s")
	             ^
services/gateway/internal/discovery/kubernetes_test.go:1203:15: G204: Subprocess launched with variable (gosec)
	exportCmd := exec.CommandContext(ctx, "kind", "export", "kubeconfig",
		"--name", clusterName, "--kubeconfig", kubeconfigPath)
services/gateway/internal/discovery/kubernetes_test.go:1210:7: G204: Subprocess launched with variable (gosec)
		_ = exec.CommandContext(ctx, "kind", "delete", "cluster", "--name", clusterName).Run()
		    ^
services/gateway/internal/discovery/kubernetes_test.go:1219:7: G204: Subprocess launched with variable (gosec)
		_ = exec.CommandContext(ctx, "kind", "delete", "cluster", "--name", clusterName).Run()
		    ^
services/gateway/internal/discovery/kubernetes_test.go:1229:16: G204: Subprocess launched with variable (gosec)
		deleteCmd := exec.CommandContext(ctx, "kind", "delete", "cluster", "--name", clusterName)
		             ^
services/gateway/internal/server/http_handlers_test.go:198:51: G103: Use of unsafe calls should be audited (gosec)
		statusField = reflect.NewAt(statusField.Type(), unsafe.Pointer(statusField.UnsafeAddr())).Elem() 
		                                                ^
services/gateway/internal/server/server.go:1559:16: G402: TLS MinVersion too low. (gosec)
	tlsConfig := &tls.Config{ 
		Certificates: []tls.Certificate{cert},
		MinVersion:   minVersion,
	}
services/gateway/internal/tracing/tracing_test.go:152:17: G115: integer overflow conversion int -> uint64 (gosec)
			return uint64(mockCtx.SpanID) 
			             ^
services/gateway/internal/tracing/tracing_test.go:156:13: G115: integer overflow conversion int -> uint64 (gosec)
	}(), uint64(childRecord.ParentID)) 
	           ^
services/gateway/internal/tracing/tracing_test.go:300:24: G115: integer overflow conversion int -> uint16 (gosec)
	assert.Equal(t, uint16(tt.expectedStatus), requestSpan.Tag("http.status_code"))
	                      ^
services/gateway/pkg/circuit/breaker_test.go:306:21: G115: integer overflow conversion int -> int32 (gosec)
	totalCalls := int32(numGoroutines * callsPerGoroutine) 
	                   ^
services/gateway/pkg/wire/auth_message_test.go:468:3: G101: Potential hardcoded credentials (gosec)
		authToken := "roundtrip-resp-token"
		^
services/gateway/pkg/wire/protocol_test.go:109:24: G115: integer overflow conversion int -> uint32 (gosec)
	assert.Equal(t, uint32(len(frame.Payload)), payloadLen)
	                      ^
services/gateway/pkg/wire/protocol_test.go:217:49: G115: integer overflow conversion int -> uint32 (gosec)
	_ = binary.Write(&buf, binary.BigEndian, uint32(len(payload)))
	                                               ^
services/gateway/test/integration/protocols_integration_test.go:295:20: G115: integer overflow conversion int -> uint64 (gosec)
	suite.Equal(uint64(numRequests), metrics.RequestCount)
	                  ^
services/gateway/test/integration/protocols_integration_test.go:456:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(content), 0o700) 
	       ^
services/gateway/test/testutil/tls_test.go:68:20: G304: Potential file inclusion via variable (gosec)
	caCertPEM, err := os.ReadFile(caFile)
	                  ^
services/gateway/test/testutil/tls_test.go:88:24: G304: Potential file inclusion via variable (gosec)
	serverCertPEM, err := os.ReadFile(certFile)
	                      ^
services/gateway/test/testutil/tls_test.go:119:23: G304: Potential file inclusion via variable (gosec)
	serverKeyPEM, err := os.ReadFile(keyFile)
	                     ^
services/gateway/test/testutil/tls_test.go:163:20: G304: Potential file inclusion via variable (gosec)
	caCertPEM, err := os.ReadFile(caFile)
	                  ^
services/gateway/test/testutil/tls_test.go:170:24: G304: Potential file inclusion via variable (gosec)
	serverCertPEM, err := os.ReadFile(certFile)
	                      ^
services/gateway/test/testutil/tls_test.go:261:20: G304: Potential file inclusion via variable (gosec)
	caCertPEM, err := os.ReadFile(caFile)
	                  ^
services/gateway/test/testutil/tls_test.go:458:18: G304: Potential file inclusion via variable (gosec)
	certPEM, err := os.ReadFile(certFile)
	                ^
services/gateway/test/testutil/tls_test.go:514:20: G304: Potential file inclusion via variable (gosec)
		cert1PEM, err := os.ReadFile(certFile1) 
		                 ^
services/gateway/test/testutil/tls_test.go:516:20: G304: Potential file inclusion via variable (gosec)
		cert2PEM, err := os.ReadFile(certFile2) 
		                 ^
services/gateway/test/testutil/tls_test.go:519:18: G304: Potential file inclusion via variable (gosec)
		ca1PEM, err := os.ReadFile(caFile1) 
		               ^
services/gateway/test/testutil/tls_test.go:521:18: G304: Potential file inclusion via variable (gosec)
		ca2PEM, err := os.ReadFile(caFile2) 
		               ^
services/gateway/cmd/mcp-gateway/main.go:234:1: createRateLimiter returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/ratelimit.RateLimiter) (ireturn)
func createRateLimiter(cfg *config.Config, sessionMgr session.Manager, logger *zap.Logger) ratelimit.RateLimiter {
^
services/gateway/internal/auth/provider.go:53:1: InitializeAuthenticationProvider returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/auth.Provider) (ireturn)
func InitializeAuthenticationProvider(cfg config.AuthConfig, logger *zap.Logger) (Provider, error) {
^
services/gateway/internal/backends/factory.go:86:1: CreateBackend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/backends.Backend) (ireturn)
func (f *DefaultFactory) CreateBackend(config BackendConfig) (Backend, error) {
^
services/gateway/internal/backends/factory.go:108:1: createStdioBackend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/backends.Backend) (ireturn)
func (f *DefaultFactory) createStdioBackend(config BackendConfig) (Backend, error) {
^
services/gateway/internal/backends/factory.go:233:1: createWebSocketBackend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/backends.Backend) (ireturn)
func (f *DefaultFactory) createWebSocketBackend(config BackendConfig) (Backend, error) {
^
services/gateway/internal/backends/factory.go:379:1: createSSEBackend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/backends.Backend) (ireturn)
func (f *DefaultFactory) createSSEBackend(config BackendConfig) (Backend, error) {
^
services/gateway/internal/discovery/factory.go:14:1: CreateServiceDiscoveryProvider returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/discovery.ServiceDiscovery) (ireturn)
func CreateServiceDiscoveryProvider(cfg config.ServiceDiscoveryConfig, logger *zap.Logger) (ServiceDiscovery, error) {
^
services/gateway/internal/discovery/kubernetes_test.go:32:1: createKubernetesTestClient returns interface (k8s.io/client-go/kubernetes.Interface) (ireturn)
func createKubernetesTestClient(t *testing.T, kubeconfig string) kubernetes.Interface {
^
services/gateway/internal/discovery/sse_discovery.go:37:1: CreateSSEServiceDiscovery returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/discovery.ServiceDiscovery) (ireturn)
func CreateSSEServiceDiscovery(cfg config.SSEDiscoveryConfig, logger *zap.Logger) (ServiceDiscovery, error) {
^
services/gateway/internal/discovery/stdio_discovery.go:32:1: CreateStdioServiceDiscovery returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/discovery.ServiceDiscovery) (ireturn)
func CreateStdioServiceDiscovery(cfg config.StdioDiscoveryConfig, logger *zap.Logger) (ServiceDiscovery, error) {
^
services/gateway/internal/discovery/websocket_discovery.go:34:1: CreateWebSocketServiceDiscovery returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/discovery.ServiceDiscovery) (ireturn)
func CreateWebSocketServiceDiscovery(
^
services/gateway/internal/frontends/factory.go:45:1: CreateFrontend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/frontends.Frontend) (ireturn)
func (f *DefaultFactory) CreateFrontend(
^
services/gateway/internal/frontends/factory.go:67:1: createStdioFrontend returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/frontends.Frontend) (ireturn)
func (f *DefaultFactory) createStdioFrontend(
^
services/gateway/internal/logging/structured.go:179:1: ErrorSampler returns interface (go.uber.org/zap/zapcore.Core) (ireturn)
func ErrorSampler(core zapcore.Core) zapcore.Core { 
^
services/gateway/internal/metrics/metrics.go:108:1: createTCPMetrics returns interface (github.com/prometheus/client_golang/prometheus.Gauge) (ireturn)
func createTCPMetrics(factory promauto.Factory) (
^
services/gateway/internal/ratelimit/redis_circuit_test.go:74:1: setupCircuitRecoveryTest returns interface (github.com/go-redis/redismock/v8.ClientMock) (ireturn)
func setupCircuitRecoveryTest(t *testing.T) (*redis.Client, redismock.ClientMock, *RedisRateLimiterWithCircuitBreaker) {
^
services/gateway/internal/router/router.go:589:1: getLoadBalancer returns interface (github.com/poiley/mcp-bridge/services/gateway/pkg/loadbalancer.LoadBalancer) (ireturn)
func (r *Router) getLoadBalancer(namespace string) loadbalancer.LoadBalancer {
^
services/gateway/internal/session/manager.go:62:1: CreateSessionStorageManager returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/session.Manager) (ireturn)
func CreateSessionStorageManager(ctx context.Context, cfg config.SessionConfig, logger *zap.Logger) (Manager, error) {
^
services/gateway/internal/session/manager.go:98:1: InitializeRedisSessionStore returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/session.Manager) (ireturn)
func InitializeRedisSessionStore(ctx context.Context, cfg config.RedisConfig, logger *zap.Logger) (Manager, error) {
^
services/gateway/internal/session/manager_test.go:291:1: setupRedisManagerTest returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/session.Manager) (ireturn)
func setupRedisManagerTest(t *testing.T) (*miniredis.Miniredis, Manager) { 
^
services/gateway/internal/session/manager_test.go:388:1: setupRedisManagerForUpdate returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/session.Manager) (ireturn)
func setupRedisManagerForUpdate(t *testing.T) Manager {
^
services/gateway/internal/session/memory_manager.go:28:1: CreateInMemorySessionStore returns interface (github.com/poiley/mcp-bridge/services/gateway/internal/session.Manager) (ireturn)
func CreateInMemorySessionStore(logger *zap.Logger, cleanupInterval time.Duration) Manager {
^
services/gateway/internal/tracing/otel.go:113:1: createExporter returns interface (go.opentelemetry.io/otel/sdk/trace.SpanExporter) (ireturn)
func createExporter(cfg config.TracingConfig, logger *zap.Logger) (sdktrace.SpanExporter, error) {
^
services/gateway/internal/tracing/otel.go:136:1: createSampler returns interface (go.opentelemetry.io/otel/sdk/trace.Sampler) (ireturn)
func createSampler(cfg config.TracingConfig) sdktrace.Sampler { 
^
services/gateway/internal/tracing/otel.go:151:1: StartSpan returns interface (go.opentelemetry.io/otel/trace.Span) (ireturn)
func (t *OTelTracer) StartSpan(ctx context.Context, name string) (context.Context, trace.Span) {
^
services/gateway/internal/tracing/tracing.go:33:1: InitTracer returns interface (github.com/opentracing/opentracing-go.Tracer) (ireturn)
func InitTracer(cfg Config, logger *zap.Logger) (opentracing.Tracer, io.Closer, error) {
^
services/gateway/internal/tracing/tracing.go:76:1: StartSpanFromContext returns interface (github.com/opentracing/opentracing-go.Span) (ireturn)
func StartSpanFromContext(ctx context.Context, operationName string, opts ...opentracing.StartSpanOption) (opentracing.Span, context.Context) {
^
services/gateway/internal/tracing/tracing.go:91:1: ExtractHTTPHeaders returns interface (github.com/opentracing/opentracing-go.SpanContext) (ireturn)
func ExtractHTTPHeaders(req *http.Request) (opentracing.SpanContext, error) {
^
services/gateway/test/testutil/metrics.go:13:1: createTestConnectionMetrics returns interface (github.com/prometheus/client_golang/prometheus.Gauge) (ireturn)
func createTestConnectionMetrics() (prometheus.Gauge, prometheus.Gauge, prometheus.Counter) {
^
services/gateway/test/testutil/metrics.go:32:1: createTestRequestMetrics returns interface (github.com/prometheus/client_golang/prometheus.Gauge) (ireturn)
func createTestRequestMetrics() (*prometheus.CounterVec, *prometheus.HistogramVec, prometheus.Gauge) {
^
services/gateway/test/testutil/metrics.go:52:1: createTestTCPMetrics returns interface (github.com/prometheus/client_golang/prometheus.Gauge) (ireturn)
func createTestTCPMetrics() (
^
services/gateway/internal/backends/sse/backend_test.go:558:1: The line is 151 characters long, which exceeds the maximum of 120 characters. (lll)
func processSSERequests(w http.ResponseWriter, r *http.Request, flusher http.Flusher, pendingRequests map[string]mcp.Request, requestsMu *sync.Mutex) {
^
services/gateway/internal/backends/sse/backend_test.go:573:1: The line is 138 characters long, which exceeds the maximum of 120 characters. (lll)
func processPendingRequests(w http.ResponseWriter, flusher http.Flusher, pendingRequests map[string]mcp.Request, requestsMu *sync.Mutex) {
^
services/gateway/internal/backends/sse/backend_test.go:616:1: The line is 128 characters long, which exceeds the maximum of 120 characters. (lll)
func handlePostRequest(w http.ResponseWriter, r *http.Request, pendingRequests map[string]mcp.Request, requestsMu *sync.Mutex) {
^
services/gateway/internal/config/security_test.go:130:1: The line is 122 characters long, which exceeds the maximum of 120 characters. (lll)
			TokenEndpoint: "https://auth.example.com/oauth/token", IntrospectEndpoint: "https://auth.example.com/oauth/introspect",
^
services/gateway/internal/config/security_test.go:784:1: The line is 140 characters long, which exceeds the maximum of 120 characters. (lll)
						ClientID: "secure-client", TokenEndpoint: "https://auth.example.com/token", IntrospectEndpoint: "https://auth.example.com/introspect",
^
services/gateway/internal/config/validation_test.go:46:1: The line is 125 characters long, which exceeds the maximum of 120 characters. (lll)
		{"invalid circuit breaker config", createConfigWithInvalidCircuitBreaker(), true, "invalid circuit breaker configuration"},
^
services/gateway/internal/config/validation_test.go:404:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
					ClientID: "test-client", TokenEndpoint: "https://auth.example.com/token", IntrospectEndpoint: "https://auth.example.com/introspect",
^
services/gateway/internal/config/validation_test.go:426:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
				OAuth2: OAuth2Config{TokenEndpoint: "https://auth.example.com/token", IntrospectEndpoint: "https://auth.example.com/introspect"},
^
services/gateway/internal/discovery/consul_advanced_test.go:89:1: The line is 131 characters long, which exceeds the maximum of 120 characters. (lll)
			assert.Equal(t, tt.expectedMatch, result, "Service %s with tags %v should match: %v", tt.serviceName, tt.tags, tt.expectedMatch)
^
services/gateway/internal/discovery/consul_advanced_test.go:143:1: The line is 151 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "weather-1", Namespace: "weather", Address: "127.0.0.1", Port: 8080, Healthy: true, Metadata: map[string]string{"consul_id": "weather-1"}},
^
services/gateway/internal/discovery/consul_advanced_test.go:144:1: The line is 152 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "weather-2", Namespace: "weather", Address: "127.0.0.2", Port: 8080, Healthy: false, Metadata: map[string]string{"consul_id": "weather-2"}},
^
services/gateway/internal/discovery/consul_advanced_test.go:145:1: The line is 151 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "weather-3", Namespace: "weather", Address: "127.0.0.3", Port: 8080, Healthy: true, Metadata: map[string]string{"consul_id": "weather-3"}},
^
services/gateway/internal/discovery/kubernetes_test.go:738:1: The line is 157 characters long, which exceeds the maximum of 120 characters. (lll)
func createKubernetesDiscoveryForWatch(ctx context.Context, cancel context.CancelFunc, logger *zap.Logger, fakeClient *fake.Clientset) *KubernetesDiscovery {
^
services/gateway/internal/discovery/kubernetes_test.go:891:1: The line is 148 characters long, which exceeds the maximum of 120 characters. (lll)
func createStartStopDiscovery(ctx context.Context, cancel context.CancelFunc, logger *zap.Logger, fakeClient *fake.Clientset) *KubernetesDiscovery {
^
services/gateway/internal/frontends/factory_test.go:25:1: The line is 128 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *mockRequestRouter) RouteRequest(ctx context.Context, req *mcp.Request, targetNamespace string) (*mcp.Response, error) {
^
services/gateway/internal/frontends/factory_test.go:41:1: The line is 124 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *mockAuthProvider) GetUserInfo(ctx context.Context, credentials map[string]string) (map[string]interface{}, error) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:45:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *MockRequestRouterWithError) RouteRequest(ctx context.Context, req *mcp.Request, targetNamespace string) (*mcp.Response, error) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:71:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *MockAuthProviderWithError) GetUserInfo(ctx context.Context, credentials map[string]string) (map[string]interface{}, error) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:587:1: The line is 176 characters long, which exceeds the maximum of 120 characters. (lll)
func testSuccessfulAuth(t *testing.T, config Config, mockRouter *MockRequestRouter, mockAuth *MockAuthProviderWithError, mockSessions *MockSessionManager, logger *zap.Logger) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:639:1: The line is 135 characters long, which exceeds the maximum of 120 characters. (lll)
func testFailedAuth(t *testing.T, config Config, mockRouter *MockRequestRouter, mockSessions *MockSessionManager, logger *zap.Logger) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:718:1: The line is 139 characters long, which exceeds the maximum of 120 characters. (lll)
func testSuccessfulRequest(t *testing.T, config Config, mockAuth *MockAuthProvider, mockSessions *MockSessionManager, logger *zap.Logger) {
^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:744:1: The line is 144 characters long, which exceeds the maximum of 120 characters. (lll)
func testRequestWithRouterError(t *testing.T, config Config, mockAuth *MockAuthProvider, mockSessions *MockSessionManager, logger *zap.Logger) {
^
services/gateway/internal/frontends/stdio/frontend_test.go:19:1: The line is 128 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *MockRequestRouter) RouteRequest(ctx context.Context, req *mcp.Request, targetNamespace string) (*mcp.Response, error) {
^
services/gateway/internal/frontends/stdio/frontend_test.go:33:1: The line is 124 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *MockAuthProvider) GetUserInfo(ctx context.Context, credentials map[string]string) (map[string]interface{}, error) {
^
services/gateway/internal/ratelimit/redis_circuit_test.go:88:1: The line is 161 characters long, which exceeds the maximum of 120 characters. (lll)
func causeCircuitToOpen(t *testing.T, mock redismock.ClientMock, limiter *RedisRateLimiterWithCircuitBreaker, ctx context.Context, config auth.RateLimitConfig) {
^
services/gateway/internal/ratelimit/redis_circuit_test.go:106:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyCircuitRecovery(t *testing.T, limiter *RedisRateLimiterWithCircuitBreaker, ctx context.Context, config auth.RateLimitConfig) {
^
services/gateway/internal/router/router_test.go:319:1: The line is 127 characters long, which exceeds the maximum of 120 characters. (lll)
func validateLoadBalancerResult(t *testing.T, lb loadbalancer.LoadBalancer, expectNil bool, router *Router, namespace string) {
^
services/gateway/internal/server/server_test.go:36:1: The line is 124 characters long, which exceeds the maximum of 120 characters. (lll)
	cfg, mockAuth, mockSessions, testRouter, mockHealth, registry, mockRateLimiter, logger := setupBootstrapTestDependencies(t)
^
services/gateway/internal/server/server_test.go:38:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
	server := BootstrapGatewayServer(cfg, mockAuth, mockSessions, testRouter, mockHealth, registry, mockRateLimiter, logger)
^
services/gateway/internal/server/server_test.go:43:1: The line is 196 characters long, which exceeds the maximum of 120 characters. (lll)
func setupBootstrapTestDependencies(t *testing.T) (*config.Config, *mockAuthProvider, *mockSessionManager, *router.Router, *health.Checker, *metrics.Registry, ratelimit.RateLimiter, *zap.Logger) {
^
services/gateway/internal/server/server_test.go:67:1: The line is 158 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), testutil.NewTestLogger(t))
^
services/gateway/internal/server/server_test.go:77:1: The line is 166 characters long, which exceeds the maximum of 120 characters. (lll)
func validateBootstrappedServer(t *testing.T, server *GatewayServer, cfg *config.Config, mockHealth *health.Checker, registry *metrics.Registry, logger *zap.Logger) {
^
services/gateway/internal/server/server_test.go:233:1: The line is 158 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), testutil.NewTestLogger(t))
^
services/gateway/internal/server/server_test.go:240:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
	server := BootstrapGatewayServer(cfg, mockAuth, mockSessions, testRouter, mockHealth, registry, mockRateLimiter, logger)
^
services/gateway/internal/server/server_test.go:423:1: The line is 145 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), zap.NewNop())
^
services/gateway/internal/server/server_test.go:451:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func validateProcessClientMessageResult(t *testing.T, err error, client *ClientConnection, tt processClientMessageTest) {
^
services/gateway/internal/server/server_test.go:834:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *mockRouter) RouteRequest(ctx context.Context, req *mcp.Request, targetNamespace string) (*mcp.Response, error) {
^
services/gateway/internal/server/server_test.go:902:1: The line is 145 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), zap.NewNop())
^
services/gateway/internal/server/tcp_handler_metrics_test.go:120:1: The line is 132 characters long, which exceeds the maximum of 120 characters. (lll)
func setupSuccessfulMetricsTest(t *testing.T) (*TCPHandler, *MockAuthProvider, *MockRouter, *MockSessionManager, *MockRateLimiter) {
^
services/gateway/internal/server/tcp_handler_metrics_test.go:251:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
func setupAuthFailureMetricsTest(t *testing.T) (*TCPHandler, *MockAuthProvider, *MockRouter, *MockSessionManager, *MockRateLimiter) {
^
services/gateway/internal/server/tcp_handler_test.go:65:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *MockRouter) RouteRequest(ctx context.Context, req *mcp.Request, targetNamespace string) (*mcp.Response, error) {
^
services/gateway/internal/server/tcp_handler_test.go:204:1: The line is 122 characters long, which exceeds the maximum of 120 characters. (lll)
func setupSuccessfulAuthMocks(t *testing.T, logger *zap.Logger, registry *metrics.Registry) (*TCPHandler, *tcpTestMocks) {
^
services/gateway/internal/server/tcp_health_test.go:75:1: The line is 125 characters long, which exceeds the maximum of 120 characters. (lll)
	server = CreateTCPHealthCheckServer(1, checker, metrics, logger) // Use port 1 to enable, will get actual port from listener
^
services/gateway/internal/server/websocket_origin_test.go:76:1: The line is 145 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), zap.NewNop())
^
services/gateway/internal/server/websocket_origin_test.go:83:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
	server := BootstrapGatewayServer(cfg, mockAuth, mockSessions, testRouter, mockHealth, registry, mockRateLimiter, logger)
^
services/gateway/internal/server/websocket_origin_test.go:225:1: The line is 145 characters long, which exceeds the maximum of 120 characters. (lll)
	testRouter := router.InitializeRequestRouter(context.Background(), routerCfg, mockDiscovery, testutil.CreateTestMetricsRegistry(), zap.NewNop())
^
services/gateway/internal/server/websocket_origin_test.go:232:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
	server := BootstrapGatewayServer(cfg, mockAuth, mockSessions, testRouter, mockHealth, registry, mockRateLimiter, logger)
^
services/gateway/internal/tracing/tracing_test.go:414:1: The line is 122 characters long, which exceeds the maximum of 120 characters. (lll)
func executeTracedHTTPRequest(t *testing.T, ctx context.Context, server *httptest.Server, client *http.Client, tt struct {
^
services/gateway/internal/validation/validation_test.go:515:1: The line is 170 characters long, which exceeds the maximum of 120 characters. (lll)
			token:   "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",
^
services/gateway/internal/validation/validation_test.go:1080:1: The line is 174 characters long, which exceeds the maximum of 120 characters. (lll)
	const testJWT = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
^
services/gateway/pkg/loadbalancer/hybrid_test.go:132:1: The line is 129 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 9090, Scheme: "http", Healthy: true, Weight: 1, Metadata: map[string]string{"protocol": "http"}}, 
^
services/gateway/pkg/loadbalancer/hybrid_test.go:133:1: The line is 129 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 9091, Scheme: "http", Healthy: true, Weight: 3, Metadata: map[string]string{"protocol": "http"}}, 
^
services/gateway/pkg/loadbalancer/hybrid_test.go:246:1: The line is 130 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 9090, Scheme: "http", Healthy: true, Weight: 2, Metadata: map[string]string{"protocol": "http"}},  
^
services/gateway/pkg/loadbalancer/hybrid_test.go:247:1: The line is 130 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 9091, Scheme: "http", Healthy: false, Weight: 1, Metadata: map[string]string{"protocol": "http"}}, 
^
services/gateway/pkg/loadbalancer/hybrid_test.go:248:1: The line is 131 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 8080, Scheme: "ws", Healthy: true, Weight: 1, Metadata: map[string]string{"protocol": "websocket"}},
^
services/gateway/pkg/loadbalancer/hybrid_test.go:249:1: The line is 127 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "localhost", Port: 0, Scheme: "stdio", Healthy: true, Weight: 1, Metadata: map[string]string{"protocol": "stdio"}},
^
services/gateway/pkg/loadbalancer/hybrid_test.go:325:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
		{Address: "127.0.0.1", Port: 8080, Scheme: "ws", Healthy: false, Metadata: map[string]string{"protocol": "websocket"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:198:1: The line is 165 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "http-svc1", Address: "192.168.1.1", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "http", Metadata: map[string]string{"protocol": "http"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:199:1: The line is 165 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "http-svc2", Address: "192.168.1.2", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "http", Metadata: map[string]string{"protocol": "http"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:200:1: The line is 166 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "ws-svc1", Address: "192.168.1.3", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "ws", Metadata: map[string]string{"protocol": "websocket"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:201:1: The line is 167 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "ws-svc2", Address: "192.168.1.4", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "wss", Metadata: map[string]string{"protocol": "websocket"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:202:1: The line is 180 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "sse-svc1", Address: "192.168.1.5", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "http", Path: "/events", Metadata: map[string]string{"protocol": "sse"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:281:1: The line is 166 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "http-svc1", Address: "192.168.1.1", Port: 8080, Healthy: false, Weight: testIterations, Scheme: "http", Metadata: map[string]string{"protocol": "http"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:282:1: The line is 167 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "ws-svc1", Address: "192.168.1.3", Port: 8080, Healthy: false, Weight: testIterations, Scheme: "ws", Metadata: map[string]string{"protocol": "websocket"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:283:1: The line is 180 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "sse-svc1", Address: "192.168.1.5", Port: 8080, Healthy: true, Weight: testIterations, Scheme: "http", Path: "/events", Metadata: map[string]string{"protocol": "sse"}},
^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:628:1: The line is 123 characters long, which exceeds the maximum of 120 characters. (lll)
		{Service: "svc3", Address: "192.168.1.3", Port: 8080, Healthy: true, Weight: testIterations}, // svc2 removed, svc3 added
^
services/gateway/pkg/protocol/converter_test.go:156:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyProtocolConversion(t *testing.T, converted Message, expectedProtocol string, expectedMeta map[string]string) {
^
services/gateway/pkg/protocol/multiplexer_test.go:839:1: The line is 135 characters long, which exceeds the maximum of 120 characters. (lll)
func createMultipleConnections(t *testing.T, multiplexer *ConnectionMultiplexer, endpoints []*discovery.Endpoint) []*PooledConnection {
^
services/gateway/pkg/protocol/multiplexer_test.go:860:1: The line is 148 characters long, which exceeds the maximum of 120 characters. (lll)
func returnAndReuseConnections(t *testing.T, multiplexer *ConnectionMultiplexer, endpoints []*discovery.Endpoint, connections []*PooledConnection) {
^
services/gateway/pkg/wire/protocol_test.go:402:1: The line is 154 characters long, which exceeds the maximum of 120 characters. (lll)
		Payload:     []byte(`{"jsonrpc":"2.0","method":"tools/call","params":{"name":"test.tool","arguments":{}},"id":"550e8400-e29b-41d4-a716-446655440000"}`),
^
services/gateway/pkg/wire/protocol_test.go:420:1: The line is 154 characters long, which exceeds the maximum of 120 characters. (lll)
		Payload:     []byte(`{"jsonrpc":"2.0","method":"tools/call","params":{"name":"test.tool","arguments":{}},"id":"550e8400-e29b-41d4-a716-446655440000"}`),
^
services/gateway/pkg/wire/version_negotiation_test.go:160:1: The line is 138 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyVersionNegotiationResult(t *testing.T, version uint16, err error, expectedVer uint16, expectError bool, errorContains string) {
^
services/gateway/test/integration/protocols_integration_test.go:290:1: The line is 135 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) verifyPerformanceResults(backend *stdio.Backend, duration time.Duration, numRequests int) {
^
services/gateway/test/integration/protocols_integration_test.go:311:1: The line is 126 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) setupConcurrentBackends(logger *zap.Logger) (*stdio.Backend, *wsBackend.Backend) {
^
services/gateway/test/integration/protocols_integration_test.go:384:1: The line is 162 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) runConcurrentRequests(stdioBackend *stdio.Backend, wsBackendInstance *wsBackend.Backend, numRequests int) (int, int) {
^
services/gateway/test/integration/protocols_integration_test.go:394:1: The line is 131 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) launchStdioRequests(stdioBackend *stdio.Backend, numRequests int, results chan error) {
^
services/gateway/test/integration/protocols_integration_test.go:409:1: The line is 144 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) launchWebSocketRequests(wsBackendInstance *wsBackend.Backend, numRequests int, results chan error) {
^
services/gateway/test/integration/protocols_integration_test.go:424:1: The line is 124 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) collectResults(stdioResults, wsResults chan error, numRequests int) (int, int) {
^
services/gateway/test/integration/protocols_integration_test.go:437:1: The line is 176 characters long, which exceeds the maximum of 120 characters. (lll)
func (suite *ProtocolsIntegrationTestSuite) verifyConcurrentResults(stdioBackend *stdio.Backend, wsBackendInstance *wsBackend.Backend, stdioErrors, wsErrors, numRequests int) {
^
services/gateway/test/testutil/tls_test.go:366:1: The line is 122 characters long, which exceeds the maximum of 120 characters. (lll)
func performUntrustedTLSHandshake(t *testing.T, serverConn, clientConn net.Conn, serverConfig, clientConfig *tls.Config) {
^
services/gateway/internal/discovery/consul_test.go:77:2: return with no blank line before (nlreturn)
	return health
	^
services/gateway/internal/discovery/consul_test.go:496:2: return with no blank line before (nlreturn)
	return client
	^
services/gateway/internal/discovery/consul_test.go:527:2: return with no blank line before (nlreturn)
	return serviceInfo
	^
services/gateway/internal/discovery/consul_test.go:648:3: return with no blank line before (nlreturn)
		return nil, "", fmt.Errorf("Consul failed to become ready: %w", err)
		^
services/gateway/internal/discovery/consul_test.go:672:2: return with no blank line before (nlreturn)
	return cmd.Run() == nil
	^
services/gateway/internal/discovery/consul_test.go:699:2: return with no blank line before (nlreturn)
	return addr.Port, nil
	^
services/gateway/internal/discovery/consul_test.go:714:4: continue with no blank line before (nlreturn)
			continue
			^
services/gateway/internal/discovery/kubernetes_test.go:88:4: break with no blank line before (nlreturn)
			break
			^
services/gateway/internal/discovery/kubernetes_test.go:879:2: return with no blank line before (nlreturn)
	return testService, testEndpoint
	^
services/gateway/internal/discovery/kubernetes_test.go:888:2: return with no blank line before (nlreturn)
	return fakeClient
	^
services/gateway/internal/discovery/kubernetes_test.go:1211:3: return with no blank line before (nlreturn)
		return nil, "", fmt.Errorf("failed to export kubeconfig: %w, output: %s", err, string(exportOutput))
		^
services/gateway/internal/discovery/kubernetes_test.go:1221:3: return with no blank line before (nlreturn)
		return nil, "", fmt.Errorf("Kubernetes cluster failed to become ready: %w", err)
		^
services/gateway/internal/discovery/kubernetes_test.go:1249:2: return with no blank line before (nlreturn)
	return cmd.Run() == nil
	^
services/gateway/internal/discovery/kubernetes_test.go:1261:4: continue with no blank line before (nlreturn)
			continue
			^
services/gateway/internal/discovery/kubernetes_test.go:1268:4: continue with no blank line before (nlreturn)
			continue
			^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:290:2: return with no blank line before (nlreturn)
	return filepath.Join(tempDir, "test.sock")
	^
services/gateway/internal/health/health_advanced_test.go:395:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/internal/server/server_test.go:300:4: return with no blank line before (nlreturn)
			return true
			^
services/gateway/internal/server/tls_test.go:247:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/internal/session/manager_test.go:183:6: return with no blank line before (nlreturn)
					return
					^
services/gateway/internal/session/manager_test.go:195:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/internal/session/manager_test.go:200:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/internal/session/manager_test.go:724:2: return with no blank line before (nlreturn)
	return redisManager, session
	^
services/gateway/internal/tracing/otel_test.go:95:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/internal/tracing/otel_test.go:131:2: return with no blank line before (nlreturn)
	return tracer
	^
services/gateway/internal/tracing/tracing_test.go:170:2: return with no blank line before (nlreturn)
	return tracer
	^
services/gateway/internal/tracing/tracing_test.go:291:4: break with no blank line before (nlreturn)
			break
			^
services/gateway/internal/tracing/tracing_test.go:307:4: return with no blank line before (nlreturn)
			return false
			^
services/gateway/internal/tracing/tracing_test.go:451:4: break with no blank line before (nlreturn)
			break
			^
services/gateway/internal/tracing/tracing_test.go:466:4: return with no blank line before (nlreturn)
			return false
			^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:332:2: return with no blank line before (nlreturn)
	return NewHybridLoadBalancer(initialEndpoints, config)
	^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:557:2: return with no blank line before (nlreturn)
	return endpoints
	^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:582:2: return with no blank line before (nlreturn)
	return successCount
	^
services/gateway/pkg/loadbalancer/loadbalancer_test.go:351:2: return with no blank line before (nlreturn)
	return endpoints
	^
services/gateway/pkg/loadbalancer/loadbalancer_test.go:423:5: return with no blank line before (nlreturn)
				return true
				^
services/gateway/pkg/protocol/multiplexer_test.go:851:2: return with no blank line before (nlreturn)
	return connections
	^
services/gateway/pkg/wire/auth_message_test.go:615:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/pkg/wire/integration_test.go:51:4: return with no blank line before (nlreturn)
			return
			^
services/gateway/pkg/wire/protocol_test.go:79:5: return with no blank line before (nlreturn)
				return
				^
services/gateway/pkg/wire/protocol_test.go:219:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/gateway/pkg/wire/protocol_test.go:228:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/gateway/pkg/wire/protocol_test.go:237:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/gateway/pkg/wire/protocol_test.go:255:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/gateway/test/integration/protocols_integration_test.go:76:2: return with no blank line before (nlreturn)
	return backend
	^
services/gateway/test/integration/protocols_integration_test.go:230:2: return with no blank line before (nlreturn)
	return backend
	^
services/gateway/test/integration/protocols_integration_test.go:287:2: return with no blank line before (nlreturn)
	return time.Since(start)
	^
services/gateway/test/integration/protocols_integration_test.go:314:2: return with no blank line before (nlreturn)
	return stdioBackend, wsBackendInstance
	^
services/gateway/test/integration/protocols_integration_test.go:326:2: return with no blank line before (nlreturn)
	return stdioBackend
	^
services/gateway/test/integration/protocols_integration_test.go:347:2: return with no blank line before (nlreturn)
	return wsBackendInstance
	^
services/gateway/test/integration/protocols_integration_test.go:434:2: return with no blank line before (nlreturn)
	return stdioErrors, wsErrors
	^
services/gateway/test/testutil/tls_test.go:107:4: break with no blank line before (nlreturn)
			break
			^
services/gateway/cmd/mcp-gateway/admin_test.go:163:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/cmd/mcp-gateway/main_test.go:201:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/cmd/mcp-gateway/main_test.go:221:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err) // zap handles empty string gracefully
		^
services/gateway/cmd/mcp-gateway/main_test.go:229:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err) // zap handles case conversion
		^
services/gateway/cmd/mcp-gateway/main_test.go:352:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/cmd/mcp-gateway/main_test.go:363:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:100:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:106:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:278:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:283:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:533:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:539:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:545:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:608:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:684:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:691:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/auth/oauth2_test.go:734:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:756:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/auth/oauth2_test.go:918:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/sse/backend_test.go:97:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/sse/backend_test.go:102:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, stopErr)
	^
services/gateway/internal/backends/sse/backend_test.go:142:4: require-error: for error assertions use require (testifylint)
			assert.Error(t, err)
			^
services/gateway/internal/backends/sse/backend_test.go:265:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/sse/backend_test.go:286:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/sse/backend_test.go:312:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/sse/backend_test.go:325:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/backends/stdio/backend_test.go:88:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/stdio/backend_test.go:93:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, stopErr)
	^
services/gateway/internal/backends/stdio/backend_test.go:134:4: require-error: for error assertions use require (testifylint)
			assert.Error(t, err)
			^
services/gateway/internal/backends/stdio/backend_test.go:211:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/stdio/backend_test.go:230:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/stdio/backend_test.go:255:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/stdio/backend_test.go:268:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:107:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:112:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, stopErr)
	^
services/gateway/internal/backends/websocket/backend_test.go:136:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err) // Connection failures are logged but don't fail startup
	^
services/gateway/internal/backends/websocket/backend_test.go:242:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:261:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:292:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:305:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/backends/websocket/backend_test.go:444:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/discovery/consul_start_test.go:47:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err, "Start should fail when Consul is unavailable")
		^
services/gateway/internal/discovery/consul_start_test.go:207:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err, "updateHealthStatus should not error with empty endpoints")
		^
services/gateway/internal/discovery/consul_start_test.go:223:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/discovery/factory_test.go:32:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/factory_test.go:61:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/factory_test.go:91:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/factory_test.go:112:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/factory_test.go:125:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/factory_test.go:155:4: require-error: for error assertions use require (testifylint)
			assert.NoError(t, err)
			^
services/gateway/internal/discovery/factory_test.go:192:4: require-error: for error assertions use require (testifylint)
			assert.NoError(t, err)
			^
services/gateway/internal/discovery/factory_test.go:223:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/factory_test.go:244:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:42:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:63:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:84:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:119:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:144:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:169:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:211:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:239:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/simple_coverage_test.go:267:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/sse_discovery_test.go:30:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/discovery/sse_discovery_test.go:33:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/discovery/sse_discovery_test.go:147:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/static_test.go:24:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/discovery/static_test.go:30:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/discovery/static_test.go:309:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/static_test.go:316:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/static_test.go:341:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stdio_discovery_test.go:25:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/discovery/stdio_discovery_test.go:28:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/discovery/stdio_discovery_test.go:138:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:30:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:58:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:86:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:114:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:124:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:131:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:151:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:161:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:168:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:188:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:198:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:205:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:219:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:232:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:254:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:292:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:330:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:371:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:387:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:413:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:429:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:454:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/discovery/stop_methods_test.go:470:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/discovery/websocket_discovery_test.go:25:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/discovery/websocket_discovery_test.go:28:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/discovery/websocket_discovery_test.go:138:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/factory_test.go:100:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/frontends/factory_test.go:126:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/frontends/factory_test.go:131:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/frontends/factory_test.go:377:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/factory_test.go:397:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/frontends/factory_test.go:400:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/frontends/factory_test.go:556:4: require-error: for error assertions use require (testifylint)
			assert.NoError(t, err)
			^
services/gateway/internal/frontends/factory_test.go:614:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/factory_test.go:646:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/frontends/factory_test.go:649:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/internal/frontends/stdio/frontend_test.go:348:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/stdio/frontend_test.go:354:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/stdio/frontend_test.go:424:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err) // Should not error for disabled frontend
	^
services/gateway/internal/frontends/stdio/frontend_test.go:521:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/frontends/stdio/frontend_test.go:589:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/frontends/stdio/frontend_test.go:643:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:43:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/ratelimit/redis_circuit_test.go:101:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err) // Fallback should work
		^
services/gateway/internal/ratelimit/redis_circuit_test.go:117:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err) // Should succeed via fallback when circuit is open
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:145:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/internal/ratelimit/redis_circuit_test.go:151:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:177:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:186:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/ratelimit/redis_circuit_test.go:194:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:232:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:236:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/server/coverage_improvement_test.go:35:3: go-require: do not use require in http handlers (testifylint)
		require.NoError(t, err)
		^
services/gateway/internal/server/http_handlers_test.go:37:3: go-require: do not use require in http handlers (testifylint)
		require.NoError(t, err)
		^
services/gateway/internal/server/http_handlers_test.go:449:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/server/per_ip_limit_test.go:229:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err, "Expected connection to be closed due to per-IP limit")
		^
services/gateway/internal/server/tcp_graceful_shutdown_test.go:231:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:241:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), tcpConnTotal, "TCP connections total")
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:321:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), authFailures, "Auth failures")
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:325:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), inboundRequests, "Inbound requests (init)")
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:328:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), versionNegs, "Version negotiations")
	^
services/gateway/internal/server/tcp_health_test.go:71:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/server/tcp_health_test.go:93:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/server/tcp_health_test.go:373:2: float-compare: use require.InEpsilon (or InDelta) (testifylint)
	require.Equal(t, float64(1), inboundCount, "Expected 1 inbound health check message")
	^
services/gateway/internal/server/tcp_health_test.go:377:2: float-compare: use require.InEpsilon (or InDelta) (testifylint)
	require.Equal(t, float64(1), outboundCount, "Expected 1 outbound health check response")
	^
services/gateway/internal/server/tcp_health_test.go:381:2: float-compare: use require.InEpsilon (or InDelta) (testifylint)
	require.Equal(t, float64(0), errorCount, "Expected no health receive errors")
	^
services/gateway/internal/server/tcp_health_test.go:384:2: float-compare: use require.InEpsilon (or InDelta) (testifylint)
	require.Equal(t, float64(0), errorCount, "Expected no health send errors")
	^
services/gateway/internal/server/tcp_health_test.go:387:2: float-compare: use require.InEpsilon (or InDelta) (testifylint)
	require.Equal(t, float64(0), errorCount, "Expected no health flush errors")
	^
services/gateway/internal/session/memory_manager_test.go:76:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/session/memory_manager_test.go:118:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/session/memory_manager_test.go:183:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/session/memory_manager_test.go:187:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/internal/session/memory_manager_test.go:211:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/tracing/tracing_test.go:68:5: require-error: for error assertions use require (testifylint)
				assert.NoError(t, err)
				^
services/gateway/internal/tracing/tracing_test.go:133:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/internal/tracing/tracing_test.go:140:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/pkg/health/predictive_test.go:74:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, healthData.HealthScore)
	^
services/gateway/pkg/health/predictive_test.go:194:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, monitor.GetHealthScore(endpoint))
	^
services/gateway/pkg/health/predictive_test.go:199:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, score) // Perfect score for low latency and no errors
	^
services/gateway/pkg/health/predictive_test.go:231:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, confidence)
	^
services/gateway/pkg/health/predictive_test.go:239:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, confidence)
	^
services/gateway/pkg/health/predictive_test.go:245:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 0.0, confidence) // Default confidence
	^
services/gateway/pkg/health/predictive_test.go:330:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 1.0, stats.AverageHealthScore)
	^
services/gateway/pkg/health/predictive_test.go:428:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 0.05, monitor.config.ErrorRateThreshold)
	^
services/gateway/pkg/health/predictive_test.go:429:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, 2.0, monitor.config.AnomalyDeviationFactor)
	^
services/gateway/pkg/protocol/multiplexer_test.go:242:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/protocol/multiplexer_test.go:276:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/wire/auth_message_test.go:178:5: require-error: for error assertions use require (testifylint)
				assert.Error(t, err)
				^
services/gateway/pkg/wire/auth_message_test.go:260:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/auth_message_test.go:381:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/integration_test.go:45:3: go-require: require must only be used in the goroutine running the test function (testifylint)
		require.NoError(t, err)
		^
services/gateway/pkg/wire/integration_test.go:69:3: go-require: require must only be used in the goroutine running the test function (testifylint)
		require.NoError(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:68:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:106:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:138:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:209:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:212:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:230:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/pkg/wire/transport_additional_test.go:243:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/pkg/wire/transport_additional_test.go:259:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/pkg/wire/transport_additional_test.go:299:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/wire/transport_additional_test.go:324:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/wire/transport_additional_test.go:407:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:422:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/transport_additional_test.go:435:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/transport_test.go:65:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:103:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:133:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:158:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:180:3: go-require: require must only be used in the goroutine running the test function (testifylint)
		require.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:198:3: go-require: require must only be used in the goroutine running the test function (testifylint)
		require.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:277:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/transport_test.go:293:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/wire/transport_test.go:327:2: require-error: for error assertions use require (testifylint)
	assert.Error(t, err)
	^
services/gateway/pkg/wire/version_negotiation_test.go:163:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/pkg/wire/version_negotiation_test.go:169:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/version_negotiation_test.go:347:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/version_negotiation_test.go:353:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/version_negotiation_test.go:359:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/pkg/wire/version_negotiation_test.go:365:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/test/integration/protocols_integration_test.go:184:2: require-error: for error assertions use require (testifylint)
	suite.NoError(err)
	^
services/gateway/test/testutil/metrics_test.go:280:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), count)
	^
services/gateway/test/testutil/metrics_test.go:294:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), count)
	^
services/gateway/test/testutil/metrics_test.go:311:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(5), count)
	^
services/gateway/test/testutil/metrics_test.go:326:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), count)
	^
services/gateway/test/testutil/metrics_test.go:329:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), count)
	^
services/gateway/test/testutil/metrics_test.go:375:3: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
		assert.Equal(t, float64(tc.increments), count, "Failed for %s/%s", tc.direction, tc.msgType)
		^
services/gateway/test/testutil/metrics_test.go:407:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), count)
	^
services/gateway/test/testutil/metrics_test.go:421:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(1), count)
	^
services/gateway/test/testutil/metrics_test.go:438:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(3), count)
	^
services/gateway/test/testutil/metrics_test.go:453:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), count)
	^
services/gateway/test/testutil/metrics_test.go:494:3: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
		assert.Equal(t, float64(expectedCount), count, "Failed for error type %s", errorType)
		^
services/gateway/test/testutil/metrics_test.go:533:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(10), registry.GetTCPMessageCount("inbound", "request"))
	^
services/gateway/test/testutil/metrics_test.go:534:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(3), registry.GetTCPProtocolErrorCount("frame_error"))
	^
services/gateway/test/testutil/metrics_test.go:550:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(5), registry.GetTCPMessageCount("outbound", "response"))
	^
services/gateway/test/testutil/metrics_test.go:554:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, float64(0), newRegistry.GetTCPMessageCount("outbound", "response"))
	^
services/gateway/test/testutil/metrics_test.go:824:2: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
	assert.Equal(t, expectedValue, metric.Gauge.GetValue())
	^
services/gateway/test/testutil/metrics_test.go:850:3: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
		assert.Equal(t, float64(0), count) // Should return 0 for non-existent metrics
		^
services/gateway/test/testutil/metrics_test.go:858:3: float-compare: use assert.InEpsilon (or InDelta) (testifylint)
		assert.Equal(t, float64(0), count) // Should return 0 for non-existent metrics
		^
services/gateway/test/testutil/testutil_test.go:91:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/test/testutil/testutil_test.go:106:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/test/testutil/testutil_test.go:164:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/test/testutil/tls_test.go:178:2: require-error: for error assertions use require (testifylint)
	assert.NoError(t, err)
	^
services/gateway/test/testutil/tls_test.go:317:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/test/testutil/tls_test.go:324:3: require-error: for error assertions use require (testifylint)
		assert.NoError(t, err)
		^
services/gateway/test/testutil/tls_test.go:389:3: require-error: for error assertions use require (testifylint)
		assert.Error(t, err)
		^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:462:6: test helper function should start from t.Helper() (thelper)
func runConnectionTest(t *testing.T, clientConn, serverConn net.Conn) {
     ^
services/gateway/internal/router/router_test.go:408:6: test helper function should start from t.Helper() (thelper)
func handleTestBackendRequest(t *testing.T, w http.ResponseWriter, r *http.Request) {
     ^
services/gateway/internal/server/tcp_graceful_shutdown_test.go:225:6: test helper function should start from t.Helper() (thelper)
func performGracefulShutdown(t *testing.T, server *GatewayServer, ctx context.Context) {
     ^
services/gateway/internal/server/tcp_handler_metrics_test.go:64:6: test helper function should start from t.Helper() (thelper)
func runTCPHandlerMetricsTests(t *testing.T, tests []struct {
     ^
services/gateway/internal/server/tls_test.go:229:6: test helper function should start from t.Helper() (thelper)
func runTLSConfigTests(t *testing.T, tests []tlsConfigTest) {
     ^
services/gateway/internal/server/websocket_origin_test.go:129:6: test helper function should start from t.Helper() (thelper)
func runWebSocketOriginTests(t *testing.T, tests []struct {
     ^
services/gateway/internal/server/websocket_origin_test.go:240:6: test helper function should start from t.Helper() (thelper)
func runWildcardOriginTests(t *testing.T, origins []string, wsURL string) {
     ^
services/gateway/internal/session/manager_test.go:170:6: test helper function should start from t.Helper() (thelper)
func runRedisSessionStoreTests(t *testing.T, tests []struct {
     ^
services/gateway/internal/session/manager_test.go:643:6: test helper function should start from t.Helper() (thelper)
func runSessionTTLTests(t *testing.T, tests []struct {
     ^
services/gateway/pkg/circuit/breaker_test.go:331:6: test helper function should start from t.Helper() (thelper)
func createStateChecker(t *testing.T, cb *CircuitBreaker, states *[]State) func(State) {
     ^
services/gateway/pkg/circuit/breaker_test.go:360:6: test helper function should start from t.Helper() (thelper)
func testOpenStateTransitions(t *testing.T, cb *CircuitBreaker, checkState func(State)) {
     ^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:483:14: test helper function should start from t.Helper() (thelper)
			testFunc: func(t *testing.T, lb *HybridLoadBalancer) {
			          ^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:495:14: test helper function should start from t.Helper() (thelper)
			testFunc: func(t *testing.T, lb *HybridLoadBalancer) {
			          ^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:510:14: test helper function should start from t.Helper() (thelper)
			testFunc: func(t *testing.T, lb *HybridLoadBalancer) {
			          ^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:560:6: test helper function should start from t.Helper() (thelper)
func runPerformanceTestForAlgorithm(t *testing.T, algorithm string, endpoints []*discovery.Endpoint, requests int) {
     ^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:585:6: test helper function should start from t.Helper() (thelper)
func validatePerformanceResults(t *testing.T, algorithm string, successCount, requests int, duration time.Duration) {
     ^
services/gateway/pkg/protocol/multiplexer_test.go:854:6: test helper function should start from t.Helper() (thelper)
func verifyMultiplexerStats(t *testing.T, multiplexer *ConnectionMultiplexer, expectedPools, expectedConnections int) {
     ^
services/gateway/pkg/protocol/multiplexer_test.go:881:6: test helper function should start from t.Helper() (thelper)
func shutdownAndVerifyCleanup(t *testing.T, multiplexer *ConnectionMultiplexer) {
     ^
services/gateway/internal/auth/oauth2_test.go:276:19: unnecessary leading newline (whitespace)
	if tt.wantError {
	                 ^
services/gateway/internal/discovery/kubernetes_test.go:1263:3: unnecessary trailing newline (whitespace)
		}
		^
services/gateway/internal/auth/oauth2_test.go:277:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
		
^
services/gateway/internal/auth/oauth2_test.go:279:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if tt.errorMsg != "" {
		^
services/gateway/internal/auth/oauth2_test.go:846:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server := createCompleteFlowMockServer(t, &callCount)
	^
services/gateway/internal/auth/oauth2_test.go:858:3: missing whitespace above this line (no shared variables above switch) (wsl_v5)
		switch r.URL.Path {
		^
services/gateway/internal/auth/oauth2_test.go:875:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := config.OAuth2Config{
	^
services/gateway/internal/auth/oauth2_test.go:889:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	token := "valid-token"
	^
services/gateway/internal/auth/oauth2_test.go:925:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	provider := &OAuth2Provider{}
	^
services/gateway/internal/auth/oauth2_test.go:926:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createIntrospectionEdgeCaseTests()
	^
services/gateway/internal/auth/oauth2_test.go:930:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			claims := provider.introspectionToClaims(tt.introspection)
			^
services/gateway/internal/auth/provider_test.go:124:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = os.Remove(tmpFile.Name()) }()
	^
services/gateway/internal/auth/provider_test.go:585:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = os.Unsetenv("TEST_JWT_SECRET") }()
	^
services/gateway/internal/backends/sse/backend_test.go:444:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server := createTestSSEServer(t)
	^
services/gateway/internal/backends/sse/backend_test.go:452:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = backend.Stop(ctx) }()
	^
services/gateway/internal/backends/sse/backend_test.go:461:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := Config{
	^
services/gateway/internal/backends/sse/backend_test.go:473:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRequests = 5
	^
services/gateway/internal/backends/sse/backend_test.go:474:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	responses := make(chan *mcp.Response, numRequests)
	^
services/gateway/internal/backends/sse/backend_test.go:487:4: missing whitespace above this line (too many statements above if) (wsl_v5)
			response, err := backend.SendRequest(ctx, req)
			^
services/gateway/internal/config/security_test.go:266:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:76:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:250:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:448:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if tt.errMsg != "" {
		^
services/gateway/internal/config/validation_test.go:463:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:599:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:707:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:824:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/config/validation_test.go:953:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errMsg != "" {
				^
services/gateway/internal/discovery/consul_advanced_test.go:403:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createConsulAdvancedEndpointTests()
	^
services/gateway/internal/discovery/consul_advanced_test.go:412:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			require.NoError(t, err)
			^
services/gateway/internal/discovery/consul_advanced_test.go:414:4: missing whitespace above this line (invalid statement above if) (wsl_v5)
			if tt.validateFunc != nil {
			^
services/gateway/internal/discovery/consul_advanced_test.go:587:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createHealthCheckAdvancedTests()
	^
services/gateway/internal/discovery/consul_test.go:470:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cleanup, consulAddr, err := setupConsulInfrastructure(t)
	^
services/gateway/internal/discovery/consul_test.go:492:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	consulConfig := consulapi.DefaultConfig()
	^
services/gateway/internal/discovery/consul_test.go:501:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	leader, err := client.Status().Leader()
	^
services/gateway/internal/discovery/consul_test.go:508:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	serviceInfo := testServiceInfo{
	^
services/gateway/internal/discovery/consul_test.go:532:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	services, _, err := client.Health().Service(serviceInfo.Name, "", false, nil)
	^
services/gateway/internal/discovery/consul_test.go:542:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.ServiceDiscoveryConfig{
	^
services/gateway/internal/discovery/consul_test.go:566:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err := client.Agent().ServiceDeregister(serviceID)
	^
services/gateway/internal/discovery/consul_test.go:646:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
		
^
services/gateway/internal/discovery/factory_test.go:139:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			cfg := config.ServiceDiscoveryConfig{
			^
services/gateway/internal/discovery/factory_test.go:175:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			cfg := config.ServiceDiscoveryConfig{
			^
services/gateway/internal/discovery/kubernetes_test.go:85:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, ns := range namespaces.Items {
	^
services/gateway/internal/discovery/kubernetes_test.go:108:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg.Provider = providerKubernetes
	^
services/gateway/internal/discovery/kubernetes_test.go:162:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createKubernetesNamespaceServiceTests()
	^
services/gateway/internal/discovery/kubernetes_test.go:555:2: missing whitespace above this line (invalid statement above range) (wsl_v5)
	for _, ep := range endpoints {
	^
services/gateway/internal/discovery/kubernetes_test.go:565:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if ep.Namespace == "" {
	^
services/gateway/internal/discovery/kubernetes_test.go:585:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if expectedTools > 0 && len(ep.Tools) != expectedTools {
	^
services/gateway/internal/discovery/kubernetes_test.go:593:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if testName != "Multiple services with different weights" {
	^
services/gateway/internal/discovery/kubernetes_test.go:733:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	testService := createTestServiceForWatch()
	^
services/gateway/internal/discovery/kubernetes_test.go:755:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/discovery/kubernetes_test.go:757:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		discovery.handleServiceEvents("test-namespace", eventChan)
		^
services/gateway/internal/discovery/kubernetes_test.go:777:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(100 * time.Millisecond)
	^
services/gateway/internal/discovery/kubernetes_test.go:780:2: missing whitespace above this line (too many statements above send) (wsl_v5)
	modifiedService.Annotations["mcp.bridge/weight"] = "200"
	^
services/gateway/internal/discovery/kubernetes_test.go:782:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(100 * time.Millisecond)
	^
services/gateway/internal/discovery/kubernetes_test.go:785:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(100 * time.Millisecond)
	^
services/gateway/internal/discovery/kubernetes_test.go:886:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	fakeClient.PrependWatchReactor("services", k8stesting.DefaultWatchReactor(fakeServiceWatcher, nil))
	^
services/gateway/internal/discovery/kubernetes_test.go:908:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err := discovery.Start(context.Background())
	^
services/gateway/internal/discovery/kubernetes_test.go:912:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(100 * time.Millisecond) // Give some time for initialization
	^
services/gateway/internal/discovery/kubernetes_test.go:1173:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background() // Test infrastructure context
	^
services/gateway/internal/discovery/kubernetes_test.go:1191:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	createOutput, err := createCmd.CombinedOutput()
	^
services/gateway/internal/discovery/kubernetes_test.go:1205:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	exportOutput, err := exportCmd.CombinedOutput()
	^
services/gateway/internal/discovery/kubernetes_test.go:1208:1: unnecessary whitespace (leading-whitespace) (wsl_v5)

^
services/gateway/internal/discovery/kubernetes_test.go:1217:1: unnecessary whitespace (leading-whitespace) (wsl_v5)

^
services/gateway/internal/discovery/kubernetes_test.go:1248:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cmd := exec.CommandContext(ctx, "kind", "version")
	^
services/gateway/internal/discovery/kubernetes_test.go:1262:1: unnecessary whitespace (trailing-whitespace) (wsl_v5)

^
services/gateway/internal/discovery/simple_coverage_test.go:32:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.SSEDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:43:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	sseBridge, ok := discovery.(*SSEDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:53:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.StdioDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:64:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	stdioBridge, ok := discovery.(*StdioDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:74:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.WebSocketDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:85:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	wsBridge, ok := discovery.(*WebSocketDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:109:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.SSEDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:120:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	sseBridge, ok := discovery.(*SSEDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:122:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/gateway/internal/discovery/simple_coverage_test.go:124:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/discovery/simple_coverage_test.go:126:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		_, _ = sseBridge.Watch(ctx)
		^
services/gateway/internal/discovery/simple_coverage_test.go:128:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	cancel() // Cancel immediately to exit the watch
	^
services/gateway/internal/discovery/simple_coverage_test.go:134:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.StdioDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:145:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	stdioBridge, ok := discovery.(*StdioDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:147:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/gateway/internal/discovery/simple_coverage_test.go:149:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/discovery/simple_coverage_test.go:151:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		_, _ = stdioBridge.Watch(ctx)
		^
services/gateway/internal/discovery/simple_coverage_test.go:153:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	cancel() // Cancel immediately to exit the watch
	^
services/gateway/internal/discovery/simple_coverage_test.go:159:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.WebSocketDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:170:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	wsBridge, ok := discovery.(*WebSocketDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:172:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/gateway/internal/discovery/simple_coverage_test.go:174:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/discovery/simple_coverage_test.go:176:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		_, _ = wsBridge.Watch(ctx)
		^
services/gateway/internal/discovery/simple_coverage_test.go:178:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	cancel() // Cancel immediately to exit the watch
	^
services/gateway/internal/discovery/simple_coverage_test.go:198:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.SSEDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:212:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	sseBridge, ok := discovery.(*SSEDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:214:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/gateway/internal/discovery/simple_coverage_test.go:226:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.StdioDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:240:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	stdioBridge, ok := discovery.(*StdioDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:242:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/gateway/internal/discovery/simple_coverage_test.go:254:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	cfg := config.WebSocketDiscoveryConfig{
	^
services/gateway/internal/discovery/simple_coverage_test.go:268:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	wsBridge, ok := discovery.(*WebSocketDiscovery)
	^
services/gateway/internal/discovery/simple_coverage_test.go:270:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/gateway/internal/discovery/sse_discovery_test.go:24:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createSSEDiscoveryCreationTests()
	^
services/gateway/internal/discovery/sse_discovery_test.go:28:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			sd, err := CreateSSEServiceDiscovery(tt.config, logger)
			^
services/gateway/internal/discovery/sse_discovery_test.go:478:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createSSEURLParsingTests()
	^
services/gateway/internal/discovery/sse_discovery_test.go:482:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			config := config.SSEDiscoveryConfig{
			^
services/gateway/internal/discovery/sse_discovery_test.go:492:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			endpoints := sd.GetEndpoints("default")
			^
services/gateway/internal/discovery/static_test.go:18:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createStaticDiscoveryCreationTests()
	^
services/gateway/internal/discovery/static_test.go:22:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			sd, err := CreateStaticServiceDiscovery(tt.config, logger)
			^
services/gateway/internal/discovery/static_test.go:25:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.errContains != "" {
				^
services/gateway/internal/discovery/static_test.go:28:5: missing whitespace above this line (invalid statement above expr) (wsl_v5)
				assert.Nil(t, sd)
				^
services/gateway/internal/discovery/static_test.go:147:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	assert.Equal(t, 3, totalCount) // 2 default + 1 production
	^
services/gateway/internal/discovery/static_test.go:383:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createStaticURLParsingTests()
	^
services/gateway/internal/discovery/static_test.go:387:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			config := config.ServiceDiscoveryConfig{
			^
services/gateway/internal/discovery/static_test.go:401:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			endpoints := sd.GetEndpoints("test")
			^
services/gateway/internal/discovery/stdio_discovery_test.go:19:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createStdioDiscoveryCreationTests()
	^
services/gateway/internal/discovery/stdio_discovery_test.go:23:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			sd, err := CreateStdioServiceDiscovery(tt.config, logger)
			^
services/gateway/internal/discovery/websocket_discovery_test.go:19:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createWebSocketDiscoveryCreationTests()
	^
services/gateway/internal/discovery/websocket_discovery_test.go:23:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			sd, err := CreateWebSocketServiceDiscovery(tt.config, logger)
			^
services/gateway/internal/discovery/websocket_discovery_test.go:475:2: missing whitespace above this line (too many statements above range) (wsl_v5)
	tests := createWebSocketURLParsingTests()
	^
services/gateway/internal/discovery/websocket_discovery_test.go:479:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			config := config.WebSocketDiscoveryConfig{
			^
services/gateway/internal/discovery/websocket_discovery_test.go:489:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			endpoints := sd.GetEndpoints("default")
			^
services/gateway/internal/frontends/factory_test.go:107:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	tests := createStdioFrontendTests()
	^
services/gateway/internal/frontends/factory_test.go:133:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if tt.expectError != "" {
				^
services/gateway/internal/frontends/factory_test.go:395:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			frontend, err := factory.CreateFrontend(tt.config, router, auth, sessions)
			^
services/gateway/internal/frontends/factory_test.go:636:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			config := FrontendConfig{
			^
services/gateway/internal/frontends/factory_test.go:644:4: missing whitespace above this line (too many statements above if) (wsl_v5)
			frontend, err := factory.CreateFrontend(config, router, auth, sessions)
			^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:282:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = frontend.Stop(context.Background()) }()
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:295:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if err := os.Remove(socketPath); err != nil && !os.IsNotExist(err) {
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:320:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = conn.Close() }()
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:593:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:628:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:649:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:684:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go func() {
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:695:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err = json.Unmarshal(writer2.Bytes(), &errorResp)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:738:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go frontend.handleRequest(context.Background(), conn, request)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:739:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(responseProcessingTimeout)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:768:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go errorFrontend.handleRequest(context.Background(), conn, request)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:769:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(responseProcessingTimeout)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:774:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err := json.Unmarshal(writer.Bytes(), &errorResp)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:907:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go frontend.handleConnection(context.Background(), testConn)
	^
services/gateway/internal/frontends/stdio/frontend_comprehensive_test.go:1071:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if err := os.Remove(socketPath); err != nil && !os.IsNotExist(err) {
	^
services/gateway/internal/health/checker_test.go:422:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	mockDiscovery := NewMockDiscovery()
	^
services/gateway/internal/health/health_advanced_test.go:425:2: missing whitespace above this line (invalid statement above for) (wsl_v5)
	for i := 0; i < expectedOps; i++ {
	^
services/gateway/internal/logging/structured_test.go:95:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, field := range fields {
	^
services/gateway/internal/ratelimit/redis_circuit_test.go:59:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = db.Close() }()
	^
services/gateway/internal/router/router_test.go:321:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if expectNil {
	^
services/gateway/internal/router/router_test.go:329:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		lb2 := router.getLoadBalancer(namespace)
		^
services/gateway/internal/router/router_test.go:472:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	tests := []struct {
	^
services/gateway/internal/router/router_test.go:501:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, tt := range tests {
	^
services/gateway/internal/router/router_test.go:516:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	backend := setupSessionTestBackend(&sessionReceived)
	^
services/gateway/internal/router/router_test.go:579:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const sessionKey contextKey = "session"
	^
services/gateway/internal/router/router_test.go:580:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.WithValue(context.Background(), sessionKey, sess)
	^
services/gateway/internal/router/router_test.go:856:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	errors := make(chan error, testIterations)
	^
services/gateway/internal/router/router_test.go:860:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func(id int) {
		^
services/gateway/internal/router/router_test.go:862:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			req := &mcp.Request{
			^
services/gateway/internal/router/router_test.go:869:4: missing whitespace above this line (too many statements above if) (wsl_v5)
			_, err := router.RouteRequest(ctx, req, "test")
			^
services/gateway/internal/router/router_test.go:880:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for err := range errors {
	^
services/gateway/internal/router/router_test.go:882:3: missing whitespace above this line (invalid statement above inc-dec) (wsl_v5)
		errorCount++
		^
services/gateway/internal/server/per_ip_limit_test.go:110:4: missing whitespace above this line (invalid statement above for) (wsl_v5)
			for j := 0; j < incrementsPerGoroutine; j++ {
			^
services/gateway/internal/server/per_ip_limit_test.go:122:2: missing whitespace above this line (invalid statement above for) (wsl_v5)
	for i := 0; i < numGoroutines; i++ {
	^
services/gateway/internal/server/per_ip_limit_test.go:125:4: missing whitespace above this line (invalid statement above for) (wsl_v5)
			for j := 0; j < incrementsPerGoroutine; j++ {
			^
services/gateway/internal/server/per_ip_limit_test.go:140:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	conns := testPerIPConnectionLimits(t, serverAddr)
	^
services/gateway/internal/server/per_ip_limit_test.go:198:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go s.acceptTCPConnections()
	^
services/gateway/internal/server/per_ip_limit_test.go:207:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	dialer := &net.Dialer{}
	^
services/gateway/internal/server/per_ip_limit_test.go:213:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		conns = append(conns, conn)
		^
services/gateway/internal/server/per_ip_limit_test.go:214:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		time.Sleep(testTimeout * time.Millisecond) // Give server time to process
		^
services/gateway/internal/server/per_ip_limit_test.go:262:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	conn5, err := dialer.DialContext(context.Background(), "tcp", serverAddr)
	^
services/gateway/internal/server/server_test.go:272:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if resp != nil && resp.Body != nil {
	^
services/gateway/internal/server/server_test.go:296:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		server.connections.Range(func(key, value interface{}) bool {
		^
services/gateway/internal/server/tcp_graceful_shutdown_test.go:217:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		<-ctx.Done()
		^
services/gateway/internal/server/tcp_graceful_shutdown_test.go:221:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		<-ctx.Done()
		^
services/gateway/internal/server/tcp_handler_metrics_test.go:122:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	authProvider := new(MockAuthProvider)
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:168:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	transport := wire.NewTransport(conn)
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:183:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if ack, ok := msg.(*wire.VersionAckPayload); ok {
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:253:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	authProvider := new(MockAuthProvider)
	^
services/gateway/internal/server/tcp_handler_metrics_test.go:277:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	transport := wire.NewTransport(conn)
	^
services/gateway/internal/server/tcp_handler_test.go:402:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = clientConn.Close()
	^
services/gateway/internal/server/tcp_handler_test.go:448:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = clientConn.Close()
	^
services/gateway/internal/server/tcp_health_test.go:102:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = server.Stop() }()
	^
services/gateway/internal/session/manager_test.go:381:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Close() }()
	^
services/gateway/internal/session/manager_test.go:588:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = rm.Close() }()
	^
services/gateway/internal/tracing/otel_test.go:112:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = tracer.Shutdown(context.Background()) }()
	^
services/gateway/internal/tracing/tracing_test.go:401:5: missing whitespace above this line (too many statements above defer) (wsl_v5)
				ctx = opentracing.ContextWithSpan(ctx, span)
				^
services/gateway/pkg/circuit/breaker_test.go:349:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	checkState(StateClosed)
	^
services/gateway/pkg/circuit/breaker_test.go:353:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	checkState(StateClosed)
	^
services/gateway/pkg/circuit/breaker_test.go:357:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	checkState(StateOpen)
	^
services/gateway/pkg/circuit/breaker_test.go:366:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	checkState(StateOpen)
	^
services/gateway/pkg/circuit/breaker_test.go:370:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	timer := time.NewTimer(waitTime)
	^
services/gateway/pkg/circuit/breaker_test.go:372:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	<-timer.C
	^
services/gateway/pkg/circuit/breaker_test.go:378:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	checkState(StateHalfOpen)
	^
services/gateway/pkg/circuit/breaker_test.go:382:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	checkState(StateClosed)
	^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:246:2: missing whitespace above this line (invalid statement above range) (wsl_v5)
	for _, ep := range endpointsNoHTTP {
	^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:546:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	endpoints := make([]*discovery.Endpoint, numEndpoints)
	^
services/gateway/pkg/loadbalancer/lb_advanced_test.go:576:2: missing whitespace above this line (no shared variables above for) (wsl_v5)
	for i := 0; i < requests; i++ {
	^
services/gateway/pkg/protocol/multiplexer.go:426:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var unhealthyConns []*PooledConnection
	^
services/gateway/pkg/protocol/multiplexer.go:431:4: missing whitespace above this line (no shared variables above append) (wsl_v5)
			unhealthyConns = append(unhealthyConns, conn)
			^
services/gateway/pkg/protocol/multiplexer.go:525:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if now.Sub(conn.LastUsedAt) < time.Minute {
		^
services/gateway/pkg/protocol/multiplexer.go:528:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		conn.mu.RUnlock()
		^
services/gateway/pkg/protocol/multiplexer_test.go:848:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			connections = append(connections, conn)
			^
services/gateway/pkg/wire/protocol_test.go:213:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = binary.Write(&buf, binary.BigEndian, MagicBytes)
	^
services/gateway/pkg/wire/protocol_test.go:224:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = binary.Write(&buf, binary.BigEndian, uint32(0xDEADBEEF))
	^
services/gateway/pkg/wire/protocol_test.go:233:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = binary.Write(&buf, binary.BigEndian, MagicBytes)
	^
services/gateway/pkg/wire/protocol_test.go:242:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = binary.Write(&buf, binary.BigEndian, MagicBytes)
	^
services/gateway/pkg/wire/protocol_test.go:250:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = binary.Write(&buf, binary.BigEndian, MagicBytes)
	^
services/gateway/pkg/wire/transport_additional_test.go:208:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if wantErr {
	^
services/gateway/pkg/wire/transport_additional_test.go:218:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			err = json.Unmarshal(data, &decoded)
			^
services/gateway/pkg/wire/transport_additional_test.go:281:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = client.Close() }()
	^
services/gateway/pkg/wire/transport_additional_test.go:307:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = client.Close() }()
	^
services/gateway/pkg/wire/version_negotiation_test.go:162:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if expectError {
	^
services/gateway/pkg/wire/version_negotiation_test.go:164:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if errorContains != "" {
		^
services/gateway/pkg/wire/version_negotiation_test.go:167:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		assert.Equal(t, uint16(0), version)
		^
services/gateway/test/integration/protocols_integration_test.go:56:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = backend.Stop(suite.ctx) }()
	^
services/gateway/test/integration/protocols_integration_test.go:177:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = backend.Stop(suite.ctx) }()
	^
services/gateway/test/integration/protocols_integration_test.go:211:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = backend.Stop(suite.ctx) }()
	^
services/gateway/test/integration/protocols_integration_test.go:214:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	duration := suite.runPerformanceTest(backend, numRequests)
	^
services/gateway/test/integration/protocols_integration_test.go:280:2: missing whitespace above this line (no shared variables above for) (wsl_v5)
	for i := 0; i < numRequests; i++ {
	^
services/gateway/test/integration/protocols_integration_test.go:303:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = stdioBackend.Stop(suite.ctx) }()
	^
services/gateway/test/integration/protocols_integration_test.go:307:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	stdioErrors, wsErrors := suite.runConcurrentRequests(stdioBackend, wsBackendInstance, numRequests)
	^
services/gateway/test/integration/protocols_integration_test.go:403:4: missing whitespace above this line (too many statements above send) (wsl_v5)
			_, err := stdioBackend.SendRequest(suite.ctx, req)
			^
services/gateway/test/integration/protocols_integration_test.go:418:4: missing whitespace above this line (too many statements above send) (wsl_v5)
			_, err := wsBackendInstance.SendRequest(suite.ctx, req)
			^
services/gateway/test/integration/protocols_integration_test.go:426:2: missing whitespace above this line (no shared variables above for) (wsl_v5)
	for i := 0; i < numRequests; i++ {
	^
services/gateway/test/integration/protocols_integration_test.go:430:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if err := <-wsResults; err != nil {
		^
services/gateway/test/testutil/metrics_test.go:515:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	registry := CreateTestMetricsRegistryWithHelpers()
	^
services/gateway/test/testutil/metrics_test.go:542:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	registry := CreateTestMetricsRegistryWithHelpers()
	^
services/gateway/test/testutil/metrics_test.go:559:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	registry := CreateTestMetricsRegistryWithHelpers()
	^
services/gateway/test/testutil/testutil_test.go:153:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	secret := []byte("test-secret-key")
	^
services/gateway/test/testutil/tls_test.go:104:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, ip := range serverCert.IPAddresses {
	^
services/gateway/test/testutil/tls_test.go:110:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	assert.True(t, hasLocalhostIP, "Server certificate should contain localhost IP")
	^
services/gateway/test/testutil/tls_test.go:247:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = serverConn.Close() }()
	^
services/gateway/test/testutil/tls_test.go:294:2: missing whitespace above this line (too many statements above send) (wsl_v5)
	err := tlsServerConn.HandshakeContext(context.Background())
	^
services/gateway/test/testutil/tls_test.go:304:2: missing whitespace above this line (too many statements above send) (wsl_v5)
	err := tlsClientConn.HandshakeContext(context.Background())
	^
services/gateway/test/testutil/tls_test.go:344:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = serverConn.Close() }()
	^
668 issues:
* contextcheck: 5
* exhaustive: 1
* forcetypeassert: 1
* gosec: 32
* ireturn: 31
* lll: 80
* nlreturn: 51
* testifylint: 219
* thelper: 18
* whitespace: 2
* wsl_v5: 228

=== LINTING MODULE: ./services/router ===
services/router/internal/direct/websocket_client.go:172:39: response body must be closed (bodyclose)
	conn, _, err := c.establishConnection(ctx, dialer, headers)
	                                     ^
services/router/cmd/mcp-router/metrics_test.go:123:20: Function `New->initializeComponents->NewGatewayClientWithPool->NewPoolClient->NewGatewayPool` should pass the context parameter (contextcheck)
	r, _ := router.New(cfg, logger)
	                  ^
services/router/internal/direct/manager.go:637:32: Function `createClient->createHTTPClient->NewHTTPClientWithMemoryOptimizer->CreateOptimizedHTTPClient->Build->createClient` should pass the context parameter (contextcheck)
		client, err := m.createClient(serverURL, protocol) 
		                             ^
services/router/internal/direct/protocol_negotiation_advanced_test.go:836:49: Function `NewDirectClientManager->BuildClientOrchestrator->createInfrastructureComponents->NewConnectionPool->startBackgroundTasks->startBackgroundTasks$2->performHealthChecks` should pass the context parameter (contextcheck)
	emptyManagerInterface := NewDirectClientManager(emptyConfig, logger)
	                                               ^
services/router/internal/direct/stdio_client.go:311:6: Function `restartProcess` should pass the context parameter (contextcheck)
					go c.restartProcess() 
					^
services/router/internal/direct/websocket_client.go:149:2: Function `readMessages->ReadMessageLoop->readSingleMessage->handleReadError->handleClosedConnection->attemptReconnection->reconnect` should pass the context parameter (contextcheck)
	go c.readMessages() 
	^
services/router/internal/direct/websocket_client.go:396:6: Function `reconnect` should pass the context parameter (contextcheck)
					go c.reconnect() 
					^
services/router/internal/gateway/tcp_client_advanced_test.go:669:26: Function `SendRequest` should pass the context parameter (contextcheck)
	err = client.SendRequest(req)
	                        ^
services/router/internal/metrics/prometheus.go:238:30: Non-inherited new context, use function like `context.WithXXX` instead (contextcheck)
		if err := e.server.Shutdown(shutdownCtx); err != nil {
		                           ^
services/router/internal/patterns/handler_pattern.go:352:25: Function `isConnectionValid` should pass the context parameter (contextcheck)
		if m.isConnectionValid(conn) { 
		                      ^
services/router/internal/router/router.go:286:17: Function `Start->maintainConnection->connect` should pass the context parameter (contextcheck)
	r.connMgr.Start() 
	               ^
services/router/internal/router/router.go:287:19: Function `Start->handleStdinToWS->processStdinMessage->processStdinMessageDirect->processRequestWithFallback->attemptDirectWithRetries` should pass the context parameter (contextcheck)
	r.msgRouter.Start() 
	                 ^
services/router/internal/direct/stdio_client_test.go:703:6: Function 'createStdioLifecycleScript' is too long (75 > 60) (funlen)
func createStdioLifecycleScript(t *testing.T) string {
     ^
services/router/internal/gateway/client_test.go:540:6: Function 'TestClient_SendRequest' is too long (80 > 60) (funlen)
func TestClient_SendRequest(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:707:6: Function 'TestClient_ReceiveResponse' is too long (74 > 60) (funlen)
func TestClient_ReceiveResponse(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:791:6: Function 'TestClient_ReceiveResponse_InvalidPayload' is too long (62 > 60) (funlen)
func TestClient_ReceiveResponse_InvalidPayload(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:862:6: Function 'TestClient_SendPing' is too long (68 > 60) (funlen)
func TestClient_SendPing(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:940:6: Function 'TestClient_Close' is too long (70 > 60) (funlen)
func TestClient_Close(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1072:6: Function 'TestClient_ConcurrentOperations' is too long (81 > 60) (funlen)
func TestClient_ConcurrentOperations(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1205:6: Function 'BenchmarkClient_SendRequest' is too long (66 > 60) (funlen)
func BenchmarkClient_SendRequest(b *testing.B) {
     ^
services/router/internal/gateway/client_test.go:1281:6: Function 'TestClient_Connect_ErrorScenarios' is too long (91 > 60) (funlen)
func TestClient_Connect_ErrorScenarios(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1381:6: Function 'TestClient_NetworkFailures' is too long (66 > 60) (funlen)
func TestClient_NetworkFailures(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1460:6: Function 'TestClient_AuthenticationEdgeCases' is too long (114 > 60) (funlen)
func TestClient_AuthenticationEdgeCases(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1743:6: Function 'TestClient_ConnectionLifecycle' is too long (63 > 60) (funlen)
func TestClient_ConnectionLifecycle(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1818:6: Function 'TestClient_MalformedMessages' is too long (61 > 60) (funlen)
func TestClient_MalformedMessages(t *testing.T) { 
     ^
services/router/internal/gateway/factory_test.go:16:6: Function 'TestNewGatewayClient' is too long (125 > 60) (funlen)
func TestNewGatewayClient(t *testing.T) { 
     ^
services/router/internal/gateway/factory_test.go:226:6: Function 'setupMTLSCerts' is too long (62 > 60) (funlen)
func setupMTLSCerts(t *testing.T) (certFile, keyFile string, cleanup func()) {
     ^
services/router/internal/gateway/factory_test.go:291:6: Function 'TestGatewayClient_AuthConfiguration' is too long (72 > 60) (funlen)
func TestGatewayClient_AuthConfiguration(t *testing.T) { 
     ^
services/router/internal/gateway/factory_test.go:369:6: Function 'TestGatewayClient_TLSConfiguration' is too long (71 > 60) (funlen)
func TestGatewayClient_TLSConfiguration(t *testing.T) { 
     ^
services/router/internal/gateway/gateway_integration_advanced_test.go:109:6: Function 'runLoadBalancingClients' is too long (62 > 60) (funlen)
func runLoadBalancingClients(t *testing.T, addresses []string, numClients, requestsPerClient int, logger *zap.Logger) {
     ^
services/router/internal/gateway/namespace_router_test.go:451:6: Function 'TestNamespaceRouter_MultipleMatches' is too long (67 > 60) (funlen)
func TestNamespaceRouter_MultipleMatches(t *testing.T) { 
     ^
services/router/internal/gateway/oauth2_test.go:366:6: Function 'TestOAuth2Client_ErrorHandling' is too long (66 > 60) (funlen)
func TestOAuth2Client_ErrorHandling(t *testing.T) {
     ^
services/router/internal/gateway/oauth2_test.go:435:6: Function 'TestOAuth2Client_ConcurrentAccess' is too long (67 > 60) (funlen)
func TestOAuth2Client_ConcurrentAccess(t *testing.T) {
     ^
services/router/internal/gateway/pool_test.go:16:6: Function 'TestNewGatewayPool' is too long (89 > 60) (funlen)
func TestNewGatewayPool(t *testing.T) { 
     ^
services/router/internal/gateway/pool_test.go:109:6: Function 'TestGatewayPool_LoadBalancing' is too long (69 > 60) (funlen)
func TestGatewayPool_LoadBalancing(t *testing.T) { 
     ^
services/router/internal/gateway/pool_test.go:229:6: Function 'TestGatewayPool_GetEndpointByTags' is too long (86 > 60) (funlen)
func TestGatewayPool_GetEndpointByTags(t *testing.T) { 
     ^
services/router/internal/gateway/tcp_client_test.go:100:6: Function 'echoHandler' is too long (79 > 60) (funlen)
func echoHandler(conn net.Conn) {
     ^
services/router/internal/gateway/tcp_client_test.go:188:6: Function 'TestTCPClient_Connect' is too long (81 > 60) (funlen)
func TestTCPClient_Connect(t *testing.T) { 
     ^
services/router/internal/gateway/tcp_client_test.go:273:6: Function 'TestTCPClient_SendRequest' is too long (72 > 60) (funlen)
func TestTCPClient_SendRequest(t *testing.T) { 
     ^
services/router/internal/metrics/prometheus_test.go:363:6: Function 'TestPrometheusExporter_ResponseSizeHistogram' is too long (67 > 60) (funlen)
func TestPrometheusExporter_ResponseSizeHistogram(t *testing.T) { 
     ^
services/router/internal/metrics/prometheus_test.go:441:6: Function 'TestPrometheusExporter_ConcurrentAccess' is too long (73 > 60) (funlen)
func TestPrometheusExporter_ConcurrentAccess(t *testing.T) { 
     ^
services/router/internal/pool/manager_test.go:20:6: Function 'TestNewPooledGatewayClient' is too long (77 > 60) (funlen)
func TestNewPooledGatewayClient(t *testing.T) { 
     ^
services/router/internal/pool/pool_test.go:87:6: Function 'TestNewPool' is too long (77 > 60) (funlen)
func TestNewPool(t *testing.T) { 
     ^
services/router/internal/pool/pool_test.go:680:6: Function 'TestPoolConnectionLifecycle' is too long (71 > 60) (funlen)
func TestPoolConnectionLifecycle(t *testing.T) { 
     ^
services/router/internal/pool/pool_test.go:1069:6: Function 'TestPoolMaintenance' is too long (88 > 60) (funlen)
func TestPoolMaintenance(t *testing.T) { 
     ^
services/router/internal/pool/statistics_test.go:15:6: Function 'TestPoolStatisticsAccounting' has too many statements (47 > 40) (funlen)
func TestPoolStatisticsAccounting(t *testing.T) { 
     ^
services/router/internal/ratelimit/ratelimit_test.go:633:6: Function 'TestSlidingWindowLimiter_EdgeCases' is too long (67 > 60) (funlen)
func TestSlidingWindowLimiter_EdgeCases(t *testing.T) { 
     ^
services/router/internal/ratelimit/ratelimit_test.go:742:6: Function 'TestRateLimiter_UnderHighLoad' is too long (68 > 60) (funlen)
func TestRateLimiter_UnderHighLoad(t *testing.T) { 
     ^
services/router/internal/router/router_test.go:1142:6: Function 'TestMessageRouter_ConnectionStateHandling' is too long (80 > 60) (funlen)
func TestMessageRouter_ConnectionStateHandling(t *testing.T) { 
     ^
services/router/internal/router/router_test.go:1561:6: Function 'TestMessageRouter_RequestTimeout' is too long (61 > 60) (funlen)
func TestMessageRouter_RequestTimeout(t *testing.T) { 
     ^
services/router/internal/router/router_test.go:1632:6: Function 'TestMessageRouter_MetricsCollection' is too long (79 > 60) (funlen)
func TestMessageRouter_MetricsCollection(t *testing.T) { 
     ^
services/router/internal/router/router_test.go:2900:6: Function 'BenchmarkRouter_ConcurrentRequests' is too long (64 > 60) (funlen)
func BenchmarkRouter_ConcurrentRequests(b *testing.B) {
     ^
services/router/internal/router/router_test.go:2973:6: Function 'BenchmarkRouter_LargePayloads' is too long (68 > 60) (funlen)
func BenchmarkRouter_LargePayloads(b *testing.B) {
     ^
services/router/internal/secure/credential_security_test.go:88:6: Function 'testMemoryCorruptionProtection' is too long (65 > 60) (funlen)
func testMemoryCorruptionProtection(t *testing.T, store TokenStore) {
     ^
services/router/internal/secure/credential_security_test.go:165:6: Function 'testConcurrentAccessSafety' is too long (62 > 60) (funlen)
func testConcurrentAccessSafety(t *testing.T, store TokenStore) {
     ^
services/router/internal/secure/credential_security_test.go:240:6: Function 'testInjectionAttackProtection' is too long (80 > 60) (funlen)
func testInjectionAttackProtection(t *testing.T, store TokenStore) {
     ^
services/router/internal/health/checker.go:251:2: ifElseChain: rewrite if-else to switch statement (gocritic)
	if totalEndpoints == 0 { 
	^
services/router/internal/secure/credential_security_comprehensive_test.go:636:2: ifElseChain: rewrite if-else to switch statement (gocritic)
	if errors.Is(err, ErrListNotSupported) {
	^
services/router/internal/constants/timeouts_test.go:556:1: Comment should end in a period (godot)
// Helper functions for TestConnectionPoolTimeouts
^
services/router/internal/constants/timeouts_test.go:654:1: Comment should end in a period (godot)
// Helper functions for TestTimeoutConsistency
^
services/router/internal/direct/connection_pool_test.go:832:1: Comment should end in a period (godot)
// Helper functions for TestConnectionPool_ConcurrentAccess
^
services/router/internal/direct/connection_pool_test.go:921:1: Comment should end in a period (godot)
// Helper functions for TestConnectionPool_StressTest
^
services/router/internal/direct/error_handling_test.go:409:1: Comment should end in a period (godot)
// Helper functions for createConnectionFailureTests
^
services/router/internal/direct/error_handling_test.go:507:1: Comment should end in a period (godot)
// Helper functions for runConcurrentRequestsTest
^
services/router/internal/direct/error_handling_test.go:602:1: Comment should end in a period (godot)
// Helper functions for createErrorRecoveryTests
^
services/router/cmd/mcp-router/main.go:232:3: G101: Potential hardcoded credentials (gosec)
		tokenEnv = "MCP_AUTH_TOKEN" 
		^
services/router/internal/config/config_test.go:1498:5: G101: Potential hardcoded credentials (gosec)
	if token != "secure-env-token-123" { 
	   ^
services/router/internal/direct/adaptive_request_handler.go:224:17: G115: integer overflow conversion uint64 -> int64 (gosec)
		count := int64(u.metrics.RequestCount) 
		              ^
services/router/internal/direct/http_client_test.go:1054:24: G115: integer overflow conversion int -> uint64 (gosec)
	assert.Equal(t, uint64(numGoroutines*requestsPerGoroutine), metrics.RequestCount)
	                      ^
services/router/internal/direct/protocol_comparison_test.go:783:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	return os.WriteFile(filename, []byte(content), 0o755) 
	       ^
services/router/internal/direct/retry.go:208:8: G404: Use of weak random number generator (math/rand or math/rand/v2 instead of crypto/rand) (gosec)
		rng: rand.New(rand.NewSource(time.Now().UnixNano())), 
		     ^
services/router/internal/direct/sse_client_test.go:1014:24: G115: integer overflow conversion int -> uint64 (gosec)
	assert.Equal(t, uint64(expectedCount), metrics.RequestCount)
	                      ^
services/router/internal/direct/stdio_client_test.go:169:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:266:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755) 
	       ^
services/router/internal/direct/stdio_client_test.go:400:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:520:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:625:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:776:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:890:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1077:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1218:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1356:24: G115: integer overflow conversion int -> uint64 (gosec)
	assert.Equal(t, uint64(expectedCount), metrics.RequestCount)
	                      ^
services/router/internal/direct/stdio_client_test.go:1404:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1491:24: G115: integer overflow conversion int -> uint64 (gosec)
	assert.Equal(t, uint64(expectedRequests), metrics.RequestCount)
	                      ^
services/router/internal/direct/stdio_client_test.go:1546:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1685:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1785:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755) 
	       ^
services/router/internal/direct/stdio_client_test.go:1871:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1967:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_process_builder.go:66:10: G204: Subprocess launched with a potential tainted input or cmd arguments (gosec)
	b.cmd = exec.CommandContext(ctx, b.client.config.Command[0], b.client.config.Command[1:]...) 
	        ^
services/router/internal/direct/websocket_client_test.go:1028:24: G115: integer overflow conversion int -> uint64 (gosec)
	assert.Equal(t, uint64(numGoroutines*requestsPerGoroutine), metrics.RequestCount)
	                      ^
services/router/internal/router/router_test.go:1513:51: G115: integer overflow conversion int -> int32 (gosec)
			if atomic.LoadInt32(responsesReceived) >= int32(numRequests) {
			                                               ^
services/router/internal/secure/keychain_store_darwin.go:140:10: G204: Subprocess launched with variable (gosec)
		cmd := exec.CommandContext(ctx, "security", "add-generic-password",
			"-a", key, // account name
			"-s", serviceName, // service name
			"-w", token, // password
			"-U") // update if exists
services/router/internal/secure/keychain_store_darwin.go:168:10: G204: Subprocess launched with variable (gosec)
		cmd := exec.CommandContext(ctx, "security", "find-generic-password",
			"-a", key, // account name
			"-s", serviceName, // service name
			"-w") // return password only
services/router/internal/secure/keychain_store_darwin.go:215:10: G204: Subprocess launched with variable (gosec)
		cmd := exec.CommandContext(ctx, "security", "delete-generic-password",
			"-a", key, // account name
			"-s", serviceName) // service name
services/router/internal/direct/error_handling_test.go:508:1: setupConcurrentTestManager returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func setupConcurrentTestManager(t *testing.T) DirectClientManagerInterface {
^
services/router/internal/direct/manager.go:452:1: NewDirectClientManager returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func NewDirectClientManager(config DirectConfig, logger *zap.Logger) DirectClientManagerInterface {
^
services/router/internal/direct/manager.go:525:1: GetClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) GetClient(ctx context.Context, serverURL string) (DirectClient, error) {
^
services/router/internal/direct/manager.go:614:1: getOrCreateClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) getOrCreateClient(
^
services/router/internal/direct/manager.go:709:1: createClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) createClient(serverURL string, protocol ClientType) (DirectClient, error) {
^
services/router/internal/direct/manager.go:726:1: createStdioClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) createStdioClient(serverURL string) (DirectClient, error) {
^
services/router/internal/direct/manager.go:773:1: createWebSocketClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) createWebSocketClient(serverURL string) (DirectClient, error) {
^
services/router/internal/direct/manager.go:821:1: createHTTPClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) createHTTPClient(serverURL string) (DirectClient, error) {
^
services/router/internal/direct/manager.go:868:1: createSSEClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) createSSEClient(serverURL string) (DirectClient, error) {
^
services/router/internal/direct/manager_builder.go:148:1: BuildClientOrchestrator returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func (b *DirectManagerConfigurationBuilder) BuildClientOrchestrator() DirectClientManagerInterface {
^
services/router/internal/direct/manager_test.go:246:1: setupProtocolDetectionManager returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func setupProtocolDetectionManager(t *testing.T, logger *zap.Logger) DirectClientManagerInterface {
^
services/router/internal/direct/manager_test.go:446:1: setupValidURLsManager returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func setupValidURLsManager(t *testing.T, logger *zap.Logger) DirectClientManagerInterface {
^
services/router/internal/direct/manager_test.go:1437:1: setupErrorHandlingTestManager returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func setupErrorHandlingTestManager(t *testing.T) DirectClientManagerInterface {
^
services/router/internal/direct/protocol_comparison_test.go:62:1: setupHTTPBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupHTTPBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:87:1: setupWebSocketBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupWebSocketBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:112:1: setupSSEBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupSSEBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:136:1: setupStdioBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupStdioBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:250:1: setupHTTPBenchmarkClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupHTTPBenchmarkClient(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:265:1: setupWebSocketBenchmarkClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupWebSocketBenchmarkClient(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:280:1: setupSSEBenchmarkClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupSSEBenchmarkClient(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:295:1: setupStdioBenchmarkClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupStdioBenchmarkClient(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:367:1: setupHTTPConcurrencyBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupHTTPConcurrencyBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:390:1: setupWebSocketConcurrencyBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupWebSocketConcurrencyBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:412:1: setupSSEConcurrencyBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupSSEConcurrencyBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:434:1: setupStdioConcurrencyBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupStdioConcurrencyBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:546:1: setupHTTPPayloadBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupHTTPPayloadBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:568:1: setupWebSocketPayloadBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupWebSocketPayloadBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:591:1: setupSSEPayloadBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupSSEPayloadBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:613:1: setupStdioPayloadBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupStdioPayloadBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/gateway/factory.go:33:1: NewGatewayClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func NewGatewayClient(cfg config.GatewayConfig, logger *zap.Logger) (GatewayClient, error) {
^
services/router/internal/gateway/factory.go:53:1: NewGatewayClientWithPool returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func NewGatewayClientWithPool(cfg *config.Config, logger *zap.Logger) (GatewayClient, error) {
^
services/router/internal/gateway/pool.go:216:1: wrapWithCircuitBreakerIfEnabled returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func wrapWithCircuitBreakerIfEnabled( 
^
services/router/internal/patterns/handler_pattern.go:341:1: EstablishManagedConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/patterns.Connection) (ireturn)
func (m *ConnectionManager) EstablishManagedConnection(
^
services/router/internal/patterns/handler_pattern.go:370:1: establishNewConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/patterns.Connection) (ireturn)
func (m *ConnectionManager) establishNewConnection(ctx context.Context, config ConnectionConfig) (Connection, error) {
^
services/router/internal/pool/connection_acquirer.go:24:1: AcquireConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (a *ConnectionAcquirer) AcquireConnection(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/connection_acquirer.go:73:1: tryGetIdleConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (a *ConnectionAcquirer) tryGetIdleConnection() Connection {
^
services/router/internal/pool/connection_acquirer.go:100:1: tryCreateNewConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (a *ConnectionAcquirer) tryCreateNewConnection(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/connection_acquirer.go:126:1: waitForConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (a *ConnectionAcquirer) waitForConnection(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/connection_acquirer.go:162:1: WaitForConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (w *ConnectionWaiter) WaitForConnection() (Connection, error) {
^
services/router/internal/pool/connection_acquirer.go:175:1: handleReceivedConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (w *ConnectionWaiter) handleReceivedConnection(conn *pooledConn) (Connection, error) {
^
services/router/internal/pool/generic_connection.go:70:1: GetClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func (c *GenericConnection) GetClient() gateway.GatewayClient {
^
services/router/internal/pool/generic_connection.go:107:1: Create returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (f *GenericFactory) Create(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/manager.go:72:1: acquireConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (p *PooledGatewayClient) acquireConnection(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/pool.go:323:1: Acquire returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (p *Pool) Acquire(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/pool_acquire_test.go:83:1: Create returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (tf *testFactory) Create(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/pool_test.go:69:1: Create returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (f *mockFactory) Create(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/tcp_pool.go:11:1: createTCPClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func createTCPClient(cfg config.GatewayConfig, logger *zap.Logger) (gateway.GatewayClient, error) {
^
services/router/internal/pool/websocket_pool.go:11:1: createWebSocketClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func createWebSocketClient(cfg config.GatewayConfig, logger *zap.Logger) (gateway.GatewayClient, error) {
^
services/router/internal/ratelimit/ratelimit.go:289:1: NewRateLimiter returns interface (github.com/poiley/mcp-bridge/services/router/internal/ratelimit.RateLimiter) (ireturn)
func NewRateLimiter(ratePerSecond float64, burst int, logger *zap.Logger) RateLimiter {
^
services/router/internal/router/gateway_fallback_integration_test.go:396:1: GetClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (t *TestDirectManager) GetClient(ctx context.Context, serverURL string) (direct.DirectClient, error) {
^
services/router/internal/secure/credential_security_comprehensive_test.go:96:1: setupMaliciousInputTestStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupMaliciousInputTestStore(t *testing.T, tempDir string) TokenStore {
^
services/router/internal/secure/credential_security_comprehensive_test.go:251:1: setupFileSystemSecurityTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupFileSystemSecurityTest(t *testing.T, tempDir string) (TokenStore, *encryptedFileStore) {
^
services/router/internal/secure/credential_security_comprehensive_test.go:402:1: setupRaceConditionTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupRaceConditionTest(t *testing.T) TokenStore {
^
services/router/internal/secure/credential_security_comprehensive_test.go:600:1: setupPlatformTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupPlatformTest(t *testing.T) TokenStore {
^
services/router/internal/secure/credential_security_test.go:75:1: setupCredentialStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupCredentialStore(t *testing.T) TokenStore {
^
services/router/internal/secure/credential_security_test.go:825:1: setupCredentialStoreForBench returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupCredentialStoreForBench(b *testing.B) TokenStore {
^
services/router/internal/secure/credential_store_other.go:13:1: newCredentialStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func newCredentialStore(appName string) (TokenStore, error) {
^
services/router/internal/secure/encrypted_file_store.go:33:1: newEncryptedFileStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func newEncryptedFileStore(appName string) (TokenStore, error) {
^
services/router/internal/secure/keychain_store_darwin.go:35:1: newKeychainStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func newKeychainStore(appName string) (TokenStore, error) {
^
services/router/internal/secure/secret_service_store_other.go:11:1: newSecretServiceStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func newSecretServiceStore(appName string) (TokenStore, error) {
^
services/router/internal/secure/token_store.go:39:1: NewTokenStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func NewTokenStore(appName string) (TokenStore, error) {
^
services/router/internal/secure/token_store_test.go:23:1: validateTokenStoreCreation returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func validateTokenStoreCreation(t *testing.T, appName string) TokenStore {
^
services/router/internal/secure/token_store_test.go:110:1: setupTokenStoreTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupTokenStoreTest(t *testing.T, testKey string) TokenStore {
^
services/router/internal/secure/token_store_test.go:218:1: setupEncryptedFileStoreTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupEncryptedFileStoreTest(t *testing.T) (TokenStore, string, func()) {
^
services/router/internal/secure/token_store_test.go:351:1: setupConcurrentTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupConcurrentTest(t *testing.T) TokenStore {
^
services/router/internal/secure/token_store_test.go:459:1: setupSecurityTestStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupSecurityTestStore(t *testing.T, tempDir string) (*encryptedFileStore, TokenStore) {
^
services/router/internal/secure/token_store_test.go:628:1: setupConcurrentEncryptedTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupConcurrentEncryptedTest(t *testing.T, tempDir string) TokenStore {
^
services/router/internal/secure/token_store_test.go:702:1: setupTokenStoreEdgeCaseTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupTokenStoreEdgeCaseTest(t *testing.T) TokenStore {
^
services/router/internal/secure/token_store_test.go:850:1: setupPerformanceTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupPerformanceTest(t *testing.T) TokenStore {
^
services/router/internal/secure/token_store_test_helpers.go:41:1: CreateStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func (env *TokenStoreTestEnvironment) CreateStore(serviceName string) TokenStore {
^
services/router/internal/tracing/tracing.go:111:1: createExporter returns interface (go.opentelemetry.io/otel/sdk/trace.SpanExporter) (ireturn)
func createExporter(cfg config.TracingConfig, logger *zap.Logger) (sdktrace.SpanExporter, error) {
^
services/router/internal/tracing/tracing.go:134:1: createSampler returns interface (go.opentelemetry.io/otel/sdk/trace.Sampler) (ireturn)
func createSampler(cfg config.TracingConfig) sdktrace.Sampler {
^
services/router/internal/tracing/tracing.go:148:1: StartSpan returns interface (go.opentelemetry.io/otel/trace.Span) (ireturn)
func (t *Tracer) StartSpan(ctx context.Context, name string,
^
services/router/internal/tracing/tracing.go:158:1: StartSpanWithKind returns interface (go.opentelemetry.io/otel/trace.Span) (ireturn)
func (t *Tracer) StartSpanWithKind(ctx context.Context, name string,
^
services/router/cmd/mcp-router/metrics_test.go:120:1: The line is 140 characters long, which exceeds the maximum of 120 characters. (lll)
func runMetricsServerWithTests(t *testing.T, ctx context.Context, cancel context.CancelFunc, cfg *config.Config, logger *zap.Logger) error {
^
services/router/internal/direct/adaptive_test.go:745:1: The line is 127 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyAdaptiveBehavior(t *testing.T, adaptive *AdaptiveTimeout, initialTimeout, peakTimeout, finalTimeout time.Duration) {
^
services/router/internal/direct/http_client_test.go:980:1: The line is 136 characters long, which exceeds the maximum of 120 characters. (lll)
func runConcurrentHTTPOperations(t *testing.T, client *HTTPClient, numGoroutines, requestsPerGoroutine int) ([]error, []*mcp.Response) {
^
services/router/internal/direct/http_client_test.go:1046:1: The line is 152 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyConcurrentHTTPResults(t *testing.T, client *HTTPClient, errors []error, responses []*mcp.Response, numGoroutines, requestsPerGoroutine int) {
^
services/router/internal/direct/manager.go:634:1: The line is 147 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *DirectClientManager) createClientConnectionFunc(ctx context.Context, serverURL string, protocol ClientType) func() (DirectClient, error) {
^
services/router/internal/direct/manager.go:661:1: The line is 126 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *DirectClientManager) recordConnectionFailure(serverURL string, protocol ClientType, startTime time.Time, err error) {
^
services/router/internal/direct/manager_test.go:1270:1: The line is 144 characters long, which exceeds the maximum of 120 characters. (lll)
func runConcreteProtocolDetectionTests(t *testing.T, manager *DirectClientManager, ctx context.Context, testCases []protocolDetectionTestCase) {
^
services/router/internal/direct/manager_test.go:1519:1: The line is 136 characters long, which exceeds the maximum of 120 characters. (lll)
func runErrorHandlingTests(t *testing.T, manager DirectClientManagerInterface, ctx context.Context, testCases []errorHandlingTestCase) {
^
services/router/internal/direct/memory_optimization_test.go:356:1: The line is 141 characters long, which exceeds the maximum of 120 characters. (lll)
func runConcurrentBufferOperations(t *testing.T, wg *sync.WaitGroup, optimizer *MemoryOptimizer, numGoroutines, operationsPerGoroutine int) {
^
services/router/internal/direct/memory_optimization_test.go:375:1: The line is 139 characters long, which exceeds the maximum of 120 characters. (lll)
func runConcurrentJSONOperations(t *testing.T, wg *sync.WaitGroup, optimizer *MemoryOptimizer, numGoroutines, operationsPerGoroutine int) {
^
services/router/internal/direct/memory_optimization_test.go:405:1: The line is 136 characters long, which exceeds the maximum of 120 characters. (lll)
func runConcurrentStatsAccess(t *testing.T, wg *sync.WaitGroup, optimizer *MemoryOptimizer, numGoroutines, operationsPerGoroutine int) {
^
services/router/internal/direct/protocol_comparison_test.go:665:1: The line is 123 characters long, which exceeds the maximum of 120 characters. (lll)
func runPayloadBenchmarkLoop(b *testing.B, client DirectClient, ctx context.Context, protocolName string, payload string) {
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:490:1: The line is 123 characters long, which exceeds the maximum of 120 characters. (lll)
		go runConcurrentDetectionWorker(t, &wg, manager, serverURLs, ctx, i, detectionsPerWorker, &successfulDetections, &errors)
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:523:1: The line is 156 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyConcurrentDetectionResults(t *testing.T, manager *DirectClientManager, numWorkers, detectionsPerWorker int, successfulDetections, errors int64) {
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:716:1: The line is 127 characters long, which exceeds the maximum of 120 characters. (lll)
func runProtocolDetectionTest(t *testing.T, manager *DirectClientManager, ctx context.Context, testURL, expectedError string) {
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:725:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyNoCacheForFailures(t *testing.T, manager *DirectClientManager, ctx context.Context, testURL string, config DirectConfig) {
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:783:1: The line is 129 characters long, which exceeds the maximum of 120 characters. (lll)
func runEdgeCaseTests(t *testing.T, manager *DirectClientManager, ctx context.Context, config DirectConfig, logger *zap.Logger) {
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:1009:1: The line is 156 characters long, which exceeds the maximum of 120 characters. (lll)
func runSingleDetection(t *testing.T, wg *sync.WaitGroup, manager *DirectClientManager, ctx context.Context, serverURL string, i int, successCount *int64) {
^
services/router/internal/direct/sse_client_test.go:809:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
func setupSSEPerformanceClient(t *testing.T, logger *zap.Logger, mockServer *mockSSEServer, perfConfig SSEPerformanceConfig) *SSEClient {
^
services/router/internal/direct/sse_client_test.go:854:1: The line is 123 characters long, which exceeds the maximum of 120 characters. (lll)
func analyzeSSEPerformanceResults(t *testing.T, testName string, connectTime time.Duration, requestTimes []time.Duration) {
^
services/router/internal/direct/stdio_client_test.go:1082:1: The line is 135 characters long, which exceeds the maximum of 120 characters. (lll)
func setupStdioPerformanceClient(t *testing.T, logger *zap.Logger, scriptPath string, perfConfig StdioPerformanceConfig) *StdioClient {
^
services/router/internal/direct/stdio_client_test.go:1138:1: The line is 125 characters long, which exceeds the maximum of 120 characters. (lll)
func analyzeStdioPerformanceResults(t *testing.T, testName string, connectTime time.Duration, requestTimes []time.Duration) {
^
services/router/internal/direct/stdio_client_test.go:1972:1: The line is 134 characters long, which exceeds the maximum of 120 characters. (lll)
func setupStdioMemoryBenchClient(b *testing.B, logger *zap.Logger, scriptPath string, memoryOptimizer *MemoryOptimizer) *StdioClient {
^
services/router/internal/direct/websocket_client.go:203:1: The line is 156 characters long, which exceeds the maximum of 120 characters. (lll)
func (c *WebSocketClient) establishConnection(ctx context.Context, dialer *websocket.Dialer, headers http.Header) (*websocket.Conn, *http.Response, error) {
^
services/router/internal/direct/websocket_client_test.go:903:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func setupWebSocketConcurrentClient(t *testing.T, logger *zap.Logger, mockServer *mockWebSocketServer) *WebSocketClient {
^
services/router/internal/direct/websocket_client_test.go:957:1: The line is 174 characters long, which exceeds the maximum of 120 characters. (lll)
func executeWebSocketConcurrentRequests(t *testing.T, client *WebSocketClient, numGoroutines, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
^
services/router/internal/direct/websocket_client_test.go:973:1: The line is 180 characters long, which exceeds the maximum of 120 characters. (lll)
func executeWebSocketConcurrentGoroutine(ctx context.Context, client *WebSocketClient, goroutineID, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
^
services/router/internal/direct/websocket_client_test.go:1005:1: The line is 161 characters long, which exceeds the maximum of 120 characters. (lll)
func collectWebSocketConcurrentResults(errChan chan error, responseChan chan *mcp.Response, numGoroutines, requestsPerGoroutine int) ([]error, []*mcp.Response) {
^
services/router/internal/direct/websocket_client_test.go:1022:1: The line is 162 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyWebSocketConcurrentResults(t *testing.T, client *WebSocketClient, errors []error, responses []*mcp.Response, numGoroutines, requestsPerGoroutine int) {
^
services/router/internal/direct/websocket_client_test.go:1277:1: The line is 178 characters long, which exceeds the maximum of 120 characters. (lll)
func setupWebSocketPerformanceClient(t *testing.T, logger *zap.Logger, mockServer *mockWebSocketServer, perfConfig WebSocketPerformanceConfig) (*WebSocketClient, time.Duration) {
^
services/router/internal/direct/websocket_client_test.go:1332:1: The line is 128 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyWebSocketPerformanceResults(t *testing.T, testName string, connectTime time.Duration, requestTimes []time.Duration) {
^
services/router/internal/direct/websocket_client_test.go:1443:1: The line is 143 characters long, which exceeds the maximum of 120 characters. (lll)
func setupWebSocketFrameHandlingClient(t *testing.T, logger *zap.Logger, server *httptest.Server, tc webSocketFrameTestCase) *WebSocketClient {
^
services/router/internal/gateway/gateway_integration_advanced_test.go:549:1: The line is 135 characters long, which exceeds the maximum of 120 characters. (lll)
func runGoroutineOperations(goroutineID, operationsCount int, cfg config.GatewayConfig, logger *zap.Logger, counters *clientCounters) {
^
services/router/internal/gateway/gateway_integration_advanced_test.go:555:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func runSingleOperation(goroutineID, opIdx int, cfg config.GatewayConfig, logger *zap.Logger, counters *clientCounters) {
^
services/router/internal/router/router_test.go:127:1: The line is 132 characters long, which exceeds the maximum of 120 characters. (lll)
func validateNewRouterInitialization(t *testing.T, router *LocalRouter, expectedConfig *config.Config, expectedLogger *zap.Logger) {
^
services/router/internal/router/router_test.go:262:1: The line is 147 characters long, which exceeds the maximum of 120 characters. (lll)
func setupMessageProcessingRouter(t *testing.T, mockServer *httptest.Server) (*LocalRouter, context.Context, context.CancelFunc, <-chan struct{}) {
^
services/router/internal/router/router_test.go:621:1: The line is 144 characters long, which exceeds the maximum of 120 characters. (lll)
func setupInitializationRouter(t *testing.T, mockServer *httptest.Server) (*LocalRouter, context.Context, context.CancelFunc, <-chan struct{}) {
^
services/router/internal/router/router_test.go:879:1: The line is 139 characters long, which exceeds the maximum of 120 characters. (lll)
func setupBenchmarkRouter(b *testing.B, mockServer *httptest.Server) (*LocalRouter, context.Context, context.CancelFunc, <-chan struct{}) {
^
services/router/internal/router/router_test.go:1055:1: The line is 149 characters long, which exceeds the maximum of 120 characters. (lll)
func monitorCorrelationResponses(t *testing.T, router *LocalRouter, ctx context.Context, receivedResponses map[string]bool, responseMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:1110:1: The line is 127 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyAllResponsesReceived(t *testing.T, requestIDs []string, receivedResponses map[string]bool, responseMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:1488:1: The line is 123 characters long, which exceeds the maximum of 120 characters. (lll)
				req := fmt.Sprintf(`{"jsonrpc":"2.0","method":"test.concurrent","params":{"worker_id":%d},"id":"%s"}`, workerID, reqID)
^
services/router/internal/router/router_test.go:2040:1: The line is 139 characters long, which exceeds the maximum of 120 characters. (lll)
func monitorQueueLifecycleResponses(ctx context.Context, router *LocalRouter, responsesReceived *map[string]bool, responseMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:2069:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
func waitForAllQueuedResponses(t *testing.T, queuedRequestIDs []string, responsesReceived *map[string]bool, responseMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:2085:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyQueuedResponsesReceived(t *testing.T, queuedRequestIDs []string, responsesReceived *map[string]bool, responseMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:2686:1: The line is 131 characters long, which exceeds the maximum of 120 characters. (lll)
func monitorRoutingDecisions(ctx context.Context, router *LocalRouter, routingDecisions map[string]int32, decisionMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:2702:1: The line is 172 characters long, which exceeds the maximum of 120 characters. (lll)
func validateRoutingDecision(t *testing.T, tt routingDecisionTest, gatewayRequests *int32, routingDecisions map[string]int32, decisionMu *sync.Mutex, router *LocalRouter) {
^
services/router/internal/router/router_test.go:2783:1: The line is 129 characters long, which exceeds the maximum of 120 characters. (lll)
func setupProtocolNegotiationServer(t *testing.T, protocolResponses *map[string]int32, protocolMu *sync.Mutex) *httptest.Server {
^
services/router/internal/router/router_test.go:2791:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
func handleProtocolNegotiationRequests(t *testing.T, conn *websocket.Conn, protocolResponses *map[string]int32, protocolMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:2875:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
func validateProtocolResponses(t *testing.T, protocolMethods []string, protocolResponses *map[string]int32, protocolMu *sync.Mutex) {
^
services/router/internal/secure/keychain_store_darwin.go:290:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
		return nil, fmt.Errorf("decode failed or too long") // Conservative limit: anything longer is probably a real hex token
^
services/router/internal/stdio/handler_test.go:138:1: The line is 139 characters long, which exceeds the maximum of 120 characters. (lll)
func runStdinHandlerTest(t *testing.T, ctx context.Context, cancel context.CancelFunc, handler *Handler, stdinChan chan []byte, tt struct {
^
services/router/internal/gateway/client_test.go:482:1: `if tt.wantError` has complex nested blocks (complexity: 6) (nestif)
	if tt.wantError {
^
services/router/internal/gateway/client_test.go:1359:1: `if tt.wantError` has complex nested blocks (complexity: 5) (nestif)
			if tt.wantError {
^
services/router/internal/gateway/client_test.go:1560:1: `if tt.wantError` has complex nested blocks (complexity: 5) (nestif)
			if tt.wantError {
^
services/router/internal/secure/encrypted_file_store.go:168:3: error is not nil (line 163) but it returns nil (nilerr)
		return &tokenData{Tokens: make(map[string]string)}, nil
		^
services/router/internal/secure/encrypted_file_store.go:176:3: error is not nil (line 173) but it returns nil (nilerr)
		return &tokenData{Tokens: make(map[string]string)}, nil
		^
services/router/cmd/mcp-router/metrics_test.go:164:3: return with no blank line before (nlreturn)
		return &metrics.RouterMetrics{
		^
services/router/cmd/mcp-router/metrics_test.go:262:2: return with no blank line before (nlreturn)
	return logger
	^
services/router/cmd/mcp-router/metrics_test.go:349:2: return with no blank line before (nlreturn)
	return string(body[:n])
	^
services/router/cmd/mcp-router/update_test.go:89:5: return with no blank line before (nlreturn)
				return
				^
services/router/cmd/mcp-router/update_test.go:260:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/config/config_integration_test.go:740:3: return with no blank line before (nlreturn)
		return fmt.Sprintf(configYAML, tokenPath)
		^
services/router/internal/config/config_integration_test.go:742:2: return with no blank line before (nlreturn)
	return configYAML
	^
services/router/internal/config/config_test.go:1303:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/config/config_test.go:1315:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/direct/http_client_test.go:505:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/http_client_test.go:511:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/http_client_test.go:1006:6: return with no blank line before (nlreturn)
					return
					^
services/router/internal/direct/manager.go:651:4: return with no blank line before (nlreturn)
			return nil, fmt.Errorf("failed to connect %s client to %s: %w", protocol, serverURL, err)
			^
services/router/internal/direct/manager.go:1296:3: return with no blank line before (nlreturn)
		return nil, err
		^
services/router/internal/direct/manager.go:1304:3: return with no blank line before (nlreturn)
		return nil, fmt.Errorf("invalid scheme for SSE: %s", parsedURL.Scheme)
		^
services/router/internal/direct/manager.go:1321:3: return with no blank line before (nlreturn)
		return nil, err
		^
services/router/internal/direct/manager.go:1339:3: return with no blank line before (nlreturn)
		return nil, err
		^
services/router/internal/direct/manager.go:1358:3: return with no blank line before (nlreturn)
		return false
		^
services/router/internal/direct/manager_test.go:1234:2: return with no blank line before (nlreturn)
	return append(basicCases, additionalCases...)
	^
services/router/internal/direct/manager_test.go:1321:2: return with no blank line before (nlreturn)
	return append(basicCases, advancedCases...)
	^
services/router/internal/direct/manager_test.go:1454:2: return with no blank line before (nlreturn)
	return manager
	^
services/router/internal/direct/manager_test.go:1625:2: return with no blank line before (nlreturn)
	return manager
	^
services/router/internal/direct/manager_test.go:1730:2: return with no blank line before (nlreturn)
	return manager
	^
services/router/internal/direct/manager_test.go:1820:2: return with no blank line before (nlreturn)
	return manager
	^
services/router/internal/direct/manager_test.go:1885:2: return with no blank line before (nlreturn)
	return manager
	^
services/router/internal/direct/memory_optimization_test.go:575:2: return with no blank line before (nlreturn)
	return initialMem
	^
services/router/internal/direct/memory_optimization_test.go:624:2: return with no blank line before (nlreturn)
	return memoryIncrease
	^
services/router/internal/direct/memory_optimization_test.go:663:2: return with no blank line before (nlreturn)
	return NewMemoryOptimizer(configWithPooling, logger)
	^
services/router/internal/direct/memory_optimization_test.go:671:2: return with no blank line before (nlreturn)
	return NewMemoryOptimizer(configWithoutPooling, logger)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:226:4: return with no blank line before (nlreturn)
			return httpServer.URL, "", "", func() { httpServer.Close() }
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:258:4: return with no blank line before (nlreturn)
			return httpServer.URL, wsURL, "", func() {
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:291:4: return with no blank line before (nlreturn)
			return "", "", sseServer.URL, func() { sseServer.Close() }
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:323:4: return with no blank line before (nlreturn)
			return httpServer.URL, wsURL, "", func() {
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:356:4: return with no blank line before (nlreturn)
			return httpServer.URL, "", "", func() { httpServer.Close() }
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:511:4: continue with no blank line before (nlreturn)
			continue
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:516:4: continue with no blank line before (nlreturn)
			continue
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:711:3: return with no blank line before (nlreturn)
		return testURL
		^
services/router/internal/direct/protocol_negotiation_advanced_test.go:713:2: return with no blank line before (nlreturn)
	return tt.serverURL
	^
services/router/internal/direct/sse_client_test.go:822:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/sse_client_test.go:830:2: return with no blank line before (nlreturn)
	return time.Since(start)
	^
services/router/internal/direct/sse_client_test.go:907:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/sse_client_test.go:937:2: return with no blank line before (nlreturn)
	return errChan, responseChan
	^
services/router/internal/direct/sse_client_test.go:964:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/sse_client_test.go:1140:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/direct/sse_client_test.go:1167:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/sse_client_test.go:1201:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/sse_client_test.go:1341:2: return with no blank line before (nlreturn)
	return httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
	^
services/router/internal/direct/sse_client_test.go:1426:5: return with no blank line before (nlreturn)
				return
				^
services/router/internal/direct/sse_client_test.go:1457:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:171:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:192:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:402:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:522:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:546:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:627:2: return with no blank line before (nlreturn)
	return tmpDir, scriptPath
	^
services/router/internal/direct/stdio_client_test.go:649:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:778:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:796:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:892:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1079:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1095:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1111:2: return with no blank line before (nlreturn)
	return time.Since(start)
	^
services/router/internal/direct/stdio_client_test.go:1220:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1247:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1279:2: return with no blank line before (nlreturn)
	return errChan, responseChan
	^
services/router/internal/direct/stdio_client_test.go:1306:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/stdio_client_test.go:1406:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1428:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1548:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1575:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1687:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1708:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1873:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1900:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1969:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:2000:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/websocket_client.go:200:2: return with no blank line before (nlreturn)
	return headers
	^
services/router/internal/direct/websocket_client.go:218:3: return with no blank line before (nlreturn)
		return nil, resp, fmt.Errorf("WebSocket connection failed: %w", err)
		^
services/router/internal/direct/websocket_client.go:231:3: return with no blank line before (nlreturn)
		return conn.SetReadDeadline(time.Now().Add(c.config.PongTimeout))
		^
services/router/internal/direct/websocket_client.go:477:2: return with no blank line before (nlreturn)
	return nil
	^
services/router/internal/direct/websocket_client.go:529:3: return with no blank line before (nlreturn)
		return ctx.Err()
		^
services/router/internal/direct/websocket_client_test.go:368:2: return with no blank line before (nlreturn)
	return slowServer
	^
services/router/internal/direct/websocket_client_test.go:389:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/websocket_client_test.go:662:3: return with no blank line before (nlreturn)
		return conn.WriteControl(websocket.PongMessage, []byte(appData), time.Now().Add(time.Second))
		^
services/router/internal/direct/websocket_client_test.go:667:3: return with no blank line before (nlreturn)
		return nil
		^
services/router/internal/direct/websocket_client_test.go:954:2: return with no blank line before (nlreturn)
	return errChan, responseChan
	^
services/router/internal/direct/websocket_client_test.go:984:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/websocket_client_test.go:1068:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/websocket_client_test.go:1424:2: return with no blank line before (nlreturn)
	return mcp.Response{
	^
services/router/internal/gateway/binary_frame_test.go:139:5: return with no blank line before (nlreturn)
				return
				^
services/router/internal/gateway/binary_frame_test.go:146:5: return with no blank line before (nlreturn)
				return
				^
services/router/internal/gateway/binary_frame_test.go:218:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/router/internal/gateway/binary_frame_test.go:228:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/router/internal/gateway/binary_frame_test.go:238:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/router/internal/gateway/binary_frame_test.go:249:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/router/internal/gateway/client_mtls_test.go:531:2: return with no blank line before (nlreturn)
	return &Client{
	^
services/router/internal/gateway/client_test.go:93:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/client_test.go:98:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/client_test.go:103:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/client_test.go:166:5: return with no blank line before (nlreturn)
				return nil
				^
services/router/internal/gateway/client_test.go:182:5: return with no blank line before (nlreturn)
				return nil
				^
services/router/internal/gateway/client_test.go:318:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/gateway/client_test.go:325:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/gateway/client_test.go:1585:2: return with no blank line before (nlreturn)
	return httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:242:2: return with no blank line before (nlreturn)
	return tests
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:269:4: return with no blank line before (nlreturn)
			return err
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:305:4: return with no blank line before (nlreturn)
			return err
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:355:4: return with no blank line before (nlreturn)
			return err
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:461:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:512:2: return with no blank line before (nlreturn)
	return addr
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:559:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:566:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:577:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/namespace_router_test.go:87:2: return with no blank line before (nlreturn)
	return router
	^
services/router/internal/gateway/namespace_router_test.go:181:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/namespace_router_test.go:206:2: return with no blank line before (nlreturn)
	return false
	^
services/router/internal/gateway/tcp_client_advanced_test.go:139:2: return with no blank line before (nlreturn)
	return append([]string{}, e.events...)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:190:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/gateway/tcp_client_advanced_test.go:244:2: return with no blank line before (nlreturn)
	return addr
	^
services/router/internal/gateway/tcp_client_advanced_test.go:259:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/gateway/tcp_client_advanced_test.go:303:5: break with no blank line before (nlreturn)
				break
				^
services/router/internal/gateway/tcp_client_advanced_test.go:423:2: return with no blank line before (nlreturn)
	return addr
	^
services/router/internal/gateway/tcp_client_advanced_test.go:470:2: return with no blank line before (nlreturn)
	return results
	^
services/router/internal/gateway/tcp_client_advanced_test.go:484:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/tcp_client_advanced_test.go:490:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/tcp_client_advanced_test.go:503:3: return with no blank line before (nlreturn)
		return -1
		^
services/router/internal/gateway/tcp_client_advanced_test.go:509:3: return with no blank line before (nlreturn)
		return -1
		^
services/router/internal/gateway/tcp_client_advanced_test.go:652:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/gateway/tcp_client_advanced_test.go:676:2: return with no blank line before (nlreturn)
	return err
	^
services/router/internal/health/checker_test.go:253:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/health/checker_test.go:369:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/router/gateway_fallback_integration_test.go:70:3: return with no blank line before (nlreturn)
		return nil
		^
services/router/internal/router/gateway_fallback_integration_test.go:79:5: return with no blank line before (nlreturn)
				return &mcp.Response{
				^
services/router/internal/router/gateway_fallback_integration_test.go:218:4: continue with no blank line before (nlreturn)
			continue
			^
services/router/internal/router/message_router.go:490:4: return with no blank line before (nlreturn)
			return nil
			^
services/router/internal/router/message_router.go:500:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/router/message_router.go:638:2: return with no blank line before (nlreturn)
	return fmt.Errorf("%s: %w", msg, err)
	^
services/router/internal/router/router_test.go:104:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/router/router_test.go:116:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/router/router_test.go:121:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/router/router_test.go:379:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/router/router_test.go:1035:2: return with no blank line before (nlreturn)
	return router, ctx, cancel
	^
services/router/internal/router/router_test.go:1123:5: break with no blank line before (nlreturn)
				break
				^
services/router/internal/router/router_test.go:2019:2: return with no blank line before (nlreturn)
	return nil
	^
services/router/internal/router/router_test.go:2037:2: return with no blank line before (nlreturn)
	return router
	^
services/router/internal/router/router_test.go:2081:3: return with no blank line before (nlreturn)
		return true
		^
services/router/internal/router/router_test.go:2426:7: return with no blank line before (nlreturn)
						return nil
						^
services/router/internal/router/router_test.go:2439:2: return with no blank line before (nlreturn)
	return &config.Config{
	^
services/router/internal/router/router_test.go:2464:2: return with no blank line before (nlreturn)
	return router
	^
services/router/internal/router/router_test.go:2683:2: return with no blank line before (nlreturn)
	return router
	^
services/router/internal/router/router_test.go:2850:2: return with no blank line before (nlreturn)
	return router
	^
services/router/internal/secure/credential_security_comprehensive_test.go:108:2: return with no blank line before (nlreturn)
	return store
	^
services/router/internal/secure/credential_security_comprehensive_test.go:207:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/secure/credential_security_comprehensive_test.go:214:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/secure/credential_security_test.go:520:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/secure/credential_security_test.go:592:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/secure/keychain_store_darwin.go:129:2: return with no blank line before (nlreturn)
	return strings.Contains(errorStr, "resource temporarily unavailable") ||
	^
services/router/internal/secure/keychain_store_darwin.go:282:2: return with no blank line before (nlreturn)
	return matched
	^
services/router/internal/secure/keychain_store_darwin.go:292:2: return with no blank line before (nlreturn)
	return decoded, nil
	^
services/router/internal/secure/keychain_store_darwin.go:309:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/secure/keychain_store_darwin.go:346:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/secure/token_store_test.go:709:2: return with no blank line before (nlreturn)
	return store
	^
services/router/internal/secure/token_store_test.go:807:3: return with no blank line before (nlreturn)
		return false
		^
services/router/internal/secure/token_store_test.go:812:3: return with no blank line before (nlreturn)
		return false
		^
services/router/internal/secure/token_store_test.go:825:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/stdio/handler_test.go:160:6: return with no blank line before (nlreturn)
					return
					^
services/router/internal/stdio/handler_test.go:168:5: return with no blank line before (nlreturn)
				return
				^
services/router/internal/stdio/handler_test.go:360:2: return with no blank line before (nlreturn)
	return &outputBuf, handler, stdoutChan, ctx, cancel
	^
services/router/internal/stdio/handler_test.go:376:4: continue with no blank line before (nlreturn)
			continue
			^
services/router/internal/stdio/handler_test.go:388:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/tracing/tracing_test.go:106:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/tracing/tracing_test.go:171:2: return with no blank line before (nlreturn)
	return tracer
	^
services/router/internal/tracing/tracing_test.go:286:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/direct/sse_client_test.go:991:2: Consider pre-allocating `errors` (prealloc)
	var errors []error
	^
services/router/internal/direct/sse_client_test.go:996:2: Consider pre-allocating `responses` (prealloc)
	var responses []*mcp.Response
	^
services/router/internal/direct/stdio_client_test.go:1333:2: Consider pre-allocating `errors` (prealloc)
	var errors []error
	^
services/router/internal/direct/stdio_client_test.go:1338:2: Consider pre-allocating `responses` (prealloc)
	var responses []*mcp.Response
	^
services/router/internal/direct/protocol_comparison_test.go:41:6: test helper function should start from b.Helper() (thelper)
func createProtocolBenchmarkConfigs(b *testing.B, logger *zap.Logger) []protocolBenchmarkConfig {
     ^
services/router/internal/direct/protocol_comparison_test.go:215:6: test helper function should start from b.Helper() (thelper)
func createProtocolSetups(b *testing.B, logger *zap.Logger) []struct {
     ^
services/router/internal/direct/protocol_comparison_test.go:312:6: test helper function should start from b.Helper() (thelper)
func runProtocolConnectionBenchmark(b *testing.B, protocol struct {
     ^
services/router/internal/direct/protocol_comparison_test.go:346:6: test helper function should start from b.Helper() (thelper)
func createConcurrencyBenchmarkConfigs(b *testing.B, logger *zap.Logger) []protocolBenchmarkConfig {
     ^
services/router/internal/direct/protocol_comparison_test.go:525:6: test helper function should start from b.Helper() (thelper)
func createPayloadBenchmarkProtocols(b *testing.B, logger *zap.Logger) []protocolBenchmarkConfig {
     ^
services/router/internal/direct/protocol_negotiation_advanced_test.go:498:6: test helper function should start from t.Helper() (thelper)
func runConcurrentDetectionWorker(t *testing.T, wg *sync.WaitGroup, manager *DirectClientManager, 
     ^
services/router/internal/direct/sse_client_test.go:940:6: test helper function should start from t.Helper() (thelper)
func launchSSEConcurrentWorkers(t *testing.T, wg *sync.WaitGroup, client *SSEClient, ctx context.Context, 
     ^
services/router/internal/direct/stdio_client_test.go:1282:6: test helper function should start from t.Helper() (thelper)
func launchStdioConcurrentWorkers(t *testing.T, wg *sync.WaitGroup, client *StdioClient, ctx context.Context,
     ^
services/router/internal/direct/websocket_client_test.go:636:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketPingPongServer(t *testing.T) (chan bool, chan bool, *httptest.Server) {
     ^
services/router/internal/direct/websocket_client_test.go:671:6: test helper function should start from t.Helper() (thelper)
func handleWebSocketPingPongMessages(t *testing.T, conn *websocket.Conn) {
     ^
services/router/internal/direct/websocket_client_test.go:690:6: test helper function should start from t.Helper() (thelper)
func processWebSocketPingPongMCPRequest(t *testing.T, conn *websocket.Conn, message []byte) {
     ^
services/router/internal/direct/websocket_client_test.go:706:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketPingPongClient(t *testing.T, logger *zap.Logger, server *httptest.Server) *WebSocketClient {
     ^
services/router/internal/direct/websocket_client_test.go:727:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketPingPongClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:733:6: test helper function should start from t.Helper() (thelper)
func runWebSocketPingPongTest(t *testing.T, client *WebSocketClient, pingReceived, pongReceived chan bool) {
     ^
services/router/internal/direct/websocket_client_test.go:741:6: test helper function should start from t.Helper() (thelper)
func sendWebSocketPingRequest(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:753:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketPingPongActivity(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:775:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketCorrelationServer(t *testing.T) *httptest.Server {
     ^
services/router/internal/direct/websocket_client_test.go:791:6: test helper function should start from t.Helper() (thelper)
func handleWebSocketCorrelationMessages(t *testing.T, conn *websocket.Conn) {
     ^
services/router/internal/direct/websocket_client_test.go:821:6: test helper function should start from t.Helper() (thelper)
func sendWebSocketCorrelationResponse(t *testing.T, conn *websocket.Conn, resp mcp.Response) {
     ^
services/router/internal/direct/websocket_client_test.go:828:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketCorrelationClient(t *testing.T, logger *zap.Logger, server *httptest.Server) *WebSocketClient {
     ^
services/router/internal/direct/websocket_client_test.go:850:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketCorrelationClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:856:6: test helper function should start from t.Helper() (thelper)
func runWebSocketCorrelationTest(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:881:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketCorrelationResponse(t *testing.T, resp *mcp.Response, expectedCorrelation string) {
     ^
services/router/internal/direct/websocket_client_test.go:932:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketConcurrentClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:938:6: test helper function should start from t.Helper() (thelper)
func runWebSocketConcurrentOperations(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:990:6: test helper function should start from t.Helper() (thelper)
func waitForWebSocketConcurrentCompletion(t *testing.T, wg *sync.WaitGroup) {
     ^
services/router/internal/direct/websocket_client_test.go:1052:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketReconnectServer(t *testing.T) (*webSocketReconnectServerState, *httptest.Server) {
     ^
services/router/internal/direct/websocket_client_test.go:1077:6: test helper function should start from t.Helper() (thelper)
func handleWebSocketReconnectConnection(t *testing.T, w http.ResponseWriter, r *http.Request, connectionCount int) {
     ^
services/router/internal/direct/websocket_client_test.go:1092:6: test helper function should start from t.Helper() (thelper)
func sendWebSocketReconnectAck(t *testing.T, conn *websocket.Conn, connectionCount int) {
     ^
services/router/internal/direct/websocket_client_test.go:1104:6: test helper function should start from t.Helper() (thelper)
func handleWebSocketReconnectMessages(t *testing.T, conn *websocket.Conn, connectionCount int) {
     ^
services/router/internal/direct/websocket_client_test.go:1132:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketReconnectClient(t *testing.T, logger *zap.Logger, server *httptest.Server) *WebSocketClient {
     ^
services/router/internal/direct/websocket_client_test.go:1155:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketReconnectClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1161:6: test helper function should start from t.Helper() (thelper)
func runWebSocketReconnectionTest(t *testing.T, client *WebSocketClient, serverState *webSocketReconnectServerState) {
     ^
services/router/internal/direct/websocket_client_test.go:1180:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketInitialConnection(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1185:6: test helper function should start from t.Helper() (thelper)
func sendWebSocketInitialRequest(t *testing.T, client *WebSocketClient, ctx context.Context) {
     ^
services/router/internal/direct/websocket_client_test.go:1209:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketReconnectionResult(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1266:6: test helper function should start from t.Helper() (thelper)
func runWebSocketPerformanceTest(t *testing.T, logger *zap.Logger, tc webSocketPerformanceTestCase) {
     ^
services/router/internal/direct/websocket_client_test.go:1303:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketPerformanceClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1309:6: test helper function should start from t.Helper() (thelper)
func executeWebSocketPerformanceRequests(t *testing.T, client *WebSocketClient) []time.Duration {
     ^
services/router/internal/direct/websocket_client_test.go:1378:6: test helper function should start from t.Helper() (thelper)
func runWebSocketFrameHandlingTest(t *testing.T, logger *zap.Logger, tc webSocketFrameTestCase) {
     ^
services/router/internal/direct/websocket_client_test.go:1388:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketFrameHandlingServer(t *testing.T, tc webSocketFrameTestCase) *httptest.Server {
     ^
services/router/internal/direct/websocket_client_test.go:1405:6: test helper function should start from t.Helper() (thelper)
func handleWebSocketFrameMessages(t *testing.T, conn *websocket.Conn, tc webSocketFrameTestCase) {
     ^
services/router/internal/direct/websocket_client_test.go:1436:6: test helper function should start from t.Helper() (thelper)
func sendWebSocketFrameResponse(t *testing.T, conn *websocket.Conn, resp mcp.Response) {
     ^
services/router/internal/direct/websocket_client_test.go:1470:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketFrameHandlingClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1476:6: test helper function should start from t.Helper() (thelper)
func executeWebSocketFrameHandlingTest(t *testing.T, client *WebSocketClient, tc webSocketFrameTestCase) {
     ^
services/router/internal/direct/websocket_client_test.go:1495:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketFrameResponse(t *testing.T, resp *mcp.Response, tc webSocketFrameTestCase, duration time.Duration) {
     ^
services/router/internal/direct/websocket_client_test.go:1580:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketErrorRecoveryServer(t *testing.T, serverErrorCount *int) *httptest.Server {
     ^
services/router/internal/direct/websocket_client_test.go:1584:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketErrorRecoveryClient(t *testing.T, logger *zap.Logger, server *httptest.Server) *WebSocketClient {
     ^
services/router/internal/direct/websocket_client_test.go:1610:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketErrorRecoveryClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1616:6: test helper function should start from t.Helper() (thelper)
func runWebSocketErrorRecoveryTests(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1638:6: test helper function should start from t.Helper() (thelper)
func executeWebSocketErrorRecoveryRequests(t *testing.T, client *WebSocketClient, testCases []struct {
     ^
services/router/internal/direct/websocket_client_test.go:1667:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketErrorRecoveryResults(t *testing.T, client *WebSocketClient, successCount, clientErrorCount int) {
     ^
services/router/internal/direct/websocket_client_test.go:1794:6: test helper function should start from b.Helper() (thelper)
func runWebSocketFrameSizeBenchmark(b *testing.B, logger *zap.Logger, frameSize int) {
     ^
services/router/internal/direct/websocket_client_test.go:1804:6: test helper function should start from b.Helper() (thelper)
func setupWebSocketFrameSizeBenchServer(b *testing.B, frameSize int) *httptest.Server {
     ^
services/router/internal/direct/websocket_client_test.go:1820:6: test helper function should start from b.Helper() (thelper)
func handleWebSocketFrameSizeBenchMessages(b *testing.B, conn *websocket.Conn, frameSize int) {
     ^
services/router/internal/direct/websocket_client_test.go:1846:6: test helper function should start from b.Helper() (thelper)
func setupWebSocketFrameSizeBenchClient(b *testing.B, logger *zap.Logger, server *httptest.Server) *WebSocketClient {
     ^
services/router/internal/direct/websocket_client_test.go:1869:6: test helper function should start from b.Helper() (thelper)
func cleanupWebSocketFrameSizeBenchClient(b *testing.B, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1875:6: test helper function should start from b.Helper() (thelper)
func executeWebSocketFrameSizeBenchmark(b *testing.B, client *WebSocketClient, frameSize int) {
     ^
services/router/internal/gateway/gateway_integration_advanced_test.go:453:6: test helper function should start from t.Helper() (thelper)
func createFailoverTestServer(t *testing.T, counters *serverCounters) *mockTCPServerBench {
     ^
services/router/internal/gateway/gateway_integration_advanced_test.go:507:6: test helper function should start from t.Helper() (thelper)
func startFailoverServer(t *testing.T, server *mockTCPServerBench) string {
     ^
services/router/internal/gateway/gateway_integration_advanced_test.go:524:6: test helper function should start from t.Helper() (thelper)
func runConcurrentFailoverTest(t *testing.T, cfg config.GatewayConfig, logger *zap.Logger) *clientCounters {
     ^
services/router/internal/gateway/gateway_integration_advanced_test.go:588:6: test helper function should start from t.Helper() (thelper)
func validateConcurrentFailoverResults(t *testing.T, serverCounters *serverCounters, clientCounters *clientCounters) {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:142:6: test helper function should start from t.Helper() (thelper)
func createLifecycleTestServer(t *testing.T, tracker *eventTracker) *mockTCPServer {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:239:6: test helper function should start from t.Helper() (thelper)
func startLifecycleServer(t *testing.T, server *mockTCPServer) string {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:247:6: test helper function should start from t.Helper() (thelper)
func createLifecycleTestClient(t *testing.T, addr string, logger *zap.Logger) *TCPClient {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:262:6: test helper function should start from t.Helper() (thelper)
func runLifecycleTest(t *testing.T, client *TCPClient) {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:293:6: test helper function should start from t.Helper() (thelper)
func validateLifecycleEvents(t *testing.T, tracker *eventTracker) {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:473:6: test helper function should start from t.Helper() (thelper)
func sendConcurrentRequest(t *testing.T, wg *sync.WaitGroup, client *TCPClient, id int, results chan<- int64) {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:499:6: test helper function should start from t.Helper() (thelper)
func extractCountFromResponse(t *testing.T, resp *mcp.Response, id int) int64 {
     ^
services/router/internal/pool/pool_test.go:779:6: test helper function should start from t.Helper() (thelper)
func runRapidAcquireReleaseCycles(t *testing.T, factory *mockFactory, logger *zap.Logger) {
     ^
services/router/internal/pool/pool_test.go:819:6: test helper function should start from t.Helper() (thelper)
func runConnectionFailureDuringOperations(t *testing.T, factory *mockFactory, logger *zap.Logger) {
     ^
services/router/internal/pool/pool_test.go:878:6: test helper function should start from t.Helper() (thelper)
func runReleaseInvalidConnectionTest(t *testing.T, factory *mockFactory, logger *zap.Logger) {
     ^
services/router/internal/pool/pool_test.go:912:6: test helper function should start from t.Helper() (thelper)
func runFactoryCreateErrorsTest(t *testing.T, factory *mockFactory, logger *zap.Logger) {
     ^
services/router/internal/pool/pool_test.go:951:6: test helper function should start from t.Helper() (thelper)
func runConcurrentCloseAndOperationsTest(t *testing.T, factory *mockFactory, logger *zap.Logger) {
     ^
services/router/internal/router/router_test.go:35:6: test helper function should start from t.Helper() (thelper)
func createNewRouterTests(t *testing.T) []struct {
     ^
services/router/internal/router/router_test.go:934:6: test helper function should start from b.Helper() (thelper)
func runBenchmarkLoop(b *testing.B, router *LocalRouter, request []byte) {
     ^
services/router/internal/direct/protocol_negotiation_advanced_test.go:737:6: TestAdvancedProtocolNegotiation_EdgeCases's subtests should call t.Parallel (tparallel)
func TestAdvancedProtocolNegotiation_EdgeCases(t *testing.T) {
     ^
services/router/internal/tracing/tracing_test.go:118:6: TestTracerOperations's subtests should call t.Parallel (tparallel)
func TestTracerOperations(t *testing.T) { 
     ^
services/router/internal/direct/protocol_negotiation_advanced_test.go:500:40: unnecessary leading newline (whitespace)
	successfulDetections, errors *int64) {
	                                      ^
services/router/internal/direct/sse_client_test.go:941:97: unnecessary leading newline (whitespace)
	numGoroutines, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
	                                                                                               ^
services/router/internal/direct/sse_client_test.go:950:95: unnecessary leading newline (whitespace)
	goroutineID, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
	                                                                                             ^
services/router/internal/direct/sse_client_test.go:1005:44: unnecessary leading newline (whitespace)
	numGoroutines, requestsPerGoroutine int) {
	                                          ^
services/router/internal/direct/stdio_client_test.go:1283:97: unnecessary leading newline (whitespace)
	numGoroutines, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
	                                                                                               ^
services/router/internal/direct/stdio_client_test.go:1292:95: unnecessary leading newline (whitespace)
	goroutineID, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
	                                                                                             ^
services/router/internal/direct/stdio_client_test.go:1347:44: unnecessary leading newline (whitespace)
	numGoroutines, requestsPerGoroutine int) {
	                                          ^
services/router/cmd/mcp-router/metrics_test.go:112:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	cfg, err := config.Load(configPath)
	^
services/router/cmd/mcp-router/metrics_test.go:126:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var metricsExporter *metrics.PrometheusExporter
	^
services/router/cmd/mcp-router/metrics_test.go:128:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	if !cfg.Metrics.Enabled || cfg.Metrics.Endpoint == "" {
	^
services/router/cmd/mcp-router/metrics_test.go:136:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go func() {
	^
services/router/cmd/mcp-router/metrics_test.go:138:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func() {
		^
services/router/cmd/mcp-router/setup_test.go:163:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		t.Cleanup(func() { _ = os.Unsetenv("MCP_AUTH_TOKEN") })
		^
services/router/cmd/mcp-router/setup_test.go:196:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err = yaml.Unmarshal(data, &cfg)
	^
services/router/cmd/mcp-router/update_test.go:108:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	t.Cleanup(func() { Version = oldVersion })
	^
services/router/cmd/mcp-router/update_test.go:133:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	t.Cleanup(func() { http.DefaultClient = oldClient })
	^
services/router/cmd/mcp-router/update_test.go:264:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if err := json.NewEncoder(w).Encode(tt.release); err != nil {
		^
services/router/cmd/mcp-router/update_test.go:277:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	t.Cleanup(func() { http.DefaultClient = oldClient })
	^
services/router/internal/config/config_integration_test.go:117:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	t.Cleanup(func() { _ = os.Unsetenv("JSON_TEST_TOKEN") })
	^
services/router/internal/config/config_integration_test.go:495:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	configData := createFormatTestConfigData()
	^
services/router/internal/config/config_integration_test.go:506:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	t.Cleanup(func() { _ = os.Unsetenv("FORMAT_TEST_TOKEN") })
	^
services/router/internal/config/config_integration_test.go:769:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer cleanupBenchmarkEnvironment()
	^
services/router/internal/config/config_test.go:212:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	origToken, tokenExists := os.LookupEnv("TEST_TOKEN")
	^
services/router/internal/direct/error_handling_test.go:301:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(context.Background()) }()
	^
services/router/internal/direct/http_client_test.go:872:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/http_client_test.go:984:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/manager_test.go:239:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	manager := setupProtocolDetectionManager(t, logger)
	^
services/router/internal/direct/manager_test.go:439:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	manager := setupValidURLsManager(t, logger)
	^
services/router/internal/direct/manager_test.go:1159:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/direct/manager_test.go:1407:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	manager := NewDirectClientManager(tc.config, logger)
	^
services/router/internal/direct/manager_test.go:1431:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(ctx) }()
	^
services/router/internal/direct/manager_test.go:1528:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if err != nil {
				^
services/router/internal/direct/manager_test.go:1610:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(ctx) }()
	^
services/router/internal/direct/manager_test.go:1717:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(ctx) }()
	^
services/router/internal/direct/manager_test.go:1777:3: missing whitespace above this line (too many statements above if) (wsl_v5)
		_, err := manager.GetClient(ctx, testURL)
		^
services/router/internal/direct/manager_test.go:1791:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(ctx) }()
	^
services/router/internal/direct/manager_test.go:1825:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRequests = 10
	^
services/router/internal/direct/manager_test.go:1828:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var wg sync.WaitGroup
	^
services/router/internal/direct/manager_test.go:1832:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func(id int) {
		^
services/router/internal/direct/manager_test.go:1834:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			testURL := fmt.Sprintf("echo pool-test-%d", id)
			^
services/router/internal/direct/manager_test.go:1835:4: missing whitespace above this line (too many statements above send) (wsl_v5)
			_, err := manager.GetClient(ctx, testURL)
			^
services/router/internal/direct/manager_test.go:1872:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(ctx) }()
	^
services/router/internal/direct/manager_test.go:2021:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	protocolTests := createProtocolCreationTestCases()
	^
services/router/internal/direct/manager_test.go:2124:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := DirectConfig{}
	^
services/router/internal/direct/manager_test.go:2134:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := DirectConfig{
	^
services/router/internal/direct/manager_test.go:2161:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := DirectConfig{}
	^
services/router/internal/direct/manager_test.go:2177:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := DirectConfig{
	^
services/router/internal/direct/memory_optimization_test.go:542:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/direct/memory_optimization_test.go:549:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	performMemoryIntensiveOperations(t, optimizer)
	^
services/router/internal/direct/memory_optimization_test.go:580:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numOperations = 1000
	^
services/router/internal/direct/memory_optimization_test.go:593:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	optimizer.PutBuffer(buf)
	^
services/router/internal/direct/memory_optimization_test.go:610:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = decoder.Decode(&decoded)
	^
services/router/internal/direct/memory_optimization_test.go:629:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numOperations = 1000
	^
services/router/internal/direct/protocol_comparison_test.go:257:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	client, err := NewHTTPClient("http-conn-bench", config.URL, config, logger)
	^
services/router/internal/direct/protocol_comparison_test.go:272:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	client, err := NewWebSocketClient("ws-conn-bench", config.URL, config, logger)
	^
services/router/internal/direct/protocol_comparison_test.go:287:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	client, err := NewSSEClient("sse-conn-bench", config.URL, config, logger)
	^
services/router/internal/direct/protocol_comparison_test.go:304:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	client, err := NewStdioClient("stdio-conn-bench", "stdio://python3 "+scriptPath, config, logger)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:441:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:474:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const (
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:501:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:525:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	totalDetections := int64(numWorkers * detectionsPerWorker)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:744:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:842:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = emptyManager.Stop(ctx) }()
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:963:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithTimeout(context.Background(), 60*time.Second)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:979:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numDetections = 1000
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:980:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithTimeout(context.Background(), 60*time.Second)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:984:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var (
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:991:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go runSingleDetection(t, &wg, manager, ctx, serverURL, i, &successCount)
		^
services/router/internal/direct/protocol_negotiation_advanced_test.go:1013:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	_, err := manager.DetectProtocol(ctx, testURL)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:1021:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRepeatedDetections = 100
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:1022:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithTimeout(context.Background(), 60*time.Second)
	^
services/router/internal/direct/sse_client_test.go:791:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	mockServer := newMockSSEServer()
	^
services/router/internal/direct/sse_client_test.go:798:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/direct/sse_client_test.go:811:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := SSEClientConfig{
	^
services/router/internal/direct/sse_client_test.go:827:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	start := time.Now()
	^
services/router/internal/direct/sse_client_test.go:835:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRequests = 10
	^
services/router/internal/direct/sse_client_test.go:836:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	requestTimes := make([]time.Duration, numRequests)
	^
services/router/internal/direct/sse_client_test.go:848:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		require.NoError(t, err)
		^
services/router/internal/direct/sse_client_test.go:875:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	client := setupSSEConcurrentClient(t, logger)
	^
services/router/internal/direct/sse_client_test.go:883:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	mockServer := newMockSSEServer()
	^
services/router/internal/direct/sse_client_test.go:884:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	t.Cleanup(func() { mockServer.close() })
	^
services/router/internal/direct/sse_client_test.go:912:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:919:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numGoroutines = 1
	^
services/router/internal/direct/sse_client_test.go:920:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const requestsPerGoroutine = 5
	^
services/router/internal/direct/sse_client_test.go:925:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:942:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/sse_client_test.go:945:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go runSSEConcurrentWorker(wg, client, ctx, g, requestsPerGoroutine, errChan, responseChan)
		^
services/router/internal/direct/sse_client_test.go:951:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/sse_client_test.go:973:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	done := make(chan struct{})
	^
services/router/internal/direct/sse_client_test.go:974:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/router/internal/direct/sse_client_test.go:1006:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/sse_client_test.go:1008:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	expectedCount := numGoroutines * requestsPerGoroutine
	^
services/router/internal/direct/sse_client_test.go:1131:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	server := httptest.NewServer(http.HandlerFunc(tc.serverBehavior))
	^
services/router/internal/direct/sse_client_test.go:1144:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/direct/sse_client_test.go:1154:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := SSEClientConfig{
	^
services/router/internal/direct/sse_client_test.go:1179:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server, toggleServer := setupReconnectionServer()
	^
services/router/internal/direct/sse_client_test.go:1196:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		enabled := serverEnabled
		^
services/router/internal/direct/sse_client_test.go:1197:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		serverMu.Unlock()
		^
services/router/internal/direct/sse_client_test.go:1227:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		serverEnabled = enabled
		^
services/router/internal/direct/sse_client_test.go:1228:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		serverMu.Unlock()
		^
services/router/internal/direct/sse_client_test.go:1236:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := SSEClientConfig{
	^
services/router/internal/direct/sse_client_test.go:1259:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:1330:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server := setupCompressionTestServer(t, tc.expectHeader)
	^
services/router/internal/direct/sse_client_test.go:1350:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			w.WriteHeader(http.StatusAccepted)
			^
services/router/internal/direct/sse_client_test.go:1357:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := SSEClientConfig{
	^
services/router/internal/direct/sse_client_test.go:1380:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:1402:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server, requestCounter := setupErrorRecoveryServer()
	^
services/router/internal/direct/sse_client_test.go:1428:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			w.WriteHeader(http.StatusAccepted)
			^
services/router/internal/direct/sse_client_test.go:1441:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := SSEClientConfig{
	^
services/router/internal/direct/sse_client_test.go:1462:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:1469:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:1489:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	metrics := client.GetMetrics()
	^
services/router/internal/direct/stdio_client_test.go:176:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:197:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:204:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:223:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	metrics := client.GetMetrics()
	^
services/router/internal/direct/stdio_client_test.go:407:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:429:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:527:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:551:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:558:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:574:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	result, ok := resp.Result.(map[string]interface{})
	^
services/router/internal/direct/stdio_client_test.go:632:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:654:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:661:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:677:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	result, ok := resp.Result.(map[string]interface{})
	^
services/router/internal/direct/stdio_client_test.go:783:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:801:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:810:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err := client.Connect(ctx)
	^
services/router/internal/direct/stdio_client_test.go:819:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	req := &mcp.Request{
	^
services/router/internal/direct/stdio_client_test.go:832:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err := client.Close(ctx)
	^
services/router/internal/direct/stdio_client_test.go:897:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:924:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:931:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:942:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	req := &mcp.Request{
	^
services/router/internal/direct/stdio_client_test.go:954:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	req := &mcp.Request{
	^
services/router/internal/direct/stdio_client_test.go:1025:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	client := setupStdioPerformanceClient(t, logger, scriptPath, tc.config)
	^
services/router/internal/direct/stdio_client_test.go:1029:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	time.Sleep(100 * time.Millisecond)
	^
services/router/internal/direct/stdio_client_test.go:1084:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:1100:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1107:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1116:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRequests = 20
	^
services/router/internal/direct/stdio_client_test.go:1117:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1225:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:1252:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1259:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const (
	^
services/router/internal/direct/stdio_client_test.go:1267:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1284:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/stdio_client_test.go:1287:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go runStdioConcurrentWorker(wg, client, ctx, g, requestsPerGoroutine, errChan, responseChan)
		^
services/router/internal/direct/stdio_client_test.go:1293:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/stdio_client_test.go:1315:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	done := make(chan struct{})
	^
services/router/internal/direct/stdio_client_test.go:1316:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/router/internal/direct/stdio_client_test.go:1348:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/stdio_client_test.go:1350:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	expectedCount := numGoroutines * requestsPerGoroutine
	^
services/router/internal/direct/stdio_client_test.go:1411:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	memoryOptimizer := createStdioMemoryOptimizer(logger)
	^
services/router/internal/direct/stdio_client_test.go:1463:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1470:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRequests = 50
	^
services/router/internal/direct/stdio_client_test.go:1471:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1490:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	metrics := client.GetMetrics()
	^
services/router/internal/direct/stdio_client_test.go:1553:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:1580:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1587:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1606:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	result, ok := resp.Result.(map[string]interface{})
	^
services/router/internal/direct/stdio_client_test.go:1692:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:1713:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1720:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	testCases := createStdioErrorTestCases()
	^
services/router/internal/direct/stdio_client_test.go:1746:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var successCount, errorCount int
	^
services/router/internal/direct/stdio_client_test.go:1747:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1878:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:1905:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1912:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1974:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:2005:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:2012:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/websocket_client.go:241:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if c.state != StateClosing && c.state != StateClosed {
		^
services/router/internal/direct/websocket_client.go:244:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		c.mu.Unlock()
		^
services/router/internal/direct/websocket_client_test.go:333:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	slowServer := setupWebSocketTimeoutServer(t)
	^
services/router/internal/direct/websocket_client_test.go:373:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := WebSocketClientConfig{
	^
services/router/internal/direct/websocket_client_test.go:394:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/websocket_client_test.go:401:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/websocket_client_test.go:418:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	metrics := client.GetMetrics()
	^
services/router/internal/direct/websocket_client_test.go:787:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		handleWebSocketCorrelationMessages(t, conn)
		^
services/router/internal/direct/websocket_client_test.go:858:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	expectedResponses := make(map[string]string, numRequests)
	^
services/router/internal/direct/websocket_client_test.go:959:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/websocket_client_test.go:964:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func(goroutineID int) {
		^
services/router/internal/direct/websocket_client_test.go:966:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			executeWebSocketConcurrentGoroutine(ctx, client, goroutineID, requestsPerGoroutine, errChan, responseChan)
			^
services/router/internal/direct/websocket_client_test.go:986:3: missing whitespace above this line (invalid statement above send) (wsl_v5)
		responseChan <- resp
		^
services/router/internal/direct/websocket_client_test.go:992:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/router/internal/direct/websocket_client_test.go:1086:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = conn.Close() }()
	^
services/router/internal/direct/websocket_client_test.go:1311:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	requestTimes := make([]time.Duration, numRequests)
	^
services/router/internal/direct/websocket_client_test.go:1399:3: missing whitespace above this line (no shared variables above defer) (wsl_v5)
		defer func() { _ = conn.Close() }()
		^
services/router/internal/direct/websocket_client_test.go:1571:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server := setupWebSocketErrorRecoveryServer(t, &serverErrorCount)
	^
services/router/internal/direct/websocket_client_test.go:1643:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/websocket_client_test.go:1655:4: missing whitespace above this line (no shared variables above expr) (wsl_v5)
			t.Logf("Expected error for %s: %v", tc.method, err)
			^
services/router/internal/direct/websocket_client_test.go:1814:3: missing whitespace above this line (no shared variables above defer) (wsl_v5)
		defer func() { _ = conn.Close() }()
		^
services/router/internal/direct/websocket_client_test.go:1881:3: missing whitespace above this line (no shared variables above for) (wsl_v5)
		for pb.Next() {
		^
services/router/internal/gateway/binary_frame_test.go:213:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	payload := []byte(`{"test":"data"}`)
	^
services/router/internal/gateway/binary_frame_test.go:217:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_, _ = buf.Write(payload)
	^
services/router/internal/gateway/client_mtls_test.go:408:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if tt.errorMsg != "" {
		^
services/router/internal/gateway/client_mtls_test.go:551:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if tt.errorMsg != "" {
		^
services/router/internal/gateway/client_test.go:208:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		tlsConfig.CAFile = caFile
		^
services/router/internal/gateway/client_test.go:322:3: missing whitespace above this line (too many statements above if) (wsl_v5)
		conn, err := upgrader.Upgrade(w, r, nil)
		^
services/router/internal/gateway/client_test.go:327:3: missing whitespace above this line (no shared variables above defer) (wsl_v5)
		defer func() { _ = conn.Close() }()
		^
services/router/internal/gateway/client_test.go:346:3: missing whitespace above this line (too many statements above if) (wsl_v5)
		conn, err := upgrader.Upgrade(w, r, nil)
		^
services/router/internal/gateway/client_test.go:350:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		_ = conn.Close()
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:366:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	addr, err := server.Start()
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:389:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		t.Fatalf("Failed to connect: %v", err)
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:391:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = client.Close() }()
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:399:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if tt.expectedSuccess {
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:424:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	addr := startFailoverServer(t, server)
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:460:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			_ = conn.Close()
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:470:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	frame, err := ReadBinaryFrame(reader)
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:474:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if frame.MessageType == MessageTypeVersionNegotiation {
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:483:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if frame.MessageType == MessageTypeRequest {
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:539:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func(goroutineID int) {
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:541:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			runGoroutineOperations(goroutineID, operationsPerGoroutine, cfg, logger, counters)
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:544:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	wg.Wait()
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:561:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = client.Close() }()
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:603:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if clientErrors == 0 {
	^
services/router/internal/gateway/tcp_client_advanced_test.go:110:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	addr := startLifecycleServer(t, server)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:150:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/gateway/tcp_client_advanced_test.go:219:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	pongFrame := &BinaryFrame{
	^
services/router/internal/gateway/tcp_client_advanced_test.go:225:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	tracker.addEvent("pong_sent")
	^
services/router/internal/gateway/tcp_client_advanced_test.go:230:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	respFrame := &BinaryFrame{
	^
services/router/internal/gateway/tcp_client_advanced_test.go:236:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	tracker.addEvent("response_sent")
	^
services/router/internal/gateway/tcp_client_advanced_test.go:295:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	events := tracker.getEvents()
	^
services/router/internal/gateway/tcp_client_advanced_test.go:300:3: missing whitespace above this line (no shared variables above range) (wsl_v5)
		for _, event := range events {
		^
services/router/internal/gateway/tcp_client_advanced_test.go:306:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if !found {
		^
services/router/internal/gateway/tcp_client_advanced_test.go:315:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var requestCount int64
	^
services/router/internal/gateway/tcp_client_advanced_test.go:318:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	addr := startServerOrFail(t, server)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:325:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	results := runConcurrentRequests(t, client, numRequests)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:461:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	results := make(chan int64, numRequests)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:465:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go sendConcurrentRequest(t, &wg, client, i, results)
		^
services/router/internal/gateway/tcp_client_advanced_test.go:626:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	addr := startServerOrFail(t, server)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:630:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = client.Close() }()
	^
services/router/internal/metrics/prometheus_test.go:274:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	exporter.SetRouterMetrics(func() *RouterMetrics { return testMetrics })
	^
services/router/internal/metrics/prometheus_test.go:278:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(testIterations * time.Millisecond)
	^
services/router/internal/metrics/prometheus_test.go:314:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = resp.Body.Close() }()
	^
services/router/internal/pool/pool_test.go:788:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/pool/pool_test.go:800:3: missing whitespace above this line (no shared variables above for) (wsl_v5)
		for j := 0; j < 3; j++ {
		^
services/router/internal/pool/pool_test.go:828:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/pool/pool_test.go:882:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/pool/pool_test.go:897:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = otherPool.Close() }()
	^
services/router/internal/pool/pool_test.go:920:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/pool/pool_test.go:961:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var wg sync.WaitGroup
	^
services/router/internal/pool/pool_test.go:962:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	stopChan := make(chan struct{})
	^
services/router/internal/pool/pool_test.go:967:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func() {
		^
services/router/internal/pool/pool_test.go:969:4: missing whitespace above this line (invalid statement above for) (wsl_v5)
			for {
			^
services/router/internal/pool/pool_test.go:979:6: missing whitespace above this line (invalid statement above expr) (wsl_v5)
					time.Sleep(time.Millisecond)
					^
services/router/internal/pool/pool_test.go:980:6: missing whitespace above this line (invalid statement above assign) (wsl_v5)
					_ = pool.Release(conn)
					^
services/router/internal/router/gateway_fallback_integration_test.go:67:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	mockClients.gwClient.sendRequestFunc = func(req *mcp.Request) error {
	^
services/router/internal/router/gateway_fallback_integration_test.go:155:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ticker := time.NewTicker(10 * time.Millisecond)
	^
services/router/internal/router/gateway_fallback_integration_test.go:197:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var totalLatency time.Duration
	^
services/router/internal/router/router_integration_test.go:70:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	waitForConnection(t, router)
	^
services/router/internal/router/router_integration_test.go:74:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	monitorForResponse(t, router, responseReceived, done)
	^
services/router/internal/router/router_test.go:293:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		func() { _ = router.Run(ctx) }()
		^
services/router/internal/router/router_test.go:317:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ticker := time.NewTicker(constants.TestTickInterval)
	^
services/router/internal/router/router_test.go:652:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		func() { _ = router.Run(ctx) }()
		^
services/router/internal/router/router_test.go:908:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		func() { _ = router.Run(ctx) }()
		^
services/router/internal/router/router_test.go:1051:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		_ = router.Run(ctx)
		^
services/router/internal/router/router_test.go:1077:7: missing whitespace above this line (invalid statement above assign) (wsl_v5)
						receivedResponses[idStr] = true
						^
services/router/internal/router/router_test.go:1078:7: missing whitespace above this line (no shared variables above expr) (wsl_v5)
						responseMu.Unlock()
						^
services/router/internal/router/router_test.go:1118:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			received := receivedResponses[id]
			^
services/router/internal/router/router_test.go:1119:4: missing whitespace above this line (no shared variables above expr) (wsl_v5)
			responseMu.Unlock()
			^
services/router/internal/router/router_test.go:1131:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		received := receivedResponses[id]
		^
services/router/internal/router/router_test.go:1132:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		responseMu.Unlock()
		^
services/router/internal/router/router_test.go:1374:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/router/router_test.go:1451:3: missing whitespace above this line (invalid statement above for) (wsl_v5)
		for {
		^
services/router/internal/router/router_test.go:1547:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/router/router_test.go:1934:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/router/internal/router/router_test.go:1970:3: missing whitespace above this line (too many statements above if) (wsl_v5)
		conn, err := upgrader.Upgrade(w, r, nil)
		^
services/router/internal/router/router_test.go:1974:3: missing whitespace above this line (no shared variables above defer) (wsl_v5)
		defer func() { _ = conn.Close() }()
		^
services/router/internal/router/router_test.go:2056:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			(*responsesReceived)[idStr] = true
			^
services/router/internal/router/router_test.go:2057:4: missing whitespace above this line (no shared variables above expr) (wsl_v5)
			responseMu.Unlock()
			^
services/router/internal/router/router_test.go:2398:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	waitForRouterConnection(t, router)
	^
services/router/internal/router/router_test.go:2510:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	methodCount := len(directOnlyMethods)
	^
services/router/internal/router/router_test.go:2589:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var gatewayRequests int32
	^
services/router/internal/router/router_test.go:2595:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/router/internal/router/router_test.go:2599:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	waitForRouterConnection(t, router)
	^
services/router/internal/router/router_test.go:2706:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	decisions := make(map[string]int32)
	^
services/router/internal/router/router_test.go:2710:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	decisionMu.Unlock()
	^
services/router/internal/router/router_test.go:2751:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/router/internal/router/router_test.go:2760:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		func() { _ = router.Run(ctx) }()
		^
services/router/internal/router/router_test.go:2814:4: missing whitespace above this line (invalid statement above if) (wsl_v5)
			if methodStr, ok := method.(string); ok {
			^
services/router/internal/router/router_test.go:2817:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			protocolMu.Unlock()
			^
services/router/internal/secure/credential_security_test.go:498:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	keys := storeMultipleSmallTokens(t, store, numKeys)
	^
services/router/internal/secure/credential_security_test.go:583:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	largeToken := strings.Repeat("x", largeTokenSize)
	^
services/router/internal/secure/encrypted_file_store.go:167:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
		
^
services/router/internal/secure/encrypted_file_store.go:175:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
		
^
services/router/internal/secure/keychain_store_darwin.go:306:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, r := range decodedStr {
	^
services/router/internal/secure/keychain_store_darwin.go:329:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, b := range decoded {
	^
services/router/internal/secure/keychain_store_darwin.go:343:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, r := range decodedStr {
	^
services/router/internal/stdio/handler_test.go:152:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	done := make(chan bool)
	^
services/router/internal/stdio/handler_test.go:162:5: missing whitespace above this line (invalid statement above assign) (wsl_v5)
				received = append(received, string(msg))
				^
services/router/internal/stdio/handler_test.go:349:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	writer := bufio.NewWriter(&outputBuf)
	^
services/router/internal/tracing/tracing_test.go:122:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = tracer.Shutdown(context.Background()) }()
	^
services/router/internal/tracing/tracing_test.go:206:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	spanCtx, span := tracer.StartSpan(ctx, "test-attributes")
	^
services/router/internal/tracing/tracing_test.go:223:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	spanCtx, span := tracer.StartSpan(ctx, "test-events")
	^
services/router/internal/tracing/tracing_test.go:234:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	spanCtx, span := tracer.StartSpan(ctx, "test-error")
	^
services/router/internal/tracing/tracing_test.go:283:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for k := range headers {
	^
services/router/internal/tracing/tracing_test.go:289:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	assert.True(t, found, "traceparent header not found")
	^
781 issues:
* bodyclose: 1
* contextcheck: 11
* funlen: 44
* gocritic: 2
* godot: 7
* gosec: 30
* ireturn: 74
* lll: 51
* nestif: 3
* nilerr: 2
* nlreturn: 173
* prealloc: 4
* thelper: 76
* tparallel: 2
* whitespace: 7
* wsl_v5: 294
Module router: 781 issues found
services/router/internal/direct/websocket_client.go:172:39: response body must be closed (bodyclose)
	conn, _, err := c.establishConnection(ctx, dialer, headers)
	                                     ^
services/router/cmd/mcp-router/metrics_test.go:123:20: Function `New->initializeComponents->NewGatewayClientWithPool->NewPoolClient->NewGatewayPool` should pass the context parameter (contextcheck)
	r, _ := router.New(cfg, logger)
	                  ^
services/router/internal/direct/manager.go:637:32: Function `createClient->createHTTPClient->NewHTTPClientWithMemoryOptimizer->CreateOptimizedHTTPClient->Build->createClient` should pass the context parameter (contextcheck)
		client, err := m.createClient(serverURL, protocol) 
		                             ^
services/router/internal/direct/protocol_negotiation_advanced_test.go:836:49: Function `NewDirectClientManager->BuildClientOrchestrator->createInfrastructureComponents->NewConnectionPool->startBackgroundTasks->startBackgroundTasks$2->performHealthChecks` should pass the context parameter (contextcheck)
	emptyManagerInterface := NewDirectClientManager(emptyConfig, logger)
	                                               ^
services/router/internal/direct/stdio_client.go:311:6: Function `restartProcess` should pass the context parameter (contextcheck)
					go c.restartProcess() 
					^
services/router/internal/direct/websocket_client.go:149:2: Function `readMessages->ReadMessageLoop->readSingleMessage->handleReadError->handleClosedConnection->attemptReconnection->reconnect` should pass the context parameter (contextcheck)
	go c.readMessages() 
	^
services/router/internal/direct/websocket_client.go:396:6: Function `reconnect` should pass the context parameter (contextcheck)
					go c.reconnect() 
					^
services/router/internal/gateway/tcp_client_advanced_test.go:669:26: Function `SendRequest` should pass the context parameter (contextcheck)
	err = client.SendRequest(req)
	                        ^
services/router/internal/metrics/prometheus.go:238:30: Non-inherited new context, use function like `context.WithXXX` instead (contextcheck)
		if err := e.server.Shutdown(shutdownCtx); err != nil {
		                           ^
services/router/internal/patterns/handler_pattern.go:352:25: Function `isConnectionValid` should pass the context parameter (contextcheck)
		if m.isConnectionValid(conn) { 
		                      ^
services/router/internal/router/router.go:286:17: Function `Start->maintainConnection->connect` should pass the context parameter (contextcheck)
	r.connMgr.Start() 
	               ^
services/router/internal/router/router.go:287:19: Function `Start->handleStdinToWS->processStdinMessage->processStdinMessageDirect->processRequestWithFallback->attemptDirectWithRetries` should pass the context parameter (contextcheck)
	r.msgRouter.Start() 
	                 ^
services/router/internal/direct/stdio_client_test.go:703:6: Function 'createStdioLifecycleScript' is too long (75 > 60) (funlen)
func createStdioLifecycleScript(t *testing.T) string {
     ^
services/router/internal/gateway/client_test.go:540:6: Function 'TestClient_SendRequest' is too long (80 > 60) (funlen)
func TestClient_SendRequest(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:707:6: Function 'TestClient_ReceiveResponse' is too long (74 > 60) (funlen)
func TestClient_ReceiveResponse(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:791:6: Function 'TestClient_ReceiveResponse_InvalidPayload' is too long (62 > 60) (funlen)
func TestClient_ReceiveResponse_InvalidPayload(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:862:6: Function 'TestClient_SendPing' is too long (68 > 60) (funlen)
func TestClient_SendPing(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:940:6: Function 'TestClient_Close' is too long (70 > 60) (funlen)
func TestClient_Close(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1072:6: Function 'TestClient_ConcurrentOperations' is too long (81 > 60) (funlen)
func TestClient_ConcurrentOperations(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1205:6: Function 'BenchmarkClient_SendRequest' is too long (66 > 60) (funlen)
func BenchmarkClient_SendRequest(b *testing.B) {
     ^
services/router/internal/gateway/client_test.go:1281:6: Function 'TestClient_Connect_ErrorScenarios' is too long (91 > 60) (funlen)
func TestClient_Connect_ErrorScenarios(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1381:6: Function 'TestClient_NetworkFailures' is too long (66 > 60) (funlen)
func TestClient_NetworkFailures(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1460:6: Function 'TestClient_AuthenticationEdgeCases' is too long (114 > 60) (funlen)
func TestClient_AuthenticationEdgeCases(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1743:6: Function 'TestClient_ConnectionLifecycle' is too long (63 > 60) (funlen)
func TestClient_ConnectionLifecycle(t *testing.T) { 
     ^
services/router/internal/gateway/client_test.go:1818:6: Function 'TestClient_MalformedMessages' is too long (61 > 60) (funlen)
func TestClient_MalformedMessages(t *testing.T) { 
     ^
services/router/internal/gateway/factory_test.go:16:6: Function 'TestNewGatewayClient' is too long (125 > 60) (funlen)
func TestNewGatewayClient(t *testing.T) { 
     ^
services/router/internal/gateway/factory_test.go:226:6: Function 'setupMTLSCerts' is too long (62 > 60) (funlen)
func setupMTLSCerts(t *testing.T) (certFile, keyFile string, cleanup func()) {
     ^
services/router/internal/gateway/factory_test.go:291:6: Function 'TestGatewayClient_AuthConfiguration' is too long (72 > 60) (funlen)
func TestGatewayClient_AuthConfiguration(t *testing.T) { 
     ^
services/router/internal/gateway/factory_test.go:369:6: Function 'TestGatewayClient_TLSConfiguration' is too long (71 > 60) (funlen)
func TestGatewayClient_TLSConfiguration(t *testing.T) { 
     ^
services/router/internal/gateway/gateway_integration_advanced_test.go:109:6: Function 'runLoadBalancingClients' is too long (62 > 60) (funlen)
func runLoadBalancingClients(t *testing.T, addresses []string, numClients, requestsPerClient int, logger *zap.Logger) {
     ^
services/router/internal/gateway/namespace_router_test.go:451:6: Function 'TestNamespaceRouter_MultipleMatches' is too long (67 > 60) (funlen)
func TestNamespaceRouter_MultipleMatches(t *testing.T) { 
     ^
services/router/internal/gateway/oauth2_test.go:366:6: Function 'TestOAuth2Client_ErrorHandling' is too long (66 > 60) (funlen)
func TestOAuth2Client_ErrorHandling(t *testing.T) {
     ^
services/router/internal/gateway/oauth2_test.go:435:6: Function 'TestOAuth2Client_ConcurrentAccess' is too long (67 > 60) (funlen)
func TestOAuth2Client_ConcurrentAccess(t *testing.T) {
     ^
services/router/internal/gateway/pool_test.go:16:6: Function 'TestNewGatewayPool' is too long (89 > 60) (funlen)
func TestNewGatewayPool(t *testing.T) { 
     ^
services/router/internal/gateway/pool_test.go:109:6: Function 'TestGatewayPool_LoadBalancing' is too long (69 > 60) (funlen)
func TestGatewayPool_LoadBalancing(t *testing.T) { 
     ^
services/router/internal/gateway/pool_test.go:229:6: Function 'TestGatewayPool_GetEndpointByTags' is too long (86 > 60) (funlen)
func TestGatewayPool_GetEndpointByTags(t *testing.T) { 
     ^
services/router/internal/gateway/tcp_client_test.go:100:6: Function 'echoHandler' is too long (79 > 60) (funlen)
func echoHandler(conn net.Conn) {
     ^
services/router/internal/gateway/tcp_client_test.go:188:6: Function 'TestTCPClient_Connect' is too long (81 > 60) (funlen)
func TestTCPClient_Connect(t *testing.T) { 
     ^
services/router/internal/gateway/tcp_client_test.go:273:6: Function 'TestTCPClient_SendRequest' is too long (72 > 60) (funlen)
func TestTCPClient_SendRequest(t *testing.T) { 
     ^
services/router/internal/metrics/prometheus_test.go:363:6: Function 'TestPrometheusExporter_ResponseSizeHistogram' is too long (67 > 60) (funlen)
func TestPrometheusExporter_ResponseSizeHistogram(t *testing.T) { 
     ^
services/router/internal/metrics/prometheus_test.go:441:6: Function 'TestPrometheusExporter_ConcurrentAccess' is too long (73 > 60) (funlen)
func TestPrometheusExporter_ConcurrentAccess(t *testing.T) { 
     ^
services/router/internal/pool/manager_test.go:20:6: Function 'TestNewPooledGatewayClient' is too long (77 > 60) (funlen)
func TestNewPooledGatewayClient(t *testing.T) { 
     ^
services/router/internal/pool/pool_test.go:87:6: Function 'TestNewPool' is too long (77 > 60) (funlen)
func TestNewPool(t *testing.T) { 
     ^
services/router/internal/pool/pool_test.go:680:6: Function 'TestPoolConnectionLifecycle' is too long (71 > 60) (funlen)
func TestPoolConnectionLifecycle(t *testing.T) { 
     ^
services/router/internal/pool/pool_test.go:1069:6: Function 'TestPoolMaintenance' is too long (88 > 60) (funlen)
func TestPoolMaintenance(t *testing.T) { 
     ^
services/router/internal/pool/statistics_test.go:15:6: Function 'TestPoolStatisticsAccounting' has too many statements (47 > 40) (funlen)
func TestPoolStatisticsAccounting(t *testing.T) { 
     ^
services/router/internal/ratelimit/ratelimit_test.go:633:6: Function 'TestSlidingWindowLimiter_EdgeCases' is too long (67 > 60) (funlen)
func TestSlidingWindowLimiter_EdgeCases(t *testing.T) { 
     ^
services/router/internal/ratelimit/ratelimit_test.go:742:6: Function 'TestRateLimiter_UnderHighLoad' is too long (68 > 60) (funlen)
func TestRateLimiter_UnderHighLoad(t *testing.T) { 
     ^
services/router/internal/router/router_test.go:1142:6: Function 'TestMessageRouter_ConnectionStateHandling' is too long (80 > 60) (funlen)
func TestMessageRouter_ConnectionStateHandling(t *testing.T) { 
     ^
services/router/internal/router/router_test.go:1561:6: Function 'TestMessageRouter_RequestTimeout' is too long (61 > 60) (funlen)
func TestMessageRouter_RequestTimeout(t *testing.T) { 
     ^
services/router/internal/router/router_test.go:1632:6: Function 'TestMessageRouter_MetricsCollection' is too long (79 > 60) (funlen)
func TestMessageRouter_MetricsCollection(t *testing.T) { 
     ^
services/router/internal/router/router_test.go:2900:6: Function 'BenchmarkRouter_ConcurrentRequests' is too long (64 > 60) (funlen)
func BenchmarkRouter_ConcurrentRequests(b *testing.B) {
     ^
services/router/internal/router/router_test.go:2973:6: Function 'BenchmarkRouter_LargePayloads' is too long (68 > 60) (funlen)
func BenchmarkRouter_LargePayloads(b *testing.B) {
     ^
services/router/internal/secure/credential_security_test.go:88:6: Function 'testMemoryCorruptionProtection' is too long (65 > 60) (funlen)
func testMemoryCorruptionProtection(t *testing.T, store TokenStore) {
     ^
services/router/internal/secure/credential_security_test.go:165:6: Function 'testConcurrentAccessSafety' is too long (62 > 60) (funlen)
func testConcurrentAccessSafety(t *testing.T, store TokenStore) {
     ^
services/router/internal/secure/credential_security_test.go:240:6: Function 'testInjectionAttackProtection' is too long (80 > 60) (funlen)
func testInjectionAttackProtection(t *testing.T, store TokenStore) {
     ^
services/router/internal/health/checker.go:251:2: ifElseChain: rewrite if-else to switch statement (gocritic)
	if totalEndpoints == 0 { 
	^
services/router/internal/secure/credential_security_comprehensive_test.go:636:2: ifElseChain: rewrite if-else to switch statement (gocritic)
	if errors.Is(err, ErrListNotSupported) {
	^
services/router/internal/constants/timeouts_test.go:556:1: Comment should end in a period (godot)
// Helper functions for TestConnectionPoolTimeouts
^
services/router/internal/constants/timeouts_test.go:654:1: Comment should end in a period (godot)
// Helper functions for TestTimeoutConsistency
^
services/router/internal/direct/connection_pool_test.go:832:1: Comment should end in a period (godot)
// Helper functions for TestConnectionPool_ConcurrentAccess
^
services/router/internal/direct/connection_pool_test.go:921:1: Comment should end in a period (godot)
// Helper functions for TestConnectionPool_StressTest
^
services/router/internal/direct/error_handling_test.go:409:1: Comment should end in a period (godot)
// Helper functions for createConnectionFailureTests
^
services/router/internal/direct/error_handling_test.go:507:1: Comment should end in a period (godot)
// Helper functions for runConcurrentRequestsTest
^
services/router/internal/direct/error_handling_test.go:602:1: Comment should end in a period (godot)
// Helper functions for createErrorRecoveryTests
^
services/router/cmd/mcp-router/main.go:232:3: G101: Potential hardcoded credentials (gosec)
		tokenEnv = "MCP_AUTH_TOKEN" 
		^
services/router/internal/config/config_test.go:1498:5: G101: Potential hardcoded credentials (gosec)
	if token != "secure-env-token-123" { 
	   ^
services/router/internal/direct/adaptive_request_handler.go:224:17: G115: integer overflow conversion uint64 -> int64 (gosec)
		count := int64(u.metrics.RequestCount) 
		              ^
services/router/internal/direct/http_client_test.go:1054:24: G115: integer overflow conversion int -> uint64 (gosec)
	assert.Equal(t, uint64(numGoroutines*requestsPerGoroutine), metrics.RequestCount)
	                      ^
services/router/internal/direct/protocol_comparison_test.go:783:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	return os.WriteFile(filename, []byte(content), 0o755) 
	       ^
services/router/internal/direct/retry.go:208:8: G404: Use of weak random number generator (math/rand or math/rand/v2 instead of crypto/rand) (gosec)
		rng: rand.New(rand.NewSource(time.Now().UnixNano())), 
		     ^
services/router/internal/direct/sse_client_test.go:1014:24: G115: integer overflow conversion int -> uint64 (gosec)
	assert.Equal(t, uint64(expectedCount), metrics.RequestCount)
	                      ^
services/router/internal/direct/stdio_client_test.go:169:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:266:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755) 
	       ^
services/router/internal/direct/stdio_client_test.go:400:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:520:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:625:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:776:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:890:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1077:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1218:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1356:24: G115: integer overflow conversion int -> uint64 (gosec)
	assert.Equal(t, uint64(expectedCount), metrics.RequestCount)
	                      ^
services/router/internal/direct/stdio_client_test.go:1404:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1491:24: G115: integer overflow conversion int -> uint64 (gosec)
	assert.Equal(t, uint64(expectedRequests), metrics.RequestCount)
	                      ^
services/router/internal/direct/stdio_client_test.go:1546:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1685:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1785:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755) 
	       ^
services/router/internal/direct/stdio_client_test.go:1871:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_client_test.go:1967:9: G306: Expect WriteFile permissions to be 0600 or less (gosec)
	err := os.WriteFile(scriptPath, []byte(scriptContent), 0o755)
	       ^
services/router/internal/direct/stdio_process_builder.go:66:10: G204: Subprocess launched with a potential tainted input or cmd arguments (gosec)
	b.cmd = exec.CommandContext(ctx, b.client.config.Command[0], b.client.config.Command[1:]...) 
	        ^
services/router/internal/direct/websocket_client_test.go:1028:24: G115: integer overflow conversion int -> uint64 (gosec)
	assert.Equal(t, uint64(numGoroutines*requestsPerGoroutine), metrics.RequestCount)
	                      ^
services/router/internal/router/router_test.go:1513:51: G115: integer overflow conversion int -> int32 (gosec)
			if atomic.LoadInt32(responsesReceived) >= int32(numRequests) {
			                                               ^
services/router/internal/secure/keychain_store_darwin.go:140:10: G204: Subprocess launched with variable (gosec)
		cmd := exec.CommandContext(ctx, "security", "add-generic-password",
			"-a", key, // account name
			"-s", serviceName, // service name
			"-w", token, // password
			"-U") // update if exists
services/router/internal/secure/keychain_store_darwin.go:168:10: G204: Subprocess launched with variable (gosec)
		cmd := exec.CommandContext(ctx, "security", "find-generic-password",
			"-a", key, // account name
			"-s", serviceName, // service name
			"-w") // return password only
services/router/internal/secure/keychain_store_darwin.go:215:10: G204: Subprocess launched with variable (gosec)
		cmd := exec.CommandContext(ctx, "security", "delete-generic-password",
			"-a", key, // account name
			"-s", serviceName) // service name
services/router/internal/direct/error_handling_test.go:508:1: setupConcurrentTestManager returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func setupConcurrentTestManager(t *testing.T) DirectClientManagerInterface {
^
services/router/internal/direct/manager.go:452:1: NewDirectClientManager returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func NewDirectClientManager(config DirectConfig, logger *zap.Logger) DirectClientManagerInterface {
^
services/router/internal/direct/manager.go:525:1: GetClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) GetClient(ctx context.Context, serverURL string) (DirectClient, error) {
^
services/router/internal/direct/manager.go:614:1: getOrCreateClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) getOrCreateClient(
^
services/router/internal/direct/manager.go:709:1: createClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) createClient(serverURL string, protocol ClientType) (DirectClient, error) {
^
services/router/internal/direct/manager.go:726:1: createStdioClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) createStdioClient(serverURL string) (DirectClient, error) {
^
services/router/internal/direct/manager.go:773:1: createWebSocketClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) createWebSocketClient(serverURL string) (DirectClient, error) {
^
services/router/internal/direct/manager.go:821:1: createHTTPClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) createHTTPClient(serverURL string) (DirectClient, error) {
^
services/router/internal/direct/manager.go:868:1: createSSEClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (m *DirectClientManager) createSSEClient(serverURL string) (DirectClient, error) {
^
services/router/internal/direct/manager_builder.go:148:1: BuildClientOrchestrator returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func (b *DirectManagerConfigurationBuilder) BuildClientOrchestrator() DirectClientManagerInterface {
^
services/router/internal/direct/manager_test.go:246:1: setupProtocolDetectionManager returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func setupProtocolDetectionManager(t *testing.T, logger *zap.Logger) DirectClientManagerInterface {
^
services/router/internal/direct/manager_test.go:446:1: setupValidURLsManager returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func setupValidURLsManager(t *testing.T, logger *zap.Logger) DirectClientManagerInterface {
^
services/router/internal/direct/manager_test.go:1437:1: setupErrorHandlingTestManager returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClientManagerInterface) (ireturn)
func setupErrorHandlingTestManager(t *testing.T) DirectClientManagerInterface {
^
services/router/internal/direct/protocol_comparison_test.go:62:1: setupHTTPBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupHTTPBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:87:1: setupWebSocketBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupWebSocketBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:112:1: setupSSEBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupSSEBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:136:1: setupStdioBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupStdioBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:250:1: setupHTTPBenchmarkClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupHTTPBenchmarkClient(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:265:1: setupWebSocketBenchmarkClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupWebSocketBenchmarkClient(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:280:1: setupSSEBenchmarkClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupSSEBenchmarkClient(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:295:1: setupStdioBenchmarkClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupStdioBenchmarkClient(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:367:1: setupHTTPConcurrencyBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupHTTPConcurrencyBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:390:1: setupWebSocketConcurrencyBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupWebSocketConcurrencyBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:412:1: setupSSEConcurrencyBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupSSEConcurrencyBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:434:1: setupStdioConcurrencyBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupStdioConcurrencyBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:546:1: setupHTTPPayloadBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupHTTPPayloadBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:568:1: setupWebSocketPayloadBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupWebSocketPayloadBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:591:1: setupSSEPayloadBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupSSEPayloadBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/direct/protocol_comparison_test.go:613:1: setupStdioPayloadBenchmark returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func setupStdioPayloadBenchmark(b *testing.B, logger *zap.Logger) (DirectClient, func()) {
^
services/router/internal/gateway/factory.go:33:1: NewGatewayClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func NewGatewayClient(cfg config.GatewayConfig, logger *zap.Logger) (GatewayClient, error) {
^
services/router/internal/gateway/factory.go:53:1: NewGatewayClientWithPool returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func NewGatewayClientWithPool(cfg *config.Config, logger *zap.Logger) (GatewayClient, error) {
^
services/router/internal/gateway/pool.go:216:1: wrapWithCircuitBreakerIfEnabled returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func wrapWithCircuitBreakerIfEnabled( 
^
services/router/internal/patterns/handler_pattern.go:341:1: EstablishManagedConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/patterns.Connection) (ireturn)
func (m *ConnectionManager) EstablishManagedConnection(
^
services/router/internal/patterns/handler_pattern.go:370:1: establishNewConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/patterns.Connection) (ireturn)
func (m *ConnectionManager) establishNewConnection(ctx context.Context, config ConnectionConfig) (Connection, error) {
^
services/router/internal/pool/connection_acquirer.go:24:1: AcquireConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (a *ConnectionAcquirer) AcquireConnection(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/connection_acquirer.go:73:1: tryGetIdleConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (a *ConnectionAcquirer) tryGetIdleConnection() Connection {
^
services/router/internal/pool/connection_acquirer.go:100:1: tryCreateNewConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (a *ConnectionAcquirer) tryCreateNewConnection(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/connection_acquirer.go:126:1: waitForConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (a *ConnectionAcquirer) waitForConnection(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/connection_acquirer.go:162:1: WaitForConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (w *ConnectionWaiter) WaitForConnection() (Connection, error) {
^
services/router/internal/pool/connection_acquirer.go:175:1: handleReceivedConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (w *ConnectionWaiter) handleReceivedConnection(conn *pooledConn) (Connection, error) {
^
services/router/internal/pool/generic_connection.go:70:1: GetClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func (c *GenericConnection) GetClient() gateway.GatewayClient {
^
services/router/internal/pool/generic_connection.go:107:1: Create returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (f *GenericFactory) Create(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/manager.go:72:1: acquireConnection returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (p *PooledGatewayClient) acquireConnection(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/pool.go:323:1: Acquire returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (p *Pool) Acquire(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/pool_acquire_test.go:83:1: Create returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (tf *testFactory) Create(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/pool_test.go:69:1: Create returns interface (github.com/poiley/mcp-bridge/services/router/internal/pool.Connection) (ireturn)
func (f *mockFactory) Create(ctx context.Context) (Connection, error) {
^
services/router/internal/pool/tcp_pool.go:11:1: createTCPClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func createTCPClient(cfg config.GatewayConfig, logger *zap.Logger) (gateway.GatewayClient, error) {
^
services/router/internal/pool/websocket_pool.go:11:1: createWebSocketClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/gateway.GatewayClient) (ireturn)
func createWebSocketClient(cfg config.GatewayConfig, logger *zap.Logger) (gateway.GatewayClient, error) {
^
services/router/internal/ratelimit/ratelimit.go:289:1: NewRateLimiter returns interface (github.com/poiley/mcp-bridge/services/router/internal/ratelimit.RateLimiter) (ireturn)
func NewRateLimiter(ratePerSecond float64, burst int, logger *zap.Logger) RateLimiter {
^
services/router/internal/router/gateway_fallback_integration_test.go:396:1: GetClient returns interface (github.com/poiley/mcp-bridge/services/router/internal/direct.DirectClient) (ireturn)
func (t *TestDirectManager) GetClient(ctx context.Context, serverURL string) (direct.DirectClient, error) {
^
services/router/internal/secure/credential_security_comprehensive_test.go:96:1: setupMaliciousInputTestStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupMaliciousInputTestStore(t *testing.T, tempDir string) TokenStore {
^
services/router/internal/secure/credential_security_comprehensive_test.go:251:1: setupFileSystemSecurityTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupFileSystemSecurityTest(t *testing.T, tempDir string) (TokenStore, *encryptedFileStore) {
^
services/router/internal/secure/credential_security_comprehensive_test.go:402:1: setupRaceConditionTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupRaceConditionTest(t *testing.T) TokenStore {
^
services/router/internal/secure/credential_security_comprehensive_test.go:600:1: setupPlatformTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupPlatformTest(t *testing.T) TokenStore {
^
services/router/internal/secure/credential_security_test.go:75:1: setupCredentialStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupCredentialStore(t *testing.T) TokenStore {
^
services/router/internal/secure/credential_security_test.go:825:1: setupCredentialStoreForBench returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupCredentialStoreForBench(b *testing.B) TokenStore {
^
services/router/internal/secure/credential_store_other.go:13:1: newCredentialStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func newCredentialStore(appName string) (TokenStore, error) {
^
services/router/internal/secure/encrypted_file_store.go:33:1: newEncryptedFileStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func newEncryptedFileStore(appName string) (TokenStore, error) {
^
services/router/internal/secure/keychain_store_darwin.go:35:1: newKeychainStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func newKeychainStore(appName string) (TokenStore, error) {
^
services/router/internal/secure/secret_service_store_other.go:11:1: newSecretServiceStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func newSecretServiceStore(appName string) (TokenStore, error) {
^
services/router/internal/secure/token_store.go:39:1: NewTokenStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func NewTokenStore(appName string) (TokenStore, error) {
^
services/router/internal/secure/token_store_test.go:23:1: validateTokenStoreCreation returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func validateTokenStoreCreation(t *testing.T, appName string) TokenStore {
^
services/router/internal/secure/token_store_test.go:110:1: setupTokenStoreTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupTokenStoreTest(t *testing.T, testKey string) TokenStore {
^
services/router/internal/secure/token_store_test.go:218:1: setupEncryptedFileStoreTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupEncryptedFileStoreTest(t *testing.T) (TokenStore, string, func()) {
^
services/router/internal/secure/token_store_test.go:351:1: setupConcurrentTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupConcurrentTest(t *testing.T) TokenStore {
^
services/router/internal/secure/token_store_test.go:459:1: setupSecurityTestStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupSecurityTestStore(t *testing.T, tempDir string) (*encryptedFileStore, TokenStore) {
^
services/router/internal/secure/token_store_test.go:628:1: setupConcurrentEncryptedTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupConcurrentEncryptedTest(t *testing.T, tempDir string) TokenStore {
^
services/router/internal/secure/token_store_test.go:702:1: setupTokenStoreEdgeCaseTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupTokenStoreEdgeCaseTest(t *testing.T) TokenStore {
^
services/router/internal/secure/token_store_test.go:850:1: setupPerformanceTest returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func setupPerformanceTest(t *testing.T) TokenStore {
^
services/router/internal/secure/token_store_test_helpers.go:41:1: CreateStore returns interface (github.com/poiley/mcp-bridge/services/router/internal/secure.TokenStore) (ireturn)
func (env *TokenStoreTestEnvironment) CreateStore(serviceName string) TokenStore {
^
services/router/internal/tracing/tracing.go:111:1: createExporter returns interface (go.opentelemetry.io/otel/sdk/trace.SpanExporter) (ireturn)
func createExporter(cfg config.TracingConfig, logger *zap.Logger) (sdktrace.SpanExporter, error) {
^
services/router/internal/tracing/tracing.go:134:1: createSampler returns interface (go.opentelemetry.io/otel/sdk/trace.Sampler) (ireturn)
func createSampler(cfg config.TracingConfig) sdktrace.Sampler {
^
services/router/internal/tracing/tracing.go:148:1: StartSpan returns interface (go.opentelemetry.io/otel/trace.Span) (ireturn)
func (t *Tracer) StartSpan(ctx context.Context, name string,
^
services/router/internal/tracing/tracing.go:158:1: StartSpanWithKind returns interface (go.opentelemetry.io/otel/trace.Span) (ireturn)
func (t *Tracer) StartSpanWithKind(ctx context.Context, name string,
^
services/router/cmd/mcp-router/metrics_test.go:120:1: The line is 140 characters long, which exceeds the maximum of 120 characters. (lll)
func runMetricsServerWithTests(t *testing.T, ctx context.Context, cancel context.CancelFunc, cfg *config.Config, logger *zap.Logger) error {
^
services/router/internal/direct/adaptive_test.go:745:1: The line is 127 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyAdaptiveBehavior(t *testing.T, adaptive *AdaptiveTimeout, initialTimeout, peakTimeout, finalTimeout time.Duration) {
^
services/router/internal/direct/http_client_test.go:980:1: The line is 136 characters long, which exceeds the maximum of 120 characters. (lll)
func runConcurrentHTTPOperations(t *testing.T, client *HTTPClient, numGoroutines, requestsPerGoroutine int) ([]error, []*mcp.Response) {
^
services/router/internal/direct/http_client_test.go:1046:1: The line is 152 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyConcurrentHTTPResults(t *testing.T, client *HTTPClient, errors []error, responses []*mcp.Response, numGoroutines, requestsPerGoroutine int) {
^
services/router/internal/direct/manager.go:634:1: The line is 147 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *DirectClientManager) createClientConnectionFunc(ctx context.Context, serverURL string, protocol ClientType) func() (DirectClient, error) {
^
services/router/internal/direct/manager.go:661:1: The line is 126 characters long, which exceeds the maximum of 120 characters. (lll)
func (m *DirectClientManager) recordConnectionFailure(serverURL string, protocol ClientType, startTime time.Time, err error) {
^
services/router/internal/direct/manager_test.go:1270:1: The line is 144 characters long, which exceeds the maximum of 120 characters. (lll)
func runConcreteProtocolDetectionTests(t *testing.T, manager *DirectClientManager, ctx context.Context, testCases []protocolDetectionTestCase) {
^
services/router/internal/direct/manager_test.go:1519:1: The line is 136 characters long, which exceeds the maximum of 120 characters. (lll)
func runErrorHandlingTests(t *testing.T, manager DirectClientManagerInterface, ctx context.Context, testCases []errorHandlingTestCase) {
^
services/router/internal/direct/memory_optimization_test.go:356:1: The line is 141 characters long, which exceeds the maximum of 120 characters. (lll)
func runConcurrentBufferOperations(t *testing.T, wg *sync.WaitGroup, optimizer *MemoryOptimizer, numGoroutines, operationsPerGoroutine int) {
^
services/router/internal/direct/memory_optimization_test.go:375:1: The line is 139 characters long, which exceeds the maximum of 120 characters. (lll)
func runConcurrentJSONOperations(t *testing.T, wg *sync.WaitGroup, optimizer *MemoryOptimizer, numGoroutines, operationsPerGoroutine int) {
^
services/router/internal/direct/memory_optimization_test.go:405:1: The line is 136 characters long, which exceeds the maximum of 120 characters. (lll)
func runConcurrentStatsAccess(t *testing.T, wg *sync.WaitGroup, optimizer *MemoryOptimizer, numGoroutines, operationsPerGoroutine int) {
^
services/router/internal/direct/protocol_comparison_test.go:665:1: The line is 123 characters long, which exceeds the maximum of 120 characters. (lll)
func runPayloadBenchmarkLoop(b *testing.B, client DirectClient, ctx context.Context, protocolName string, payload string) {
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:490:1: The line is 123 characters long, which exceeds the maximum of 120 characters. (lll)
		go runConcurrentDetectionWorker(t, &wg, manager, serverURLs, ctx, i, detectionsPerWorker, &successfulDetections, &errors)
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:523:1: The line is 156 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyConcurrentDetectionResults(t *testing.T, manager *DirectClientManager, numWorkers, detectionsPerWorker int, successfulDetections, errors int64) {
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:716:1: The line is 127 characters long, which exceeds the maximum of 120 characters. (lll)
func runProtocolDetectionTest(t *testing.T, manager *DirectClientManager, ctx context.Context, testURL, expectedError string) {
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:725:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyNoCacheForFailures(t *testing.T, manager *DirectClientManager, ctx context.Context, testURL string, config DirectConfig) {
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:783:1: The line is 129 characters long, which exceeds the maximum of 120 characters. (lll)
func runEdgeCaseTests(t *testing.T, manager *DirectClientManager, ctx context.Context, config DirectConfig, logger *zap.Logger) {
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:1009:1: The line is 156 characters long, which exceeds the maximum of 120 characters. (lll)
func runSingleDetection(t *testing.T, wg *sync.WaitGroup, manager *DirectClientManager, ctx context.Context, serverURL string, i int, successCount *int64) {
^
services/router/internal/direct/sse_client_test.go:809:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
func setupSSEPerformanceClient(t *testing.T, logger *zap.Logger, mockServer *mockSSEServer, perfConfig SSEPerformanceConfig) *SSEClient {
^
services/router/internal/direct/sse_client_test.go:854:1: The line is 123 characters long, which exceeds the maximum of 120 characters. (lll)
func analyzeSSEPerformanceResults(t *testing.T, testName string, connectTime time.Duration, requestTimes []time.Duration) {
^
services/router/internal/direct/stdio_client_test.go:1082:1: The line is 135 characters long, which exceeds the maximum of 120 characters. (lll)
func setupStdioPerformanceClient(t *testing.T, logger *zap.Logger, scriptPath string, perfConfig StdioPerformanceConfig) *StdioClient {
^
services/router/internal/direct/stdio_client_test.go:1138:1: The line is 125 characters long, which exceeds the maximum of 120 characters. (lll)
func analyzeStdioPerformanceResults(t *testing.T, testName string, connectTime time.Duration, requestTimes []time.Duration) {
^
services/router/internal/direct/stdio_client_test.go:1972:1: The line is 134 characters long, which exceeds the maximum of 120 characters. (lll)
func setupStdioMemoryBenchClient(b *testing.B, logger *zap.Logger, scriptPath string, memoryOptimizer *MemoryOptimizer) *StdioClient {
^
services/router/internal/direct/websocket_client.go:203:1: The line is 156 characters long, which exceeds the maximum of 120 characters. (lll)
func (c *WebSocketClient) establishConnection(ctx context.Context, dialer *websocket.Dialer, headers http.Header) (*websocket.Conn, *http.Response, error) {
^
services/router/internal/direct/websocket_client_test.go:903:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func setupWebSocketConcurrentClient(t *testing.T, logger *zap.Logger, mockServer *mockWebSocketServer) *WebSocketClient {
^
services/router/internal/direct/websocket_client_test.go:957:1: The line is 174 characters long, which exceeds the maximum of 120 characters. (lll)
func executeWebSocketConcurrentRequests(t *testing.T, client *WebSocketClient, numGoroutines, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
^
services/router/internal/direct/websocket_client_test.go:973:1: The line is 180 characters long, which exceeds the maximum of 120 characters. (lll)
func executeWebSocketConcurrentGoroutine(ctx context.Context, client *WebSocketClient, goroutineID, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
^
services/router/internal/direct/websocket_client_test.go:1005:1: The line is 161 characters long, which exceeds the maximum of 120 characters. (lll)
func collectWebSocketConcurrentResults(errChan chan error, responseChan chan *mcp.Response, numGoroutines, requestsPerGoroutine int) ([]error, []*mcp.Response) {
^
services/router/internal/direct/websocket_client_test.go:1022:1: The line is 162 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyWebSocketConcurrentResults(t *testing.T, client *WebSocketClient, errors []error, responses []*mcp.Response, numGoroutines, requestsPerGoroutine int) {
^
services/router/internal/direct/websocket_client_test.go:1277:1: The line is 178 characters long, which exceeds the maximum of 120 characters. (lll)
func setupWebSocketPerformanceClient(t *testing.T, logger *zap.Logger, mockServer *mockWebSocketServer, perfConfig WebSocketPerformanceConfig) (*WebSocketClient, time.Duration) {
^
services/router/internal/direct/websocket_client_test.go:1332:1: The line is 128 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyWebSocketPerformanceResults(t *testing.T, testName string, connectTime time.Duration, requestTimes []time.Duration) {
^
services/router/internal/direct/websocket_client_test.go:1443:1: The line is 143 characters long, which exceeds the maximum of 120 characters. (lll)
func setupWebSocketFrameHandlingClient(t *testing.T, logger *zap.Logger, server *httptest.Server, tc webSocketFrameTestCase) *WebSocketClient {
^
services/router/internal/gateway/gateway_integration_advanced_test.go:549:1: The line is 135 characters long, which exceeds the maximum of 120 characters. (lll)
func runGoroutineOperations(goroutineID, operationsCount int, cfg config.GatewayConfig, logger *zap.Logger, counters *clientCounters) {
^
services/router/internal/gateway/gateway_integration_advanced_test.go:555:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
func runSingleOperation(goroutineID, opIdx int, cfg config.GatewayConfig, logger *zap.Logger, counters *clientCounters) {
^
services/router/internal/router/router_test.go:127:1: The line is 132 characters long, which exceeds the maximum of 120 characters. (lll)
func validateNewRouterInitialization(t *testing.T, router *LocalRouter, expectedConfig *config.Config, expectedLogger *zap.Logger) {
^
services/router/internal/router/router_test.go:262:1: The line is 147 characters long, which exceeds the maximum of 120 characters. (lll)
func setupMessageProcessingRouter(t *testing.T, mockServer *httptest.Server) (*LocalRouter, context.Context, context.CancelFunc, <-chan struct{}) {
^
services/router/internal/router/router_test.go:621:1: The line is 144 characters long, which exceeds the maximum of 120 characters. (lll)
func setupInitializationRouter(t *testing.T, mockServer *httptest.Server) (*LocalRouter, context.Context, context.CancelFunc, <-chan struct{}) {
^
services/router/internal/router/router_test.go:879:1: The line is 139 characters long, which exceeds the maximum of 120 characters. (lll)
func setupBenchmarkRouter(b *testing.B, mockServer *httptest.Server) (*LocalRouter, context.Context, context.CancelFunc, <-chan struct{}) {
^
services/router/internal/router/router_test.go:1055:1: The line is 149 characters long, which exceeds the maximum of 120 characters. (lll)
func monitorCorrelationResponses(t *testing.T, router *LocalRouter, ctx context.Context, receivedResponses map[string]bool, responseMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:1110:1: The line is 127 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyAllResponsesReceived(t *testing.T, requestIDs []string, receivedResponses map[string]bool, responseMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:1488:1: The line is 123 characters long, which exceeds the maximum of 120 characters. (lll)
				req := fmt.Sprintf(`{"jsonrpc":"2.0","method":"test.concurrent","params":{"worker_id":%d},"id":"%s"}`, workerID, reqID)
^
services/router/internal/router/router_test.go:2040:1: The line is 139 characters long, which exceeds the maximum of 120 characters. (lll)
func monitorQueueLifecycleResponses(ctx context.Context, router *LocalRouter, responsesReceived *map[string]bool, responseMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:2069:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
func waitForAllQueuedResponses(t *testing.T, queuedRequestIDs []string, responsesReceived *map[string]bool, responseMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:2085:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
func verifyQueuedResponsesReceived(t *testing.T, queuedRequestIDs []string, responsesReceived *map[string]bool, responseMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:2686:1: The line is 131 characters long, which exceeds the maximum of 120 characters. (lll)
func monitorRoutingDecisions(ctx context.Context, router *LocalRouter, routingDecisions map[string]int32, decisionMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:2702:1: The line is 172 characters long, which exceeds the maximum of 120 characters. (lll)
func validateRoutingDecision(t *testing.T, tt routingDecisionTest, gatewayRequests *int32, routingDecisions map[string]int32, decisionMu *sync.Mutex, router *LocalRouter) {
^
services/router/internal/router/router_test.go:2783:1: The line is 129 characters long, which exceeds the maximum of 120 characters. (lll)
func setupProtocolNegotiationServer(t *testing.T, protocolResponses *map[string]int32, protocolMu *sync.Mutex) *httptest.Server {
^
services/router/internal/router/router_test.go:2791:1: The line is 137 characters long, which exceeds the maximum of 120 characters. (lll)
func handleProtocolNegotiationRequests(t *testing.T, conn *websocket.Conn, protocolResponses *map[string]int32, protocolMu *sync.Mutex) {
^
services/router/internal/router/router_test.go:2875:1: The line is 133 characters long, which exceeds the maximum of 120 characters. (lll)
func validateProtocolResponses(t *testing.T, protocolMethods []string, protocolResponses *map[string]int32, protocolMu *sync.Mutex) {
^
services/router/internal/secure/keychain_store_darwin.go:290:1: The line is 121 characters long, which exceeds the maximum of 120 characters. (lll)
		return nil, fmt.Errorf("decode failed or too long") // Conservative limit: anything longer is probably a real hex token
^
services/router/internal/stdio/handler_test.go:138:1: The line is 139 characters long, which exceeds the maximum of 120 characters. (lll)
func runStdinHandlerTest(t *testing.T, ctx context.Context, cancel context.CancelFunc, handler *Handler, stdinChan chan []byte, tt struct {
^
services/router/internal/gateway/client_test.go:482:1: `if tt.wantError` has complex nested blocks (complexity: 6) (nestif)
	if tt.wantError {
^
services/router/internal/gateway/client_test.go:1359:1: `if tt.wantError` has complex nested blocks (complexity: 5) (nestif)
			if tt.wantError {
^
services/router/internal/gateway/client_test.go:1560:1: `if tt.wantError` has complex nested blocks (complexity: 5) (nestif)
			if tt.wantError {
^
services/router/internal/secure/encrypted_file_store.go:168:3: error is not nil (line 163) but it returns nil (nilerr)
		return &tokenData{Tokens: make(map[string]string)}, nil
		^
services/router/internal/secure/encrypted_file_store.go:176:3: error is not nil (line 173) but it returns nil (nilerr)
		return &tokenData{Tokens: make(map[string]string)}, nil
		^
services/router/cmd/mcp-router/metrics_test.go:164:3: return with no blank line before (nlreturn)
		return &metrics.RouterMetrics{
		^
services/router/cmd/mcp-router/metrics_test.go:262:2: return with no blank line before (nlreturn)
	return logger
	^
services/router/cmd/mcp-router/metrics_test.go:349:2: return with no blank line before (nlreturn)
	return string(body[:n])
	^
services/router/cmd/mcp-router/update_test.go:89:5: return with no blank line before (nlreturn)
				return
				^
services/router/cmd/mcp-router/update_test.go:260:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/config/config_integration_test.go:740:3: return with no blank line before (nlreturn)
		return fmt.Sprintf(configYAML, tokenPath)
		^
services/router/internal/config/config_integration_test.go:742:2: return with no blank line before (nlreturn)
	return configYAML
	^
services/router/internal/config/config_test.go:1303:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/config/config_test.go:1315:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/direct/http_client_test.go:505:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/http_client_test.go:511:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/http_client_test.go:1006:6: return with no blank line before (nlreturn)
					return
					^
services/router/internal/direct/manager.go:651:4: return with no blank line before (nlreturn)
			return nil, fmt.Errorf("failed to connect %s client to %s: %w", protocol, serverURL, err)
			^
services/router/internal/direct/manager.go:1296:3: return with no blank line before (nlreturn)
		return nil, err
		^
services/router/internal/direct/manager.go:1304:3: return with no blank line before (nlreturn)
		return nil, fmt.Errorf("invalid scheme for SSE: %s", parsedURL.Scheme)
		^
services/router/internal/direct/manager.go:1321:3: return with no blank line before (nlreturn)
		return nil, err
		^
services/router/internal/direct/manager.go:1339:3: return with no blank line before (nlreturn)
		return nil, err
		^
services/router/internal/direct/manager.go:1358:3: return with no blank line before (nlreturn)
		return false
		^
services/router/internal/direct/manager_test.go:1234:2: return with no blank line before (nlreturn)
	return append(basicCases, additionalCases...)
	^
services/router/internal/direct/manager_test.go:1321:2: return with no blank line before (nlreturn)
	return append(basicCases, advancedCases...)
	^
services/router/internal/direct/manager_test.go:1454:2: return with no blank line before (nlreturn)
	return manager
	^
services/router/internal/direct/manager_test.go:1625:2: return with no blank line before (nlreturn)
	return manager
	^
services/router/internal/direct/manager_test.go:1730:2: return with no blank line before (nlreturn)
	return manager
	^
services/router/internal/direct/manager_test.go:1820:2: return with no blank line before (nlreturn)
	return manager
	^
services/router/internal/direct/manager_test.go:1885:2: return with no blank line before (nlreturn)
	return manager
	^
services/router/internal/direct/memory_optimization_test.go:575:2: return with no blank line before (nlreturn)
	return initialMem
	^
services/router/internal/direct/memory_optimization_test.go:624:2: return with no blank line before (nlreturn)
	return memoryIncrease
	^
services/router/internal/direct/memory_optimization_test.go:663:2: return with no blank line before (nlreturn)
	return NewMemoryOptimizer(configWithPooling, logger)
	^
services/router/internal/direct/memory_optimization_test.go:671:2: return with no blank line before (nlreturn)
	return NewMemoryOptimizer(configWithoutPooling, logger)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:226:4: return with no blank line before (nlreturn)
			return httpServer.URL, "", "", func() { httpServer.Close() }
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:258:4: return with no blank line before (nlreturn)
			return httpServer.URL, wsURL, "", func() {
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:291:4: return with no blank line before (nlreturn)
			return "", "", sseServer.URL, func() { sseServer.Close() }
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:323:4: return with no blank line before (nlreturn)
			return httpServer.URL, wsURL, "", func() {
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:356:4: return with no blank line before (nlreturn)
			return httpServer.URL, "", "", func() { httpServer.Close() }
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:511:4: continue with no blank line before (nlreturn)
			continue
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:516:4: continue with no blank line before (nlreturn)
			continue
			^
services/router/internal/direct/protocol_negotiation_advanced_test.go:711:3: return with no blank line before (nlreturn)
		return testURL
		^
services/router/internal/direct/protocol_negotiation_advanced_test.go:713:2: return with no blank line before (nlreturn)
	return tt.serverURL
	^
services/router/internal/direct/sse_client_test.go:822:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/sse_client_test.go:830:2: return with no blank line before (nlreturn)
	return time.Since(start)
	^
services/router/internal/direct/sse_client_test.go:907:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/sse_client_test.go:937:2: return with no blank line before (nlreturn)
	return errChan, responseChan
	^
services/router/internal/direct/sse_client_test.go:964:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/sse_client_test.go:1140:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/direct/sse_client_test.go:1167:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/sse_client_test.go:1201:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/sse_client_test.go:1341:2: return with no blank line before (nlreturn)
	return httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
	^
services/router/internal/direct/sse_client_test.go:1426:5: return with no blank line before (nlreturn)
				return
				^
services/router/internal/direct/sse_client_test.go:1457:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:171:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:192:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:402:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:522:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:546:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:627:2: return with no blank line before (nlreturn)
	return tmpDir, scriptPath
	^
services/router/internal/direct/stdio_client_test.go:649:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:778:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:796:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:892:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1079:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1095:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1111:2: return with no blank line before (nlreturn)
	return time.Since(start)
	^
services/router/internal/direct/stdio_client_test.go:1220:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1247:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1279:2: return with no blank line before (nlreturn)
	return errChan, responseChan
	^
services/router/internal/direct/stdio_client_test.go:1306:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/stdio_client_test.go:1406:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1428:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1548:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1575:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1687:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1708:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1873:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:1900:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/stdio_client_test.go:1969:2: return with no blank line before (nlreturn)
	return scriptPath
	^
services/router/internal/direct/stdio_client_test.go:2000:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/websocket_client.go:200:2: return with no blank line before (nlreturn)
	return headers
	^
services/router/internal/direct/websocket_client.go:218:3: return with no blank line before (nlreturn)
		return nil, resp, fmt.Errorf("WebSocket connection failed: %w", err)
		^
services/router/internal/direct/websocket_client.go:231:3: return with no blank line before (nlreturn)
		return conn.SetReadDeadline(time.Now().Add(c.config.PongTimeout))
		^
services/router/internal/direct/websocket_client.go:477:2: return with no blank line before (nlreturn)
	return nil
	^
services/router/internal/direct/websocket_client.go:529:3: return with no blank line before (nlreturn)
		return ctx.Err()
		^
services/router/internal/direct/websocket_client_test.go:368:2: return with no blank line before (nlreturn)
	return slowServer
	^
services/router/internal/direct/websocket_client_test.go:389:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/direct/websocket_client_test.go:662:3: return with no blank line before (nlreturn)
		return conn.WriteControl(websocket.PongMessage, []byte(appData), time.Now().Add(time.Second))
		^
services/router/internal/direct/websocket_client_test.go:667:3: return with no blank line before (nlreturn)
		return nil
		^
services/router/internal/direct/websocket_client_test.go:954:2: return with no blank line before (nlreturn)
	return errChan, responseChan
	^
services/router/internal/direct/websocket_client_test.go:984:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/websocket_client_test.go:1068:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/direct/websocket_client_test.go:1424:2: return with no blank line before (nlreturn)
	return mcp.Response{
	^
services/router/internal/gateway/binary_frame_test.go:139:5: return with no blank line before (nlreturn)
				return
				^
services/router/internal/gateway/binary_frame_test.go:146:5: return with no blank line before (nlreturn)
				return
				^
services/router/internal/gateway/binary_frame_test.go:218:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/router/internal/gateway/binary_frame_test.go:228:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/router/internal/gateway/binary_frame_test.go:238:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/router/internal/gateway/binary_frame_test.go:249:2: return with no blank line before (nlreturn)
	return buf.Bytes()
	^
services/router/internal/gateway/client_mtls_test.go:531:2: return with no blank line before (nlreturn)
	return &Client{
	^
services/router/internal/gateway/client_test.go:93:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/client_test.go:98:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/client_test.go:103:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/client_test.go:166:5: return with no blank line before (nlreturn)
				return nil
				^
services/router/internal/gateway/client_test.go:182:5: return with no blank line before (nlreturn)
				return nil
				^
services/router/internal/gateway/client_test.go:318:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/gateway/client_test.go:325:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/gateway/client_test.go:1585:2: return with no blank line before (nlreturn)
	return httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:242:2: return with no blank line before (nlreturn)
	return tests
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:269:4: return with no blank line before (nlreturn)
			return err
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:305:4: return with no blank line before (nlreturn)
			return err
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:355:4: return with no blank line before (nlreturn)
			return err
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:461:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:512:2: return with no blank line before (nlreturn)
	return addr
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:559:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:566:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:577:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/namespace_router_test.go:87:2: return with no blank line before (nlreturn)
	return router
	^
services/router/internal/gateway/namespace_router_test.go:181:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/namespace_router_test.go:206:2: return with no blank line before (nlreturn)
	return false
	^
services/router/internal/gateway/tcp_client_advanced_test.go:139:2: return with no blank line before (nlreturn)
	return append([]string{}, e.events...)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:190:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/gateway/tcp_client_advanced_test.go:244:2: return with no blank line before (nlreturn)
	return addr
	^
services/router/internal/gateway/tcp_client_advanced_test.go:259:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/gateway/tcp_client_advanced_test.go:303:5: break with no blank line before (nlreturn)
				break
				^
services/router/internal/gateway/tcp_client_advanced_test.go:423:2: return with no blank line before (nlreturn)
	return addr
	^
services/router/internal/gateway/tcp_client_advanced_test.go:470:2: return with no blank line before (nlreturn)
	return results
	^
services/router/internal/gateway/tcp_client_advanced_test.go:484:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/tcp_client_advanced_test.go:490:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/gateway/tcp_client_advanced_test.go:503:3: return with no blank line before (nlreturn)
		return -1
		^
services/router/internal/gateway/tcp_client_advanced_test.go:509:3: return with no blank line before (nlreturn)
		return -1
		^
services/router/internal/gateway/tcp_client_advanced_test.go:652:2: return with no blank line before (nlreturn)
	return client
	^
services/router/internal/gateway/tcp_client_advanced_test.go:676:2: return with no blank line before (nlreturn)
	return err
	^
services/router/internal/health/checker_test.go:253:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/health/checker_test.go:369:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/router/gateway_fallback_integration_test.go:70:3: return with no blank line before (nlreturn)
		return nil
		^
services/router/internal/router/gateway_fallback_integration_test.go:79:5: return with no blank line before (nlreturn)
				return &mcp.Response{
				^
services/router/internal/router/gateway_fallback_integration_test.go:218:4: continue with no blank line before (nlreturn)
			continue
			^
services/router/internal/router/message_router.go:490:4: return with no blank line before (nlreturn)
			return nil
			^
services/router/internal/router/message_router.go:500:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/router/message_router.go:638:2: return with no blank line before (nlreturn)
	return fmt.Errorf("%s: %w", msg, err)
	^
services/router/internal/router/router_test.go:104:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/router/router_test.go:116:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/router/router_test.go:121:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/router/router_test.go:379:4: return with no blank line before (nlreturn)
			return
			^
services/router/internal/router/router_test.go:1035:2: return with no blank line before (nlreturn)
	return router, ctx, cancel
	^
services/router/internal/router/router_test.go:1123:5: break with no blank line before (nlreturn)
				break
				^
services/router/internal/router/router_test.go:2019:2: return with no blank line before (nlreturn)
	return nil
	^
services/router/internal/router/router_test.go:2037:2: return with no blank line before (nlreturn)
	return router
	^
services/router/internal/router/router_test.go:2081:3: return with no blank line before (nlreturn)
		return true
		^
services/router/internal/router/router_test.go:2426:7: return with no blank line before (nlreturn)
						return nil
						^
services/router/internal/router/router_test.go:2439:2: return with no blank line before (nlreturn)
	return &config.Config{
	^
services/router/internal/router/router_test.go:2464:2: return with no blank line before (nlreturn)
	return router
	^
services/router/internal/router/router_test.go:2683:2: return with no blank line before (nlreturn)
	return router
	^
services/router/internal/router/router_test.go:2850:2: return with no blank line before (nlreturn)
	return router
	^
services/router/internal/secure/credential_security_comprehensive_test.go:108:2: return with no blank line before (nlreturn)
	return store
	^
services/router/internal/secure/credential_security_comprehensive_test.go:207:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/secure/credential_security_comprehensive_test.go:214:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/secure/credential_security_test.go:520:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/secure/credential_security_test.go:592:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/secure/keychain_store_darwin.go:129:2: return with no blank line before (nlreturn)
	return strings.Contains(errorStr, "resource temporarily unavailable") ||
	^
services/router/internal/secure/keychain_store_darwin.go:282:2: return with no blank line before (nlreturn)
	return matched
	^
services/router/internal/secure/keychain_store_darwin.go:292:2: return with no blank line before (nlreturn)
	return decoded, nil
	^
services/router/internal/secure/keychain_store_darwin.go:309:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/secure/keychain_store_darwin.go:346:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/secure/token_store_test.go:709:2: return with no blank line before (nlreturn)
	return store
	^
services/router/internal/secure/token_store_test.go:807:3: return with no blank line before (nlreturn)
		return false
		^
services/router/internal/secure/token_store_test.go:812:3: return with no blank line before (nlreturn)
		return false
		^
services/router/internal/secure/token_store_test.go:825:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/stdio/handler_test.go:160:6: return with no blank line before (nlreturn)
					return
					^
services/router/internal/stdio/handler_test.go:168:5: return with no blank line before (nlreturn)
				return
				^
services/router/internal/stdio/handler_test.go:360:2: return with no blank line before (nlreturn)
	return &outputBuf, handler, stdoutChan, ctx, cancel
	^
services/router/internal/stdio/handler_test.go:376:4: continue with no blank line before (nlreturn)
			continue
			^
services/router/internal/stdio/handler_test.go:388:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/tracing/tracing_test.go:106:3: return with no blank line before (nlreturn)
		return
		^
services/router/internal/tracing/tracing_test.go:171:2: return with no blank line before (nlreturn)
	return tracer
	^
services/router/internal/tracing/tracing_test.go:286:4: break with no blank line before (nlreturn)
			break
			^
services/router/internal/direct/sse_client_test.go:991:2: Consider pre-allocating `errors` (prealloc)
	var errors []error
	^
services/router/internal/direct/sse_client_test.go:996:2: Consider pre-allocating `responses` (prealloc)
	var responses []*mcp.Response
	^
services/router/internal/direct/stdio_client_test.go:1333:2: Consider pre-allocating `errors` (prealloc)
	var errors []error
	^
services/router/internal/direct/stdio_client_test.go:1338:2: Consider pre-allocating `responses` (prealloc)
	var responses []*mcp.Response
	^
services/router/internal/direct/protocol_comparison_test.go:41:6: test helper function should start from b.Helper() (thelper)
func createProtocolBenchmarkConfigs(b *testing.B, logger *zap.Logger) []protocolBenchmarkConfig {
     ^
services/router/internal/direct/protocol_comparison_test.go:215:6: test helper function should start from b.Helper() (thelper)
func createProtocolSetups(b *testing.B, logger *zap.Logger) []struct {
     ^
services/router/internal/direct/protocol_comparison_test.go:312:6: test helper function should start from b.Helper() (thelper)
func runProtocolConnectionBenchmark(b *testing.B, protocol struct {
     ^
services/router/internal/direct/protocol_comparison_test.go:346:6: test helper function should start from b.Helper() (thelper)
func createConcurrencyBenchmarkConfigs(b *testing.B, logger *zap.Logger) []protocolBenchmarkConfig {
     ^
services/router/internal/direct/protocol_comparison_test.go:525:6: test helper function should start from b.Helper() (thelper)
func createPayloadBenchmarkProtocols(b *testing.B, logger *zap.Logger) []protocolBenchmarkConfig {
     ^
services/router/internal/direct/protocol_negotiation_advanced_test.go:498:6: test helper function should start from t.Helper() (thelper)
func runConcurrentDetectionWorker(t *testing.T, wg *sync.WaitGroup, manager *DirectClientManager, 
     ^
services/router/internal/direct/sse_client_test.go:940:6: test helper function should start from t.Helper() (thelper)
func launchSSEConcurrentWorkers(t *testing.T, wg *sync.WaitGroup, client *SSEClient, ctx context.Context, 
     ^
services/router/internal/direct/stdio_client_test.go:1282:6: test helper function should start from t.Helper() (thelper)
func launchStdioConcurrentWorkers(t *testing.T, wg *sync.WaitGroup, client *StdioClient, ctx context.Context,
     ^
services/router/internal/direct/websocket_client_test.go:636:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketPingPongServer(t *testing.T) (chan bool, chan bool, *httptest.Server) {
     ^
services/router/internal/direct/websocket_client_test.go:671:6: test helper function should start from t.Helper() (thelper)
func handleWebSocketPingPongMessages(t *testing.T, conn *websocket.Conn) {
     ^
services/router/internal/direct/websocket_client_test.go:690:6: test helper function should start from t.Helper() (thelper)
func processWebSocketPingPongMCPRequest(t *testing.T, conn *websocket.Conn, message []byte) {
     ^
services/router/internal/direct/websocket_client_test.go:706:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketPingPongClient(t *testing.T, logger *zap.Logger, server *httptest.Server) *WebSocketClient {
     ^
services/router/internal/direct/websocket_client_test.go:727:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketPingPongClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:733:6: test helper function should start from t.Helper() (thelper)
func runWebSocketPingPongTest(t *testing.T, client *WebSocketClient, pingReceived, pongReceived chan bool) {
     ^
services/router/internal/direct/websocket_client_test.go:741:6: test helper function should start from t.Helper() (thelper)
func sendWebSocketPingRequest(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:753:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketPingPongActivity(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:775:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketCorrelationServer(t *testing.T) *httptest.Server {
     ^
services/router/internal/direct/websocket_client_test.go:791:6: test helper function should start from t.Helper() (thelper)
func handleWebSocketCorrelationMessages(t *testing.T, conn *websocket.Conn) {
     ^
services/router/internal/direct/websocket_client_test.go:821:6: test helper function should start from t.Helper() (thelper)
func sendWebSocketCorrelationResponse(t *testing.T, conn *websocket.Conn, resp mcp.Response) {
     ^
services/router/internal/direct/websocket_client_test.go:828:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketCorrelationClient(t *testing.T, logger *zap.Logger, server *httptest.Server) *WebSocketClient {
     ^
services/router/internal/direct/websocket_client_test.go:850:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketCorrelationClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:856:6: test helper function should start from t.Helper() (thelper)
func runWebSocketCorrelationTest(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:881:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketCorrelationResponse(t *testing.T, resp *mcp.Response, expectedCorrelation string) {
     ^
services/router/internal/direct/websocket_client_test.go:932:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketConcurrentClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:938:6: test helper function should start from t.Helper() (thelper)
func runWebSocketConcurrentOperations(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:990:6: test helper function should start from t.Helper() (thelper)
func waitForWebSocketConcurrentCompletion(t *testing.T, wg *sync.WaitGroup) {
     ^
services/router/internal/direct/websocket_client_test.go:1052:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketReconnectServer(t *testing.T) (*webSocketReconnectServerState, *httptest.Server) {
     ^
services/router/internal/direct/websocket_client_test.go:1077:6: test helper function should start from t.Helper() (thelper)
func handleWebSocketReconnectConnection(t *testing.T, w http.ResponseWriter, r *http.Request, connectionCount int) {
     ^
services/router/internal/direct/websocket_client_test.go:1092:6: test helper function should start from t.Helper() (thelper)
func sendWebSocketReconnectAck(t *testing.T, conn *websocket.Conn, connectionCount int) {
     ^
services/router/internal/direct/websocket_client_test.go:1104:6: test helper function should start from t.Helper() (thelper)
func handleWebSocketReconnectMessages(t *testing.T, conn *websocket.Conn, connectionCount int) {
     ^
services/router/internal/direct/websocket_client_test.go:1132:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketReconnectClient(t *testing.T, logger *zap.Logger, server *httptest.Server) *WebSocketClient {
     ^
services/router/internal/direct/websocket_client_test.go:1155:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketReconnectClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1161:6: test helper function should start from t.Helper() (thelper)
func runWebSocketReconnectionTest(t *testing.T, client *WebSocketClient, serverState *webSocketReconnectServerState) {
     ^
services/router/internal/direct/websocket_client_test.go:1180:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketInitialConnection(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1185:6: test helper function should start from t.Helper() (thelper)
func sendWebSocketInitialRequest(t *testing.T, client *WebSocketClient, ctx context.Context) {
     ^
services/router/internal/direct/websocket_client_test.go:1209:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketReconnectionResult(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1266:6: test helper function should start from t.Helper() (thelper)
func runWebSocketPerformanceTest(t *testing.T, logger *zap.Logger, tc webSocketPerformanceTestCase) {
     ^
services/router/internal/direct/websocket_client_test.go:1303:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketPerformanceClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1309:6: test helper function should start from t.Helper() (thelper)
func executeWebSocketPerformanceRequests(t *testing.T, client *WebSocketClient) []time.Duration {
     ^
services/router/internal/direct/websocket_client_test.go:1378:6: test helper function should start from t.Helper() (thelper)
func runWebSocketFrameHandlingTest(t *testing.T, logger *zap.Logger, tc webSocketFrameTestCase) {
     ^
services/router/internal/direct/websocket_client_test.go:1388:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketFrameHandlingServer(t *testing.T, tc webSocketFrameTestCase) *httptest.Server {
     ^
services/router/internal/direct/websocket_client_test.go:1405:6: test helper function should start from t.Helper() (thelper)
func handleWebSocketFrameMessages(t *testing.T, conn *websocket.Conn, tc webSocketFrameTestCase) {
     ^
services/router/internal/direct/websocket_client_test.go:1436:6: test helper function should start from t.Helper() (thelper)
func sendWebSocketFrameResponse(t *testing.T, conn *websocket.Conn, resp mcp.Response) {
     ^
services/router/internal/direct/websocket_client_test.go:1470:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketFrameHandlingClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1476:6: test helper function should start from t.Helper() (thelper)
func executeWebSocketFrameHandlingTest(t *testing.T, client *WebSocketClient, tc webSocketFrameTestCase) {
     ^
services/router/internal/direct/websocket_client_test.go:1495:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketFrameResponse(t *testing.T, resp *mcp.Response, tc webSocketFrameTestCase, duration time.Duration) {
     ^
services/router/internal/direct/websocket_client_test.go:1580:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketErrorRecoveryServer(t *testing.T, serverErrorCount *int) *httptest.Server {
     ^
services/router/internal/direct/websocket_client_test.go:1584:6: test helper function should start from t.Helper() (thelper)
func setupWebSocketErrorRecoveryClient(t *testing.T, logger *zap.Logger, server *httptest.Server) *WebSocketClient {
     ^
services/router/internal/direct/websocket_client_test.go:1610:6: test helper function should start from t.Helper() (thelper)
func cleanupWebSocketErrorRecoveryClient(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1616:6: test helper function should start from t.Helper() (thelper)
func runWebSocketErrorRecoveryTests(t *testing.T, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1638:6: test helper function should start from t.Helper() (thelper)
func executeWebSocketErrorRecoveryRequests(t *testing.T, client *WebSocketClient, testCases []struct {
     ^
services/router/internal/direct/websocket_client_test.go:1667:6: test helper function should start from t.Helper() (thelper)
func verifyWebSocketErrorRecoveryResults(t *testing.T, client *WebSocketClient, successCount, clientErrorCount int) {
     ^
services/router/internal/direct/websocket_client_test.go:1794:6: test helper function should start from b.Helper() (thelper)
func runWebSocketFrameSizeBenchmark(b *testing.B, logger *zap.Logger, frameSize int) {
     ^
services/router/internal/direct/websocket_client_test.go:1804:6: test helper function should start from b.Helper() (thelper)
func setupWebSocketFrameSizeBenchServer(b *testing.B, frameSize int) *httptest.Server {
     ^
services/router/internal/direct/websocket_client_test.go:1820:6: test helper function should start from b.Helper() (thelper)
func handleWebSocketFrameSizeBenchMessages(b *testing.B, conn *websocket.Conn, frameSize int) {
     ^
services/router/internal/direct/websocket_client_test.go:1846:6: test helper function should start from b.Helper() (thelper)
func setupWebSocketFrameSizeBenchClient(b *testing.B, logger *zap.Logger, server *httptest.Server) *WebSocketClient {
     ^
services/router/internal/direct/websocket_client_test.go:1869:6: test helper function should start from b.Helper() (thelper)
func cleanupWebSocketFrameSizeBenchClient(b *testing.B, client *WebSocketClient) {
     ^
services/router/internal/direct/websocket_client_test.go:1875:6: test helper function should start from b.Helper() (thelper)
func executeWebSocketFrameSizeBenchmark(b *testing.B, client *WebSocketClient, frameSize int) {
     ^
services/router/internal/gateway/gateway_integration_advanced_test.go:453:6: test helper function should start from t.Helper() (thelper)
func createFailoverTestServer(t *testing.T, counters *serverCounters) *mockTCPServerBench {
     ^
services/router/internal/gateway/gateway_integration_advanced_test.go:507:6: test helper function should start from t.Helper() (thelper)
func startFailoverServer(t *testing.T, server *mockTCPServerBench) string {
     ^
services/router/internal/gateway/gateway_integration_advanced_test.go:524:6: test helper function should start from t.Helper() (thelper)
func runConcurrentFailoverTest(t *testing.T, cfg config.GatewayConfig, logger *zap.Logger) *clientCounters {
     ^
services/router/internal/gateway/gateway_integration_advanced_test.go:588:6: test helper function should start from t.Helper() (thelper)
func validateConcurrentFailoverResults(t *testing.T, serverCounters *serverCounters, clientCounters *clientCounters) {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:142:6: test helper function should start from t.Helper() (thelper)
func createLifecycleTestServer(t *testing.T, tracker *eventTracker) *mockTCPServer {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:239:6: test helper function should start from t.Helper() (thelper)
func startLifecycleServer(t *testing.T, server *mockTCPServer) string {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:247:6: test helper function should start from t.Helper() (thelper)
func createLifecycleTestClient(t *testing.T, addr string, logger *zap.Logger) *TCPClient {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:262:6: test helper function should start from t.Helper() (thelper)
func runLifecycleTest(t *testing.T, client *TCPClient) {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:293:6: test helper function should start from t.Helper() (thelper)
func validateLifecycleEvents(t *testing.T, tracker *eventTracker) {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:473:6: test helper function should start from t.Helper() (thelper)
func sendConcurrentRequest(t *testing.T, wg *sync.WaitGroup, client *TCPClient, id int, results chan<- int64) {
     ^
services/router/internal/gateway/tcp_client_advanced_test.go:499:6: test helper function should start from t.Helper() (thelper)
func extractCountFromResponse(t *testing.T, resp *mcp.Response, id int) int64 {
     ^
services/router/internal/pool/pool_test.go:779:6: test helper function should start from t.Helper() (thelper)
func runRapidAcquireReleaseCycles(t *testing.T, factory *mockFactory, logger *zap.Logger) {
     ^
services/router/internal/pool/pool_test.go:819:6: test helper function should start from t.Helper() (thelper)
func runConnectionFailureDuringOperations(t *testing.T, factory *mockFactory, logger *zap.Logger) {
     ^
services/router/internal/pool/pool_test.go:878:6: test helper function should start from t.Helper() (thelper)
func runReleaseInvalidConnectionTest(t *testing.T, factory *mockFactory, logger *zap.Logger) {
     ^
services/router/internal/pool/pool_test.go:912:6: test helper function should start from t.Helper() (thelper)
func runFactoryCreateErrorsTest(t *testing.T, factory *mockFactory, logger *zap.Logger) {
     ^
services/router/internal/pool/pool_test.go:951:6: test helper function should start from t.Helper() (thelper)
func runConcurrentCloseAndOperationsTest(t *testing.T, factory *mockFactory, logger *zap.Logger) {
     ^
services/router/internal/router/router_test.go:35:6: test helper function should start from t.Helper() (thelper)
func createNewRouterTests(t *testing.T) []struct {
     ^
services/router/internal/router/router_test.go:934:6: test helper function should start from b.Helper() (thelper)
func runBenchmarkLoop(b *testing.B, router *LocalRouter, request []byte) {
     ^
services/router/internal/direct/protocol_negotiation_advanced_test.go:737:6: TestAdvancedProtocolNegotiation_EdgeCases's subtests should call t.Parallel (tparallel)
func TestAdvancedProtocolNegotiation_EdgeCases(t *testing.T) {
     ^
services/router/internal/tracing/tracing_test.go:118:6: TestTracerOperations's subtests should call t.Parallel (tparallel)
func TestTracerOperations(t *testing.T) { 
     ^
services/router/internal/direct/protocol_negotiation_advanced_test.go:500:40: unnecessary leading newline (whitespace)
	successfulDetections, errors *int64) {
	                                      ^
services/router/internal/direct/sse_client_test.go:941:97: unnecessary leading newline (whitespace)
	numGoroutines, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
	                                                                                               ^
services/router/internal/direct/sse_client_test.go:950:95: unnecessary leading newline (whitespace)
	goroutineID, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
	                                                                                             ^
services/router/internal/direct/sse_client_test.go:1005:44: unnecessary leading newline (whitespace)
	numGoroutines, requestsPerGoroutine int) {
	                                          ^
services/router/internal/direct/stdio_client_test.go:1283:97: unnecessary leading newline (whitespace)
	numGoroutines, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
	                                                                                               ^
services/router/internal/direct/stdio_client_test.go:1292:95: unnecessary leading newline (whitespace)
	goroutineID, requestsPerGoroutine int, errChan chan error, responseChan chan *mcp.Response) {
	                                                                                             ^
services/router/internal/direct/stdio_client_test.go:1347:44: unnecessary leading newline (whitespace)
	numGoroutines, requestsPerGoroutine int) {
	                                          ^
services/router/cmd/mcp-router/metrics_test.go:112:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	cfg, err := config.Load(configPath)
	^
services/router/cmd/mcp-router/metrics_test.go:126:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var metricsExporter *metrics.PrometheusExporter
	^
services/router/cmd/mcp-router/metrics_test.go:128:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	if !cfg.Metrics.Enabled || cfg.Metrics.Endpoint == "" {
	^
services/router/cmd/mcp-router/metrics_test.go:136:2: missing whitespace above this line (invalid statement above go) (wsl_v5)
	go func() {
	^
services/router/cmd/mcp-router/metrics_test.go:138:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func() {
		^
services/router/cmd/mcp-router/setup_test.go:163:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		t.Cleanup(func() { _ = os.Unsetenv("MCP_AUTH_TOKEN") })
		^
services/router/cmd/mcp-router/setup_test.go:196:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err = yaml.Unmarshal(data, &cfg)
	^
services/router/cmd/mcp-router/update_test.go:108:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	t.Cleanup(func() { Version = oldVersion })
	^
services/router/cmd/mcp-router/update_test.go:133:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	t.Cleanup(func() { http.DefaultClient = oldClient })
	^
services/router/cmd/mcp-router/update_test.go:264:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if err := json.NewEncoder(w).Encode(tt.release); err != nil {
		^
services/router/cmd/mcp-router/update_test.go:277:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	t.Cleanup(func() { http.DefaultClient = oldClient })
	^
services/router/internal/config/config_integration_test.go:117:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	t.Cleanup(func() { _ = os.Unsetenv("JSON_TEST_TOKEN") })
	^
services/router/internal/config/config_integration_test.go:495:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	configData := createFormatTestConfigData()
	^
services/router/internal/config/config_integration_test.go:506:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	t.Cleanup(func() { _ = os.Unsetenv("FORMAT_TEST_TOKEN") })
	^
services/router/internal/config/config_integration_test.go:769:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer cleanupBenchmarkEnvironment()
	^
services/router/internal/config/config_test.go:212:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	origToken, tokenExists := os.LookupEnv("TEST_TOKEN")
	^
services/router/internal/direct/error_handling_test.go:301:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(context.Background()) }()
	^
services/router/internal/direct/http_client_test.go:872:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/http_client_test.go:984:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/manager_test.go:239:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	manager := setupProtocolDetectionManager(t, logger)
	^
services/router/internal/direct/manager_test.go:439:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	manager := setupValidURLsManager(t, logger)
	^
services/router/internal/direct/manager_test.go:1159:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/direct/manager_test.go:1407:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	manager := NewDirectClientManager(tc.config, logger)
	^
services/router/internal/direct/manager_test.go:1431:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(ctx) }()
	^
services/router/internal/direct/manager_test.go:1528:5: missing whitespace above this line (invalid statement above if) (wsl_v5)
				if err != nil {
				^
services/router/internal/direct/manager_test.go:1610:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(ctx) }()
	^
services/router/internal/direct/manager_test.go:1717:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(ctx) }()
	^
services/router/internal/direct/manager_test.go:1777:3: missing whitespace above this line (too many statements above if) (wsl_v5)
		_, err := manager.GetClient(ctx, testURL)
		^
services/router/internal/direct/manager_test.go:1791:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(ctx) }()
	^
services/router/internal/direct/manager_test.go:1825:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRequests = 10
	^
services/router/internal/direct/manager_test.go:1828:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var wg sync.WaitGroup
	^
services/router/internal/direct/manager_test.go:1832:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func(id int) {
		^
services/router/internal/direct/manager_test.go:1834:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			testURL := fmt.Sprintf("echo pool-test-%d", id)
			^
services/router/internal/direct/manager_test.go:1835:4: missing whitespace above this line (too many statements above send) (wsl_v5)
			_, err := manager.GetClient(ctx, testURL)
			^
services/router/internal/direct/manager_test.go:1872:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = manager.Stop(ctx) }()
	^
services/router/internal/direct/manager_test.go:2021:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	protocolTests := createProtocolCreationTestCases()
	^
services/router/internal/direct/manager_test.go:2124:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := DirectConfig{}
	^
services/router/internal/direct/manager_test.go:2134:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := DirectConfig{
	^
services/router/internal/direct/manager_test.go:2161:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := DirectConfig{}
	^
services/router/internal/direct/manager_test.go:2177:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := DirectConfig{
	^
services/router/internal/direct/memory_optimization_test.go:542:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/direct/memory_optimization_test.go:549:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	performMemoryIntensiveOperations(t, optimizer)
	^
services/router/internal/direct/memory_optimization_test.go:580:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numOperations = 1000
	^
services/router/internal/direct/memory_optimization_test.go:593:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	optimizer.PutBuffer(buf)
	^
services/router/internal/direct/memory_optimization_test.go:610:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_ = decoder.Decode(&decoded)
	^
services/router/internal/direct/memory_optimization_test.go:629:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numOperations = 1000
	^
services/router/internal/direct/protocol_comparison_test.go:257:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	client, err := NewHTTPClient("http-conn-bench", config.URL, config, logger)
	^
services/router/internal/direct/protocol_comparison_test.go:272:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	client, err := NewWebSocketClient("ws-conn-bench", config.URL, config, logger)
	^
services/router/internal/direct/protocol_comparison_test.go:287:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	client, err := NewSSEClient("sse-conn-bench", config.URL, config, logger)
	^
services/router/internal/direct/protocol_comparison_test.go:304:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	client, err := NewStdioClient("stdio-conn-bench", "stdio://python3 "+scriptPath, config, logger)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:441:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:474:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const (
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:501:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/protocol_negotiation_advanced_test.go:525:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	totalDetections := int64(numWorkers * detectionsPerWorker)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:744:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:842:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = emptyManager.Stop(ctx) }()
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:963:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithTimeout(context.Background(), 60*time.Second)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:979:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numDetections = 1000
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:980:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithTimeout(context.Background(), 60*time.Second)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:984:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var (
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:991:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go runSingleDetection(t, &wg, manager, ctx, serverURL, i, &successCount)
		^
services/router/internal/direct/protocol_negotiation_advanced_test.go:1013:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	_, err := manager.DetectProtocol(ctx, testURL)
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:1021:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRepeatedDetections = 100
	^
services/router/internal/direct/protocol_negotiation_advanced_test.go:1022:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx, cancel := context.WithTimeout(context.Background(), 60*time.Second)
	^
services/router/internal/direct/sse_client_test.go:791:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	mockServer := newMockSSEServer()
	^
services/router/internal/direct/sse_client_test.go:798:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/direct/sse_client_test.go:811:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := SSEClientConfig{
	^
services/router/internal/direct/sse_client_test.go:827:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	start := time.Now()
	^
services/router/internal/direct/sse_client_test.go:835:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRequests = 10
	^
services/router/internal/direct/sse_client_test.go:836:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	requestTimes := make([]time.Duration, numRequests)
	^
services/router/internal/direct/sse_client_test.go:848:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		require.NoError(t, err)
		^
services/router/internal/direct/sse_client_test.go:875:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	client := setupSSEConcurrentClient(t, logger)
	^
services/router/internal/direct/sse_client_test.go:883:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	mockServer := newMockSSEServer()
	^
services/router/internal/direct/sse_client_test.go:884:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	t.Cleanup(func() { mockServer.close() })
	^
services/router/internal/direct/sse_client_test.go:912:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:919:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numGoroutines = 1
	^
services/router/internal/direct/sse_client_test.go:920:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const requestsPerGoroutine = 5
	^
services/router/internal/direct/sse_client_test.go:925:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:942:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/sse_client_test.go:945:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go runSSEConcurrentWorker(wg, client, ctx, g, requestsPerGoroutine, errChan, responseChan)
		^
services/router/internal/direct/sse_client_test.go:951:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/sse_client_test.go:973:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	done := make(chan struct{})
	^
services/router/internal/direct/sse_client_test.go:974:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/router/internal/direct/sse_client_test.go:1006:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/sse_client_test.go:1008:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	expectedCount := numGoroutines * requestsPerGoroutine
	^
services/router/internal/direct/sse_client_test.go:1131:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	server := httptest.NewServer(http.HandlerFunc(tc.serverBehavior))
	^
services/router/internal/direct/sse_client_test.go:1144:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/direct/sse_client_test.go:1154:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := SSEClientConfig{
	^
services/router/internal/direct/sse_client_test.go:1179:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server, toggleServer := setupReconnectionServer()
	^
services/router/internal/direct/sse_client_test.go:1196:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		enabled := serverEnabled
		^
services/router/internal/direct/sse_client_test.go:1197:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		serverMu.Unlock()
		^
services/router/internal/direct/sse_client_test.go:1227:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		serverEnabled = enabled
		^
services/router/internal/direct/sse_client_test.go:1228:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		serverMu.Unlock()
		^
services/router/internal/direct/sse_client_test.go:1236:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := SSEClientConfig{
	^
services/router/internal/direct/sse_client_test.go:1259:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:1330:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server := setupCompressionTestServer(t, tc.expectHeader)
	^
services/router/internal/direct/sse_client_test.go:1350:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			w.WriteHeader(http.StatusAccepted)
			^
services/router/internal/direct/sse_client_test.go:1357:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := SSEClientConfig{
	^
services/router/internal/direct/sse_client_test.go:1380:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:1402:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server, requestCounter := setupErrorRecoveryServer()
	^
services/router/internal/direct/sse_client_test.go:1428:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			w.WriteHeader(http.StatusAccepted)
			^
services/router/internal/direct/sse_client_test.go:1441:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := SSEClientConfig{
	^
services/router/internal/direct/sse_client_test.go:1462:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:1469:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/sse_client_test.go:1489:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	metrics := client.GetMetrics()
	^
services/router/internal/direct/stdio_client_test.go:176:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:197:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:204:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:223:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	metrics := client.GetMetrics()
	^
services/router/internal/direct/stdio_client_test.go:407:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:429:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:527:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:551:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:558:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:574:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	result, ok := resp.Result.(map[string]interface{})
	^
services/router/internal/direct/stdio_client_test.go:632:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:654:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:661:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:677:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	result, ok := resp.Result.(map[string]interface{})
	^
services/router/internal/direct/stdio_client_test.go:783:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:801:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:810:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err := client.Connect(ctx)
	^
services/router/internal/direct/stdio_client_test.go:819:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	req := &mcp.Request{
	^
services/router/internal/direct/stdio_client_test.go:832:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	err := client.Close(ctx)
	^
services/router/internal/direct/stdio_client_test.go:897:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:924:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:931:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:942:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	req := &mcp.Request{
	^
services/router/internal/direct/stdio_client_test.go:954:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	req := &mcp.Request{
	^
services/router/internal/direct/stdio_client_test.go:1025:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	client := setupStdioPerformanceClient(t, logger, scriptPath, tc.config)
	^
services/router/internal/direct/stdio_client_test.go:1029:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	time.Sleep(100 * time.Millisecond)
	^
services/router/internal/direct/stdio_client_test.go:1084:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:1100:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1107:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1116:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRequests = 20
	^
services/router/internal/direct/stdio_client_test.go:1117:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1225:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:1252:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1259:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const (
	^
services/router/internal/direct/stdio_client_test.go:1267:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1284:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/stdio_client_test.go:1287:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go runStdioConcurrentWorker(wg, client, ctx, g, requestsPerGoroutine, errChan, responseChan)
		^
services/router/internal/direct/stdio_client_test.go:1293:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/stdio_client_test.go:1315:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	done := make(chan struct{})
	^
services/router/internal/direct/stdio_client_test.go:1316:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/router/internal/direct/stdio_client_test.go:1348:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
	
^
services/router/internal/direct/stdio_client_test.go:1350:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	expectedCount := numGoroutines * requestsPerGoroutine
	^
services/router/internal/direct/stdio_client_test.go:1411:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	memoryOptimizer := createStdioMemoryOptimizer(logger)
	^
services/router/internal/direct/stdio_client_test.go:1463:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1470:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	const numRequests = 50
	^
services/router/internal/direct/stdio_client_test.go:1471:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1490:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	metrics := client.GetMetrics()
	^
services/router/internal/direct/stdio_client_test.go:1553:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:1580:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1587:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1606:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	result, ok := resp.Result.(map[string]interface{})
	^
services/router/internal/direct/stdio_client_test.go:1692:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:1713:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1720:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	testCases := createStdioErrorTestCases()
	^
services/router/internal/direct/stdio_client_test.go:1746:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var successCount, errorCount int
	^
services/router/internal/direct/stdio_client_test.go:1747:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1878:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:1905:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1912:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:1974:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := StdioClientConfig{
	^
services/router/internal/direct/stdio_client_test.go:2005:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/stdio_client_test.go:2012:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/websocket_client.go:241:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if c.state != StateClosing && c.state != StateClosed {
		^
services/router/internal/direct/websocket_client.go:244:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		c.mu.Unlock()
		^
services/router/internal/direct/websocket_client_test.go:333:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	slowServer := setupWebSocketTimeoutServer(t)
	^
services/router/internal/direct/websocket_client_test.go:373:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	config := WebSocketClientConfig{
	^
services/router/internal/direct/websocket_client_test.go:394:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/websocket_client_test.go:401:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/websocket_client_test.go:418:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	metrics := client.GetMetrics()
	^
services/router/internal/direct/websocket_client_test.go:787:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		handleWebSocketCorrelationMessages(t, conn)
		^
services/router/internal/direct/websocket_client_test.go:858:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	expectedResponses := make(map[string]string, numRequests)
	^
services/router/internal/direct/websocket_client_test.go:959:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/websocket_client_test.go:964:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func(goroutineID int) {
		^
services/router/internal/direct/websocket_client_test.go:966:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			executeWebSocketConcurrentGoroutine(ctx, client, goroutineID, requestsPerGoroutine, errChan, responseChan)
			^
services/router/internal/direct/websocket_client_test.go:986:3: missing whitespace above this line (invalid statement above send) (wsl_v5)
		responseChan <- resp
		^
services/router/internal/direct/websocket_client_test.go:992:2: missing whitespace above this line (no shared variables above go) (wsl_v5)
	go func() {
	^
services/router/internal/direct/websocket_client_test.go:1086:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = conn.Close() }()
	^
services/router/internal/direct/websocket_client_test.go:1311:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	requestTimes := make([]time.Duration, numRequests)
	^
services/router/internal/direct/websocket_client_test.go:1399:3: missing whitespace above this line (no shared variables above defer) (wsl_v5)
		defer func() { _ = conn.Close() }()
		^
services/router/internal/direct/websocket_client_test.go:1571:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	server := setupWebSocketErrorRecoveryServer(t, &serverErrorCount)
	^
services/router/internal/direct/websocket_client_test.go:1643:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	ctx := context.Background()
	^
services/router/internal/direct/websocket_client_test.go:1655:4: missing whitespace above this line (no shared variables above expr) (wsl_v5)
			t.Logf("Expected error for %s: %v", tc.method, err)
			^
services/router/internal/direct/websocket_client_test.go:1814:3: missing whitespace above this line (no shared variables above defer) (wsl_v5)
		defer func() { _ = conn.Close() }()
		^
services/router/internal/direct/websocket_client_test.go:1881:3: missing whitespace above this line (no shared variables above for) (wsl_v5)
		for pb.Next() {
		^
services/router/internal/gateway/binary_frame_test.go:213:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	payload := []byte(`{"test":"data"}`)
	^
services/router/internal/gateway/binary_frame_test.go:217:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	_, _ = buf.Write(payload)
	^
services/router/internal/gateway/client_mtls_test.go:408:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if tt.errorMsg != "" {
		^
services/router/internal/gateway/client_mtls_test.go:551:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if tt.errorMsg != "" {
		^
services/router/internal/gateway/client_test.go:208:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		tlsConfig.CAFile = caFile
		^
services/router/internal/gateway/client_test.go:322:3: missing whitespace above this line (too many statements above if) (wsl_v5)
		conn, err := upgrader.Upgrade(w, r, nil)
		^
services/router/internal/gateway/client_test.go:327:3: missing whitespace above this line (no shared variables above defer) (wsl_v5)
		defer func() { _ = conn.Close() }()
		^
services/router/internal/gateway/client_test.go:346:3: missing whitespace above this line (too many statements above if) (wsl_v5)
		conn, err := upgrader.Upgrade(w, r, nil)
		^
services/router/internal/gateway/client_test.go:350:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		_ = conn.Close()
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:366:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	addr, err := server.Start()
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:389:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		t.Fatalf("Failed to connect: %v", err)
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:391:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = client.Close() }()
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:399:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if tt.expectedSuccess {
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:424:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	addr := startFailoverServer(t, server)
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:460:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			_ = conn.Close()
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:470:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	frame, err := ReadBinaryFrame(reader)
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:474:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if frame.MessageType == MessageTypeVersionNegotiation {
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:483:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if frame.MessageType == MessageTypeRequest {
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:539:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func(goroutineID int) {
		^
services/router/internal/gateway/gateway_integration_advanced_test.go:541:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			runGoroutineOperations(goroutineID, operationsPerGoroutine, cfg, logger, counters)
			^
services/router/internal/gateway/gateway_integration_advanced_test.go:544:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	wg.Wait()
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:561:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = client.Close() }()
	^
services/router/internal/gateway/gateway_integration_advanced_test.go:603:2: missing whitespace above this line (invalid statement above if) (wsl_v5)
	if clientErrors == 0 {
	^
services/router/internal/gateway/tcp_client_advanced_test.go:110:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	addr := startLifecycleServer(t, server)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:150:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/gateway/tcp_client_advanced_test.go:219:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	pongFrame := &BinaryFrame{
	^
services/router/internal/gateway/tcp_client_advanced_test.go:225:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	tracker.addEvent("pong_sent")
	^
services/router/internal/gateway/tcp_client_advanced_test.go:230:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	respFrame := &BinaryFrame{
	^
services/router/internal/gateway/tcp_client_advanced_test.go:236:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	tracker.addEvent("response_sent")
	^
services/router/internal/gateway/tcp_client_advanced_test.go:295:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	events := tracker.getEvents()
	^
services/router/internal/gateway/tcp_client_advanced_test.go:300:3: missing whitespace above this line (no shared variables above range) (wsl_v5)
		for _, event := range events {
		^
services/router/internal/gateway/tcp_client_advanced_test.go:306:3: missing whitespace above this line (invalid statement above if) (wsl_v5)
		if !found {
		^
services/router/internal/gateway/tcp_client_advanced_test.go:315:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var requestCount int64
	^
services/router/internal/gateway/tcp_client_advanced_test.go:318:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	addr := startServerOrFail(t, server)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:325:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	results := runConcurrentRequests(t, client, numRequests)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:461:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	results := make(chan int64, numRequests)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:465:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go sendConcurrentRequest(t, &wg, client, i, results)
		^
services/router/internal/gateway/tcp_client_advanced_test.go:626:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	addr := startServerOrFail(t, server)
	^
services/router/internal/gateway/tcp_client_advanced_test.go:630:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = client.Close() }()
	^
services/router/internal/metrics/prometheus_test.go:274:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	exporter.SetRouterMetrics(func() *RouterMetrics { return testMetrics })
	^
services/router/internal/metrics/prometheus_test.go:278:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	time.Sleep(testIterations * time.Millisecond)
	^
services/router/internal/metrics/prometheus_test.go:314:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = resp.Body.Close() }()
	^
services/router/internal/pool/pool_test.go:788:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/pool/pool_test.go:800:3: missing whitespace above this line (no shared variables above for) (wsl_v5)
		for j := 0; j < 3; j++ {
		^
services/router/internal/pool/pool_test.go:828:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/pool/pool_test.go:882:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/pool/pool_test.go:897:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = otherPool.Close() }()
	^
services/router/internal/pool/pool_test.go:920:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/pool/pool_test.go:961:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var wg sync.WaitGroup
	^
services/router/internal/pool/pool_test.go:962:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	stopChan := make(chan struct{})
	^
services/router/internal/pool/pool_test.go:967:3: missing whitespace above this line (invalid statement above go) (wsl_v5)
		go func() {
		^
services/router/internal/pool/pool_test.go:969:4: missing whitespace above this line (invalid statement above for) (wsl_v5)
			for {
			^
services/router/internal/pool/pool_test.go:979:6: missing whitespace above this line (invalid statement above expr) (wsl_v5)
					time.Sleep(time.Millisecond)
					^
services/router/internal/pool/pool_test.go:980:6: missing whitespace above this line (invalid statement above assign) (wsl_v5)
					_ = pool.Release(conn)
					^
services/router/internal/router/gateway_fallback_integration_test.go:67:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	mockClients.gwClient.sendRequestFunc = func(req *mcp.Request) error {
	^
services/router/internal/router/gateway_fallback_integration_test.go:155:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ticker := time.NewTicker(10 * time.Millisecond)
	^
services/router/internal/router/gateway_fallback_integration_test.go:197:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var totalLatency time.Duration
	^
services/router/internal/router/router_integration_test.go:70:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	waitForConnection(t, router)
	^
services/router/internal/router/router_integration_test.go:74:2: missing whitespace above this line (no shared variables above expr) (wsl_v5)
	monitorForResponse(t, router, responseReceived, done)
	^
services/router/internal/router/router_test.go:293:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		func() { _ = router.Run(ctx) }()
		^
services/router/internal/router/router_test.go:317:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ticker := time.NewTicker(constants.TestTickInterval)
	^
services/router/internal/router/router_test.go:652:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		func() { _ = router.Run(ctx) }()
		^
services/router/internal/router/router_test.go:908:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		func() { _ = router.Run(ctx) }()
		^
services/router/internal/router/router_test.go:1051:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		_ = router.Run(ctx)
		^
services/router/internal/router/router_test.go:1077:7: missing whitespace above this line (invalid statement above assign) (wsl_v5)
						receivedResponses[idStr] = true
						^
services/router/internal/router/router_test.go:1078:7: missing whitespace above this line (no shared variables above expr) (wsl_v5)
						responseMu.Unlock()
						^
services/router/internal/router/router_test.go:1118:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			received := receivedResponses[id]
			^
services/router/internal/router/router_test.go:1119:4: missing whitespace above this line (no shared variables above expr) (wsl_v5)
			responseMu.Unlock()
			^
services/router/internal/router/router_test.go:1131:3: missing whitespace above this line (invalid statement above assign) (wsl_v5)
		received := receivedResponses[id]
		^
services/router/internal/router/router_test.go:1132:3: missing whitespace above this line (no shared variables above expr) (wsl_v5)
		responseMu.Unlock()
		^
services/router/internal/router/router_test.go:1374:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/router/router_test.go:1451:3: missing whitespace above this line (invalid statement above for) (wsl_v5)
		for {
		^
services/router/internal/router/router_test.go:1547:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() {
	^
services/router/internal/router/router_test.go:1934:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/router/internal/router/router_test.go:1970:3: missing whitespace above this line (too many statements above if) (wsl_v5)
		conn, err := upgrader.Upgrade(w, r, nil)
		^
services/router/internal/router/router_test.go:1974:3: missing whitespace above this line (no shared variables above defer) (wsl_v5)
		defer func() { _ = conn.Close() }()
		^
services/router/internal/router/router_test.go:2056:4: missing whitespace above this line (invalid statement above assign) (wsl_v5)
			(*responsesReceived)[idStr] = true
			^
services/router/internal/router/router_test.go:2057:4: missing whitespace above this line (no shared variables above expr) (wsl_v5)
			responseMu.Unlock()
			^
services/router/internal/router/router_test.go:2398:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	waitForRouterConnection(t, router)
	^
services/router/internal/router/router_test.go:2510:2: missing whitespace above this line (too many statements above if) (wsl_v5)
	methodCount := len(directOnlyMethods)
	^
services/router/internal/router/router_test.go:2589:2: missing whitespace above this line (never cuddle decl) (wsl_v5)
	var gatewayRequests int32
	^
services/router/internal/router/router_test.go:2595:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/router/internal/router/router_test.go:2599:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	waitForRouterConnection(t, router)
	^
services/router/internal/router/router_test.go:2706:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	decisions := make(map[string]int32)
	^
services/router/internal/router/router_test.go:2710:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	decisionMu.Unlock()
	^
services/router/internal/router/router_test.go:2751:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	ctx, cancel := context.WithCancel(context.Background())
	^
services/router/internal/router/router_test.go:2760:3: missing whitespace above this line (invalid statement above expr) (wsl_v5)
		func() { _ = router.Run(ctx) }()
		^
services/router/internal/router/router_test.go:2814:4: missing whitespace above this line (invalid statement above if) (wsl_v5)
			if methodStr, ok := method.(string); ok {
			^
services/router/internal/router/router_test.go:2817:4: missing whitespace above this line (invalid statement above expr) (wsl_v5)
			protocolMu.Unlock()
			^
services/router/internal/secure/credential_security_test.go:498:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	keys := storeMultipleSmallTokens(t, store, numKeys)
	^
services/router/internal/secure/credential_security_test.go:583:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	largeToken := strings.Repeat("x", largeTokenSize)
	^
services/router/internal/secure/encrypted_file_store.go:167:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
		
^
services/router/internal/secure/encrypted_file_store.go:175:1: unnecessary whitespace (leading-whitespace) (wsl_v5)
		
^
services/router/internal/secure/keychain_store_darwin.go:306:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, r := range decodedStr {
	^
services/router/internal/secure/keychain_store_darwin.go:329:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, b := range decoded {
	^
services/router/internal/secure/keychain_store_darwin.go:343:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for _, r := range decodedStr {
	^
services/router/internal/stdio/handler_test.go:152:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	done := make(chan bool)
	^
services/router/internal/stdio/handler_test.go:162:5: missing whitespace above this line (invalid statement above assign) (wsl_v5)
				received = append(received, string(msg))
				^
services/router/internal/stdio/handler_test.go:349:2: missing whitespace above this line (invalid statement above assign) (wsl_v5)
	writer := bufio.NewWriter(&outputBuf)
	^
services/router/internal/tracing/tracing_test.go:122:2: missing whitespace above this line (no shared variables above defer) (wsl_v5)
	defer func() { _ = tracer.Shutdown(context.Background()) }()
	^
services/router/internal/tracing/tracing_test.go:206:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	spanCtx, span := tracer.StartSpan(ctx, "test-attributes")
	^
services/router/internal/tracing/tracing_test.go:223:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	spanCtx, span := tracer.StartSpan(ctx, "test-events")
	^
services/router/internal/tracing/tracing_test.go:234:2: missing whitespace above this line (too many statements above defer) (wsl_v5)
	spanCtx, span := tracer.StartSpan(ctx, "test-error")
	^
services/router/internal/tracing/tracing_test.go:283:2: missing whitespace above this line (no shared variables above range) (wsl_v5)
	for k := range headers {
	^
services/router/internal/tracing/tracing_test.go:289:2: missing whitespace above this line (invalid statement above expr) (wsl_v5)
	assert.True(t, found, "traceparent header not found")
	^
781 issues:
* bodyclose: 1
* contextcheck: 11
* funlen: 44
* gocritic: 2
* godot: 7
* gosec: 30
* ireturn: 74
* lll: 51
* nestif: 3
* nilerr: 2
* nlreturn: 173
* prealloc: 4
* thelper: 76
* tparallel: 2
* whitespace: 7
* wsl_v5: 294

=== LINTING COMPLETE ===
Total issues across all modules: 1469
Overall status: FAIL
